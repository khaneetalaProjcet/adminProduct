import{_ as $,r,i as A,c as E,b as l,w as o,$ as b,e as H,j as L,Z as k,s as W,o as x,a0 as u,a as i,a2 as N,D as V,t as T}from"./index-D3cuJDmY.js";import{A as j}from"./accounting-CXz7Q7KL.js";import{I as F}from"./inperson-CjI0Tl-M.js";import{V as M}from"./VAlert-wn3ycb87.js";import{a as z,V as Z}from"./VCard-DeiTGn43.js";import{V as n}from"./VTextField-CN9lFNLl.js";import{V as q}from"./VDataTable-WUN0RXQl.js";import{V as J}from"./VChip-ByjE6p5Y.js";import"./api-BKzefw6Q.js";import"./createSimpleFunctional-C2b8qME-.js";import"./VAvatar-B8qf-Fj1.js";import"./VImg-D_eCsBaf.js";import"./index-RldtkqtO.js";import"./index-DMfn3_aI.js";import"./VSelect-B-9v4h8v.js";import"./VMenu-B9R-Whp6.js";import"./VDivider-D-NNUxz0.js";import"./dialog-transition-De18Bpge.js";import"./VSelectionControl-ZfDZt-Lq.js";const K={class:"w-100 d-flex justify-end"},O={class:"w-100 d-flex justify-end"},Q={__name:"AccountingSellTrade",setup(X){const c=r(""),m=r(!1),p=r(!1),S=r([{title:"نام",key:"seller.firstName"},{title:"نام خانوادگی",key:"seller.lastName"},{title:"شناسه پرداخت",key:"invoiceId"},{title:"مبلغ (تومان)",key:"totalPrice"},{title:"میزان طلا (گرم)",key:"goldWeight"},{title:"قیمت طلا (تومان)",key:"goldPrice"},{title:"تاریخ",key:"date"},{title:"زمان",key:"time"},{title:"کارشناس",key:"accounterId"},{title:"وضعیت",key:"status"}]),a=r({firstName:"",lastName:"",nationalCode:"",phoneNumber:"",tradeType:1,type:"sell",goldPrice:"",goldWeight:"",admin:"",accounter:"",startDate:"",startTime:"",endDate:"",endTime:"",invoiceId:"",status:"",destCardPan:""}),y=r(!0),g=r(""),v=r(!1),f=r(),C=async()=>{try{p.value=!0;const d=await j.GoldBoxSellList();return f.value=d.data,d}catch(d){d.response.status==401&&(localStorage.clear(),k.replace("/login")),c.value=d.response.data.error||"خطایی رخ داده است!",m.value=!0,setTimeout(()=>{m.value=!1},1e4)}finally{p.value=!1}},w=async d=>{try{p.value=!0,a.value.status=d;const e=await F.SubmitFilterInvoice(a.value);return f.value=e.data,g.value=e.link,y.value=!0,e}catch(e){e.response.status==401&&(localStorage.clear(),k.replace("/login")),c.value=e.response.data.error||"خطایی رخ داده است!",m.value=!0,setTimeout(()=>{m.value=!1},1e4)}finally{p.value=!1}},U=async()=>{v.value=!0,window.location.href=g.value,setTimeout(()=>{v.value=!1},5e3)},_=d=>d.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),D=[d=>/^\d{10}$/.test(d)||"کد ملی باید ۱۰ رقم باشد",d=>{if(!/^\d{10}$/.test(d))return!0;const e=+d[9],s=d.split("").slice(0,9).reduce((t,G,R)=>t+ +G*(10-R),0)%11;return s<2&&e===s||s>=2&&e+s===11||"کد ملی نامعتبر است"}],B=()=>{a.value.phoneNumber=a.value.phoneNumber.replace(/\D/g,"").slice(0,11)},P=[d=>/^09\d{9}$/.test(d)||"شماره معتبر نیست"],I=[d=>!!d,d=>/^\d+(\.\d{1,3})?$/.test(d)];return A(()=>{C()}),(d,e)=>{const s=W("persian-date-picker");return x(),E("div",null,[l(b,null,{default:o(()=>[l(u,{cols:"12"},{default:o(()=>[l(z,null,{default:o(()=>[l(b,{class:"filter my-3"},{default:o(()=>[l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:a.value.startDate,"onUpdate:modelValue":e[0]||(e[0]=t=>a.value.startDate=t),placeholder:"از تاریخ"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{type:"time",modelValue:a.value.startTime,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.startTime=t),placeholder:"از زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:a.value.endDate,"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.endDate=t),placeholder:"تا تاریخ"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{type:"time",modelValue:a.value.endTime,"onUpdate:modelValue":e[3]||(e[3]=t=>a.value.endTime=t),placeholder:"تا زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:a.value.firstName,"onUpdate:modelValue":e[4]||(e[4]=t=>a.value.firstName=t),label:"نام",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:a.value.lastName,"onUpdate:modelValue":e[5]||(e[5]=t=>a.value.lastName=t),label:"نام خانوادگی",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:a.value.phoneNumber,"onUpdate:modelValue":e[6]||(e[6]=t=>a.value.phoneNumber=t),label:"شماره موبایل",density:"compact",variant:"outlined",rules:P,onInput:B},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:a.value.nationalCode,"onUpdate:modelValue":e[7]||(e[7]=t=>a.value.nationalCode=t),label:"کد ملی",density:"compact",variant:"outlined",rules:D},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:a.value.goldPrice,"onUpdate:modelValue":e[8]||(e[8]=t=>a.value.goldPrice=t),label:"قیمت طلا",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:a.value.goldWeight,"onUpdate:modelValue":e[9]||(e[9]=t=>a.value.goldWeight=t),label:"وزن طلا",density:"compact",variant:"outlined",rules:I},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:a.value.admin,"onUpdate:modelValue":e[10]||(e[10]=t=>a.value.admin=t),label:"ادمین",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:a.value.accounter,"onUpdate:modelValue":e[11]||(e[11]=t=>a.value.accounter=t),label:"حسابدار",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{md:"6",class:"d-none d-md-flex"}),l(u,{cols:"12",md:"3"},{default:o(()=>[i("div",K,[l(N,{"prepend-icon":"ri-loop-left-line",variant:"tonal",block:"",onClick:e[12]||(e[12]=t=>w("completed"))},{default:o(()=>e[13]||(e[13]=[V("به روز رسانی")])),_:1})])]),_:1}),l(u,{cols:"12",md:"3"},{default:o(()=>[i("div",O,[l(N,{"prepend-icon":"ri-file-excel-line",block:"",disabled:y.value,onClick:U,loading:v.value},{default:o(()=>e[14]||(e[14]=[V("خروجی اکسل")])),_:1},8,["disabled","loading"])])]),_:1})]),_:1}),l(Z,{title:"فروش صندوق طلا"},{default:o(()=>[e[15]||(e[15]=i("ul",{class:"listGuide"},[i("li",null," ثبت معامله فروش صندوق طلا به صورت تلفنی توسط کارشناس انجام شده و مبلغ به حساب کاربر توسط بخش حسابداری بازگردانده می‌شود. ")],-1)),l(q,{headers:S.value,items:f.value,loading:p.value},{"item.totalPrice":o(({item:t})=>[i("p",null,T(_(t.totalPrice)),1)]),"item.status":o(({item:t})=>[i("div",null,[l(J,{text:t.status=="completed"?"برداشت شده":"در انتظار برداشت",color:t.status=="completed"?"#ff0000":"#66666",size:"small"},null,8,["text","color"])])]),_:1},8,["headers","items","loading"])]),_:1})]),_:1})]),_:1})]),_:1}),m.value?(x(),H(M,{key:0,color:"error",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:o(()=>[V(T(c.value),1)]),_:1})):L("",!0)])}}},ye=$(Q,[["__scopeId","data-v-6ae9bf7c"]]);export{ye as default};
