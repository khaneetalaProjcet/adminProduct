import{_ as re,r as o,k as ie,c as m,b as t,w as s,a8 as ue,e as j,h as I,F as E,a0 as c,o as i,a1 as Z,a2 as A,a as r,a4 as v,C as M,V as S,a7 as de,a3 as me,t as q}from"./index-zCttv3Q7.js";import{M as f}from"./managment-C7z80Nsm.js";import{V as D}from"./VDialog-CrLkZzBJ.js";import{V as ce}from"./VAlert-B6DyaibA.js";import{V as b}from"./VCard-Djqn9SmC.js";import{V as w}from"./VTextField-BNwS801S.js";import{V as ve}from"./VDataTable-Bvuf3Fmu.js";import{V as R}from"./VSwitch-DsrNoRGO.js";import{V as fe}from"./VForm-DwH41ZeY.js";import"./api-CaUieubz.js";import"./dialog-transition-OOK_9KJ0.js";import"./index-TQXAnblt.js";import"./index--MvczoXy.js";import"./createSimpleFunctional-DbLkbTTu.js";import"./VAvatar-Ac9LxuvC.js";import"./VImg-D7V3GMUt.js";import"./VSelect-gE1LQNGJ.js";import"./VMenu-Cf4dlo8a.js";import"./VDivider-1oa3aaoY.js";import"./VSelectionControl-BCcePUHS.js";const pe={class:"px-5 py-3 d-flex justify-end"},ge={key:0,class:"table-green"},Ve={key:1,class:"table-red"},ye={class:"d-flex flex-column w-100 h-100 my-2"},ke={key:0,class:"dialog-loading"},Ae={class:"d-flex justify-space-between"},be={class:"d-flex justify-space-between"},we={class:"d-flex flex-column w-100 h-100 my-2"},xe={key:0,class:"dialog-access-loading"},Ce={key:1,class:"d-flex justify-space-between align-items-center mx-4 my-2"},Ne={class:"d-flex justify-space-between"},Se={__name:"managmentAdminView",setup(De){const H=o([{title:"نام",key:"firstName"},{title:"نام خانوادگی",key:"lastName"},{title:"شماره همراه",key:"phoneNumber"},{title:"نقش",key:"role"},{title:"اکتیو",key:"isBlocked"},{title:"فعالیت",key:"action"},{title:"بلاک شده",key:"status"}]),F=o([]),L=o(""),U=o(!1),T=o(!1),_=o(!1),z=o(!1),p=o(!1),B=o(!1),P=o(!1),x=o(),C=o(!1),V=o(!1),y=o(!1),u=o(""),n=o(!1),k=o(!1),d=o({firstName:"",lastName:"",phoneNumber:"",password:"",role:0}),N=o(!1),h=o(),G=o(""),$=async()=>{try{U.value=!0;const e=await f.AdminList();return F.value=e.data,e}catch(e){e.response.status==401&&(localStorage.clear(),c.replace("/login")),u.value=e.response.data.error||"خطایی رخ داده است!",n.value=!0,setTimeout(()=>{n.value=!1},1e4)}finally{U.value=!1}},J=async e=>{try{z.value=!0;const l=await f.AccessPoint(e);return x.value=l.data,l}catch(l){l.response.status==401&&(localStorage.clear(),c.replace("/login")),u.value=l.response.data.error||"خطایی رخ داده است!",n.value=!0,setTimeout(()=>{n.value=!1},1e4)}finally{z.value=!1}},K=async()=>{try{p.value=!0;const e=await f.GetPermission();return e.data==0?C.value=!1:C.value=!0,y.value=!0,e}catch(e){e.response.status==401&&(localStorage.clear(),c.replace("/login")),u.value=e.response.data.error||"خطایی رخ داده است!",n.value=!0,setTimeout(()=>{n.value=!1},1e4)}finally{p.value=!1}},O=async()=>{try{p.value=!0;const e=await f.TradePermission();return x.value=e.data,y.value=!1,e}catch(e){e.response.status==401&&(localStorage.clear(),c.replace("/login")),u.value=e.response.data.error||"خطایی رخ داده است!",n.value=!0,setTimeout(()=>{n.value=!1},1e4)}finally{p.value=!1}},Q=async e=>{V.value=!0,J(e.id),G.value=e.id},W=async()=>{try{B.value=!0;const e=await f.SubmitAccessPoint(x.value,G.value);return V.value=!1,e}catch(e){e.response.status==401&&(localStorage.clear(),c.replace("/login")),u.value=e.response.data.error||"خطایی رخ داده است!",n.value=!0,setTimeout(()=>{n.value=!1},1e4)}finally{B.value=!1}},X=async()=>{try{T.value=!0;const e=await f.AddAdmin(d.value);return k.value=!1,$(),e}catch(e){e.response.status==401&&(localStorage.clear(),c.replace("/login")),u.value=e.response.data.error||"خطایی رخ داده است!",n.value=!0,setTimeout(()=>{n.value=!1},1e4)}finally{T.value=!1}},Y=[e=>!!e||"شماره همراه الزامی است",e=>/^09\d{9}$/.test(e)||"شماره معتبر نیست"],ee=[e=>!!e||"رمز عبور الزامی است",e=>e&&e.length>=8||"رمز عبور باید حداقل ۸ کاراکتر باشد",e=>/[A-Z]/.test(e)||"رمز عبور باید حداقل یک حرف بزرگ داشته باشد",e=>/[a-z]/.test(e)||"رمز عبور باید حداقل یک حرف کوچک داشته باشد",e=>/[0-9]/.test(e)||"رمز عبور باید حداقل یک عدد داشته باشد",e=>/[^A-Za-z0-9]/.test(e)||"رمز عبور باید حداقل یک کاراکتر خاص (!@#$%^&*) داشته باشد"],le=[e=>!!e||"نام الزامی است"],ae=[e=>!!e||"نام خانوادگی الزامی است"],te=async e=>{try{return _.value=!0,await f.SwitchAdminActivator(e.id)}catch(l){l.response.status==401&&(localStorage.clear(),c.replace("/login")),u.value=l.response.data.error||"خطایی رخ داده است!",n.value=!0,setTimeout(()=>{n.value=!1},1e4)}finally{_.value=!1}},se=e=>{h.value=e,N.value=!0},oe=async()=>{try{P.value=!0;const e=await f.DeleteAdmin(h.value.id);return N.value=!1,$(),e}catch(e){e.response.status==401&&(localStorage.clear(),c.replace("/login")),u.value=e.response.data.error||"خطایی رخ داده است!",n.value=!0,setTimeout(()=>{n.value=!1},1e4)}finally{P.value=!1}};return ie(()=>{$()}),(e,l)=>(i(),m(E,null,[t(ue,null,{default:s(()=>[t(Z,null,{default:s(()=>[t(A,{cols:"12"},{default:s(()=>[t(b,{title:"سطح دسترسی ها"},{text:s(()=>[t(w,{modelValue:L.value,"onUpdate:modelValue":l[1]||(l[1]=a=>L.value=a),label:"جستجو","prepend-inner-icon":"ri-search-line"},null,8,["modelValue"])]),default:s(()=>[r("div",pe,[t(v,{onClick:l[0]||(l[0]=a=>k.value=!0),class:"mx-2"},{default:s(()=>l[14]||(l[14]=[M("افزودن کاربر")])),_:1}),t(v,{color:"error",class:"error-btn",loading:p.value,onClick:K},{default:s(()=>l[15]||(l[15]=[M(" دسترسی های مدیریتی ")])),_:1},8,["loading"])]),t(ve,{headers:H.value,items:F.value,search:L.value,loading:U.value},{"item.isBlocked":s(({item:a})=>[a.isBlocked==!0?(i(),j(S,{key:0,size:"small",icon:"ri-close-line",color:"#c9190c"})):a.isBlocked==!1?(i(),j(S,{key:1,size:"small",icon:"ri-check-line",color:"#0b8707"})):I("",!0)]),"item.role":s(({item:a})=>[a.role==!0?(i(),m("span",ge,"مدیر")):a.role==!1?(i(),m("span",Ve,"کارشناس")):I("",!0)]),"item.action":s(({item:a})=>[t(S,{class:"me-2",size:"small",icon:"ri-user-settings-line",color:"#d4af37",onClick:g=>Q(a)},null,8,["onClick"]),t(S,{class:"me-2",size:"small",icon:"ri-delete-bin-line",color:"#c9190c",onClick:g=>se(a)},null,8,["onClick"])]),"item.status":s(({item:a})=>[t(R,{modelValue:a.isBlocked,"onUpdate:modelValue":g=>a.isBlocked=g,color:"#b08c4d",onInput:g=>te(a),loading:_.value},null,8,["modelValue","onUpdate:modelValue","onInput","loading"])]),_:1},8,["headers","items","search","loading"])]),_:1})]),_:1})]),_:1})]),_:1}),t(D,{modelValue:V.value,"onUpdate:modelValue":l[3]||(l[3]=a=>V.value=a),"max-width":"450",class:"dialog"},{default:s(()=>[t(b,{class:"dialog-card"},{default:s(()=>[l[17]||(l[17]=r("div",{class:"k-dialog-title"},[r("p",null,"سطح دسترسی")],-1)),r("div",ye,[z.value==!0?(i(),m("div",ke,l[16]||(l[16]=[r("p",null,"لطفا منتظر بمانید ... ",-1)]))):(i(!0),m(E,{key:1},de(x.value,(a,g)=>(i(),m("div",{class:"d-flex justify-space-between align-items-center mx-4 my-2",key:g},[r("span",null,q(a.persianName),1),t(R,{modelValue:a.isAccess,"onUpdate:modelValue":ne=>a.isAccess=ne,color:"#b08c4d"},null,8,["modelValue","onUpdate:modelValue"])]))),128))]),r("div",Ae,[t(v,{text:"انصراف",onClick:l[2]||(l[2]=a=>V.value=!1),size:"large",class:"m-3",variant:"outlined"}),t(v,{text:"ثبت دسترسی",onClick:W,size:"large",class:"m-3",loading:B.value},null,8,["loading"])])]),_:1})]),_:1},8,["modelValue"]),t(D,{modelValue:k.value,"onUpdate:modelValue":l[9]||(l[9]=a=>k.value=a),"max-width":"600",class:"dialog"},{default:s(()=>[t(b,{class:"dialog-card"},{default:s(()=>[l[18]||(l[18]=r("div",{class:"k-dialog-title"},[r("p",null,"افزودن ادمین جدید")],-1)),t(fe,{ref:"form",onSubmit:me(X,["prevent"])},{default:s(()=>[t(Z,null,{default:s(()=>[t(A,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[t(w,{modelValue:d.value.firstName,"onUpdate:modelValue":l[4]||(l[4]=a=>d.value.firstName=a),label:"نام",variant:"outlined",rules:le},null,8,["modelValue"])]),_:1}),t(A,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[t(w,{modelValue:d.value.lastName,"onUpdate:modelValue":l[5]||(l[5]=a=>d.value.lastName=a),label:"نام خانوادگی",variant:"outlined",rules:ae},null,8,["modelValue"])]),_:1}),t(A,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[t(w,{modelValue:d.value.phoneNumber,"onUpdate:modelValue":l[6]||(l[6]=a=>d.value.phoneNumber=a),label:"شماره همراه",variant:"outlined",rules:Y},null,8,["modelValue"])]),_:1}),t(A,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[t(w,{modelValue:d.value.password,"onUpdate:modelValue":l[7]||(l[7]=a=>d.value.password=a),label:"رمز عبور",variant:"outlined",rules:ee},null,8,["modelValue"])]),_:1})]),_:1}),r("div",be,[t(v,{text:"انصراف",onClick:l[8]||(l[8]=a=>k.value=!1),size:"large",class:"m-3",variant:"outlined"}),t(v,{type:"submit",text:"افزودن",size:"large",class:"m-3",loading:T.value},null,8,["loading"])])]),_:1},512)]),_:1})]),_:1},8,["modelValue"]),t(D,{modelValue:y.value,"onUpdate:modelValue":l[12]||(l[12]=a=>y.value=a),"max-width":"450",class:"dialog"},{default:s(()=>[t(b,{class:"dialog-card"},{default:s(()=>[l[21]||(l[21]=r("div",{class:"k-dialog-title"},[r("p",null,"دسترسی های مدیرتی")],-1)),r("div",we,[p.value==!0?(i(),m("div",xe,l[19]||(l[19]=[r("p",null,"لطفا منتظر بمانید ... ",-1)]))):(i(),m("div",Ce,[l[20]||(l[20]=r("span",null,"درگاه معاملات",-1)),t(R,{modelValue:C.value,"onUpdate:modelValue":l[10]||(l[10]=a=>C.value=a),color:"#b08c4d",onClick:O,loading:p.value},null,8,["modelValue","loading"])]))]),r("div",Ne,[t(v,{text:"انصراف",onClick:l[11]||(l[11]=a=>y.value=!1),size:"large",class:"m-3",variant:"outlined"})])]),_:1})]),_:1},8,["modelValue"]),t(D,{modelValue:N.value,"onUpdate:modelValue":l[13]||(l[13]=a=>N.value=a),width:"auto"},{default:s(()=>[t(b,{width:"400","prepend-icon":"mdi-delete",text:"آیا از حذف ادمین مطمئن هستید؟",title:"حذف ادمین"},{actions:s(()=>[t(v,{class:"ms-auto",text:"حذف",onClick:oe,loading:P.value},null,8,["loading"])]),_:1})]),_:1},8,["modelValue"]),n.value?(i(),j(ce,{key:0,color:"error",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:s(()=>[M(q(u.value),1)]),_:1})):I("",!0)],64))}},Ke=re(Se,[["__scopeId","data-v-b134e4f8"]]);export{Ke as default};
