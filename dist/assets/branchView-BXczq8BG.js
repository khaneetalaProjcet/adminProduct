import{_ as te,r as o,k as se,c as oe,a as u,b as l,w as s,a8 as E,e as G,h as H,F as ue,bP as x,o as M,a1 as B,a2 as r,a4 as c,C as N,V as ne,a3 as P,t as b}from"./index-DdnwcKbt.js";import{M as S}from"./managment-CmoaDP-r.js";import{V as h}from"./VDialog-CPSBwLZp.js";import{V as q}from"./VAlert-C7iG8QtL.js";import{V as C}from"./VCard-DdRuxlId.js";import{V as i}from"./VTextField-B6iRdyMe.js";import{V as J}from"./VDataTable-DJH_Ysr2.js";import{V as K}from"./VForm-CNnl6DWR.js";import"./api-CXETJ5tA.js";import"./dialog-transition-DaSWE__q.js";import"./index-DMYj0lua.js";import"./index-C18MM224.js";import"./createSimpleFunctional-sh5M_uFs.js";import"./VAvatar-C6i1bll2.js";import"./VImg-DJJyfr1D.js";import"./VSelect-CLDgUlEN.js";import"./VMenu-CKC_eblB.js";import"./VDivider-BqAZXn6X.js";import"./VSelectionControl-Cviw-QJL.js";const re={class:"px-5 py-3 d-flex justify-end"},de={class:"d-flex justify-space-between"},ie={class:"d-flex justify-end pa-5"},me={class:"d-flex justify-end"},ve={class:"content"},ce={class:"desc"},fe={class:"content"},pe={class:"desc"},Ve={class:"content"},ge={class:"desc"},ye={class:"d-flex justify-space-between"},be={__name:"branchView",setup(ke){const p=o(!1),k=o(!1),_=o(""),V=o(""),d=o(!1),w=o(""),f=o(!1),L=o(!1),U=o(!1),T=o(!1),A=o(!1),D=o(!1),m=o({}),O=o([{title:"id",key:"id"},{title:"نام شعبه",key:"name"},{title:"کد شعبه",key:"code"},{title:"مدیر",key:"manager"},{title:"اطلاعات",key:"action"}]),n=o({firstName:null,lastName:null,phoneNumber:null,nationalCode:null}),g=o(!1),j=o([]),Q=o([{title:"نام",key:"firstName"},{title:"نام خانوادگی",key:"lastName"},{title:"شماره موبایل",key:"phoneNumber"},{title:"کد ملی",key:"nationalCode"}]),z=o([]),$=o(!1),v=o({manager:null,code:null,name:null}),F=async()=>{try{$.value=!0;const t=await S.BranchList();return z.value=t.data,t}catch(t){t.response.status==401&&(localStorage.clear(),x.replace("/login")),V.value=t.response.data.error||"خطایی رخ داده است!",d.value=!0,setTimeout(()=>{d.value=!1},1e4)}finally{$.value=!1}},W=async()=>{try{T.value=!0;const t=await S.AddBranch(v.value);return p.value=!1,w.value=t.msg,f.value=!0,F(),setTimeout(()=>{f.value=!1},1e4),t}catch(t){t.response.status==401&&(localStorage.clear(),x.replace("/login")),V.value=t.response.data.error||"خطایی رخ داده است!",d.value=!0,setTimeout(()=>{d.value=!1},1e4)}finally{T.value=!1}},X=async t=>{m.value=t,k.value=!0,R(m.value.id)},R=async t=>{try{D.value=!0;const e=await S.SellerList(t);return j.value=e.data,setTimeout(()=>{f.value=!1},1e4),e}catch(e){e.response.status==401&&(localStorage.clear(),x.replace("/login")),V.value=e.response.data.error||"خطایی رخ داده است!",d.value=!0,setTimeout(()=>{d.value=!1},1e4)}finally{D.value=!1}},Y=async()=>{try{A.value=!0;const t=await S.AddSeller(n.value,m.value.id);return g.value=!1,w.value=t.msg,f.value=!0,R(m.value.id),setTimeout(()=>{f.value=!1},1e4),n.value.firstName=null,n.value.lastName=null,n.value.phoneNumber=null,n.value.nationalcode=null,t}catch(t){t.response.status==401&&(localStorage.clear(),x.replace("/login")),V.value=t.response.data.error||"خطایی رخ داده است!",d.value=!0,setTimeout(()=>{d.value=!1},1e4)}finally{A.value=!1}},y=[t=>!!t||"این فیلد الزامی است"],Z=[t=>!!t||"شماره همراه الزامی است",t=>/^09\d{9}$/.test(t)||"شماره معتبر نیست"],ee=[t=>!!t||"کد ملی الزامی است",t=>/^\d{10}$/.test(t)||"کد ملی باید ۱۰ رقم باشد",t=>{if(!/^\d{10}$/.test(t))return!0;const e=+t[9],a=t.split("").slice(0,9).reduce((I,le,ae)=>I+ +le*(10-ae),0)%11;return a<2&&e===a||a>=2&&e+a===11||"کد ملی نامعتبر است"}];return se(()=>{F()}),(t,e)=>(M(),oe(ue,null,[u("div",null,[l(E,null,{default:s(()=>[l(B,null,{default:s(()=>[l(r,{cols:"12"},{default:s(()=>[l(C,{title:"شعبه ها"},{text:s(()=>[l(i,{modelValue:_.value,"onUpdate:modelValue":e[1]||(e[1]=a=>_.value=a),label:"جستجو","prepend-inner-icon":"ri-search-line"},null,8,["modelValue"])]),default:s(()=>[u("div",re,[l(c,{onClick:e[0]||(e[0]=a=>p.value=!0),class:"mx-2"},{default:s(()=>e[18]||(e[18]=[N("افزودن شعبه")])),_:1})]),l(J,{headers:O.value,items:z.value,search:_.value,loading:$.value},{"item.action":s(({item:a})=>[l(ne,{class:"me-2",size:"small",icon:"ri-store-line",color:"#d4af37",onClick:I=>X(a)},null,8,["onClick"])]),_:1},8,["headers","items","search","loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),l(h,{modelValue:p.value,"onUpdate:modelValue":e[7]||(e[7]=a=>p.value=a),"max-width":"600",class:"dialog"},{default:s(()=>[l(C,{class:"dialog-card"},{default:s(()=>[e[19]||(e[19]=u("div",{class:"k-dialog-title"},[u("p",null,"افزودن شعبه جدید")],-1)),l(K,{ref:"form",modelValue:L.value,"onUpdate:modelValue":e[6]||(e[6]=a=>L.value=a),onSubmit:P(W,["prevent"])},{default:s(()=>[l(B,null,{default:s(()=>[l(r,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[l(i,{modelValue:v.value.name,"onUpdate:modelValue":e[2]||(e[2]=a=>v.value.name=a),label:"نام شعبه",variant:"outlined",rules:y},null,8,["modelValue"])]),_:1}),l(r,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[l(i,{modelValue:v.value.code,"onUpdate:modelValue":e[3]||(e[3]=a=>v.value.code=a),label:"کد شعبه",variant:"outlined",rules:y},null,8,["modelValue"])]),_:1}),l(r,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[l(i,{modelValue:v.value.manager,"onUpdate:modelValue":e[4]||(e[4]=a=>v.value.manager=a),label:"مدیر شعبه",variant:"outlined",rules:y},null,8,["modelValue"])]),_:1})]),_:1}),u("div",de,[l(c,{text:"انصراف",onClick:e[5]||(e[5]=a=>p.value=!1),size:"large",class:"m-3",variant:"outlined"}),l(c,{type:"submit",text:"افزودن",size:"large",class:"m-3",loading:T.value,disabled:!L.value},null,8,["loading","disabled"])])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),l(h,{modelValue:k.value,"onUpdate:modelValue":e[10]||(e[10]=a=>k.value=a),transition:"dialog-bottom-transition",fullscreen:""},{default:s(()=>[l(C,null,{default:s(()=>[u("div",ie,[l(c,{variant:"text",icon:"ri-close-large-line",onClick:e[8]||(e[8]=a=>k.value=!1)})]),l(E,null,{default:s(()=>[l(B,{class:"wallet-info-box"},{default:s(()=>[l(r,{cols:"12"},{default:s(()=>[u("div",me,[l(c,{onClick:e[9]||(e[9]=a=>g.value=!0),class:"mx-2"},{default:s(()=>e[20]||(e[20]=[N("افزودن فروشنده")])),_:1})])]),_:1}),l(r,{cols:"6",md:"4",class:"my-3"},{default:s(()=>[u("div",ve,[e[21]||(e[21]=u("p",{class:"title"},"نام شعبه: ",-1)),u("p",ce,b(m.value.name),1)])]),_:1}),l(r,{cols:"6",md:"4",class:"my-3"},{default:s(()=>[u("div",fe,[e[22]||(e[22]=u("p",{class:"title"},"کد شعبه: ",-1)),u("p",pe,b(m.value.code),1)])]),_:1}),l(r,{cols:"6",md:"4",class:"my-3"},{default:s(()=>[u("div",Ve,[e[23]||(e[23]=u("p",{class:"title"},"مدیریت شعبه: ",-1)),u("p",ge,b(m.value.manager),1)])]),_:1}),l(r,{cols:"12",class:"my-2"},{default:s(()=>[l(J,{headers:Q.value,items:j.value,loading:D.value},null,8,["headers","items","loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(h,{modelValue:g.value,"onUpdate:modelValue":e[17]||(e[17]=a=>g.value=a),"max-width":"600",class:"dialog"},{default:s(()=>[l(C,{class:"dialog-card"},{default:s(()=>[e[24]||(e[24]=u("div",{class:"k-dialog-title"},[u("p",null,"افزودن کارمند جدید")],-1)),l(K,{ref:"form",modelValue:U.value,"onUpdate:modelValue":e[16]||(e[16]=a=>U.value=a),onSubmit:P(Y,["prevent"])},{default:s(()=>[l(B,null,{default:s(()=>[l(r,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[l(i,{modelValue:n.value.firstName,"onUpdate:modelValue":e[11]||(e[11]=a=>n.value.firstName=a),label:"نام",variant:"outlined",rules:y},null,8,["modelValue"])]),_:1}),l(r,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[l(i,{modelValue:n.value.lastName,"onUpdate:modelValue":e[12]||(e[12]=a=>n.value.lastName=a),label:"نام خانوادگی",variant:"outlined",rules:y},null,8,["modelValue"])]),_:1}),l(r,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[l(i,{modelValue:n.value.phoneNumber,"onUpdate:modelValue":e[13]||(e[13]=a=>n.value.phoneNumber=a),label:"شماره همراه",variant:"outlined",rules:Z},null,8,["modelValue"])]),_:1}),l(r,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[l(i,{modelValue:n.value.nationalCode,"onUpdate:modelValue":e[14]||(e[14]=a=>n.value.nationalCode=a),label:"کد ملی",variant:"outlined",rules:ee},null,8,["modelValue"])]),_:1})]),_:1}),u("div",ye,[l(c,{text:"انصراف",onClick:e[15]||(e[15]=a=>g.value=!1),size:"large",class:"m-3",variant:"outlined"}),l(c,{type:"submit",text:"افزودن",size:"large",class:"m-3",loading:A.value,disabled:!U.value},null,8,["loading","disabled"])])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),d.value?(M(),G(q,{key:0,color:"error",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:s(()=>[N(b(V.value),1)]),_:1})):H("",!0),f.value?(M(),G(q,{key:1,color:"success",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:s(()=>[N(b(w.value),1)]),_:1})):H("",!0)],64))}},Ie=te(be,[["__scopeId","data-v-bf2794a1"]]);export{Ie as default};
