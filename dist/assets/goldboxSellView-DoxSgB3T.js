import{_ as Q,r,k as X,c as Y,b as l,w as o,a1 as k,e as G,h as w,a0 as N,q as Z,o as U,a2 as u,C as m,a as i,a4 as y,t as f}from"./index-DmyvV4Cp.js";import{G as P}from"./goldbox-BNRnn_FD.js";import{I as h}from"./inperson-C0v7yAed.js";import{V as I}from"./VAlert-BFVTUyzE.js";import{V as ee,a as F,b as le,c as H}from"./VTabs-Dp-yOtvE.js";import{a as ae,V as $}from"./VCard-XeOkZyxL.js";import{V as s}from"./VTextField-dWKw18Cp.js";import{V as j}from"./VDataTable-DY3O5FhC.js";import{a as L}from"./VSelect-WED0wDAM.js";import"./createSimpleFunctional-BX2EtbtN.js";import"./index-Cc7NgPud.js";import"./VWindowItem-BHCd-TSK.js";import"./dialog-transition-CX1EheXI.js";import"./index-Ck_p4MnA.js";import"./VMenu-DssHFKDT.js";import"./VAvatar-B0PAs8sg.js";import"./VImg-BpwUdXJb.js";import"./VDivider-BnvhPvq_.js";import"./VSelectionControl-B56v8Qhs.js";const te={class:"w-100 d-flex justify-end"},oe={class:"w-100 d-flex justify-end"},de={class:"w-100 d-flex justify-end"},ue={class:"w-100 d-flex justify-end"},se={__name:"goldboxSellView",setup(ie){const V=r(""),M=r(""),v=r(!1),R=r(!1),c=r(null),_=r([{title:"نام",key:"seller.firstName"},{title:"نام خانوادگی",key:"seller.lastName"},{title:"مبلغ خرید (تومان)",key:"totalPrice"},{title:"وزن طلا (گرم)",key:"goldWeight"},{title:"تاریخ",key:"date"},{title:"زمان",key:"time"},{title:"شناسه پرداخت",key:"invoiceId"},{title:"وضعیت",key:"status"}]),z=r([{title:"نام",key:"seller.firstName"},{title:"نام خانوادگی",key:"seller.lastName"},{title:"مبلغ خرید (تومان)",key:"totalPrice"},{title:"وزن طلا (گرم)",key:"goldWeight"},{title:"تاریخ",key:"date"},{title:"زمان",key:"time"},{title:"شناسه پرداخت",key:"invoiceId"},{title:"وضعیت",key:"status"}]),b=r(),p=r(),g=r(),x=r(),E=r(),t=r({firstName:"",lastName:"",nationalCode:"",phoneNumber:"",tradeType:0,type:"sell",goldPrice:"",goldWeight:"",admin:"",accounter:"",startDate:"",startTime:"",endDate:"",endTime:"",invoiceId:"",status:""}),q=async()=>{try{p.value=!0;const d=await P.SellGoldBox(1);return b.value=d.data,d}catch(d){d.response.status==401&&(localStorage.clear(),N.replace("/login")),V.value=d.response.data.error||"خطایی رخ داده است!",v.value=!0,setTimeout(()=>{v.value=!1},1e4)}finally{p.value=!1}},A=async()=>{try{g.value=!0;const d=await P.SellGoldBox(0);return x.value=d.data,d}catch(d){d.response.status==401&&(localStorage.clear(),N.replace("/login")),V.value=d.response.data.error||"خطایی رخ داده است!",v.value=!0,setTimeout(()=>{v.value=!1},1e4)}finally{g.value=!1}},T=d=>d.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),S=[d=>/^\d{10}$/.test(d)||"کد ملی باید ۱۰ رقم باشد",d=>{if(!/^\d{10}$/.test(d))return!0;const e=+d[9],n=d.split("").slice(0,9).reduce((a,K,O)=>a+ +K*(10-O),0)%11;return n<2&&e===n||n>=2&&e+n===11||"کد ملی نامعتبر است"}],W=()=>{t.value.phoneNumber=t.value.phoneNumber.replace(/\D/g,"").slice(0,11)},C=[d=>/^09\d{9}$/.test(d)||"شماره معتبر نیست"],B=[d=>!!d,d=>/^\d+(\.\d{1,3})?$/.test(d)],J=()=>{t.value.firstName="",t.value.lastName="",t.value.accounter="",t.value.admin="",t.value.endDate="",t.value.endTime="",t.value.goldPrice="",t.value.goldWeight="",t.value.invoiceId="",t.value.nationalCode="",t.value.phoneNumber="",t.value.startTime="",t.value.startDate=""},D=async d=>{console.log(d);try{d=="completed"?p.value=!0:d=="failed"&&(g.value=!0),t.value.status=d;const e=await h.SubmitFilterInvoice(t.value);return d=="completed"?b.value=e.data:d=="failed"&&(x.value=e.data),e}catch(e){e.response.status==401&&(localStorage.clear(),N.replace("/login")),V.value=e.response.data.error||"خطایی رخ داده است!",v.value=!0,setTimeout(()=>{v.value=!1},1e4)}finally{p.value=!1,g.value=!1}};return X(()=>{q(),A()}),(d,e)=>{const n=Z("persian-date-picker");return U(),Y("div",null,[l(k,null,{default:o(()=>[l(u,null,{default:o(()=>[l(ee,{modelValue:c.value,"onUpdate:modelValue":[e[0]||(e[0]=a=>c.value=a),J],"align-tabs":"center"},{default:o(()=>[l(F,{value:"one"},{default:o(()=>e[28]||(e[28]=[m("فروش های موفق")])),_:1}),l(F,{value:"two"},{default:o(()=>e[29]||(e[29]=[m("فروش های ناموفق")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(u,{cols:"12"},{default:o(()=>[l(ae,null,{default:o(()=>[l(le,{modelValue:c.value,"onUpdate:modelValue":e[27]||(e[27]=a=>c.value=a)},{default:o(()=>[l(H,{value:"one"},{default:o(()=>[l(k,{class:"filter my-3"},{default:o(()=>[l(u,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:t.value.startDate,"onUpdate:modelValue":e[1]||(e[1]=a=>t.value.startDate=a),placeholder:"از تاریخ"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(n,{type:"time",modelValue:t.value.startTime,"onUpdate:modelValue":e[2]||(e[2]=a=>t.value.startTime=a),placeholder:"از زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:t.value.endDate,"onUpdate:modelValue":e[3]||(e[3]=a=>t.value.endDate=a),placeholder:"تا تاریخ"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(n,{type:"time",modelValue:t.value.endTime,"onUpdate:modelValue":e[4]||(e[4]=a=>t.value.endTime=a),placeholder:"تا زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.firstName,"onUpdate:modelValue":e[5]||(e[5]=a=>t.value.firstName=a),label:"نام",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.lastName,"onUpdate:modelValue":e[6]||(e[6]=a=>t.value.lastName=a),label:"نام خانوادگی",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.phoneNumber,"onUpdate:modelValue":e[7]||(e[7]=a=>t.value.phoneNumber=a),label:"شماره موبایل",density:"compact",variant:"outlined",rules:C,onInput:W},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.nationalCode,"onUpdate:modelValue":e[8]||(e[8]=a=>t.value.nationalCode=a),label:"کد ملی",density:"compact",variant:"outlined",rules:S},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.goldPrice,"onUpdate:modelValue":e[9]||(e[9]=a=>t.value.goldPrice=a),label:"قیمت طلا",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.goldWeight,"onUpdate:modelValue":e[10]||(e[10]=a=>t.value.goldWeight=a),label:"وزن طلا",density:"compact",variant:"outlined",rules:B},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.goldWeight,"onUpdate:modelValue":e[11]||(e[11]=a=>t.value.goldWeight=a),label:"ادمین",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.goldWeight,"onUpdate:modelValue":e[12]||(e[12]=a=>t.value.goldWeight=a),label:"حسابدار",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{md:"6",class:"d-none d-md-flex"}),l(u,{cols:"12",md:"3"},{default:o(()=>[i("div",te,[l(y,{"prepend-icon":"ri-loop-left-line",variant:"tonal",block:"",onClick:e[13]||(e[13]=a=>D("completed"))},{default:o(()=>e[30]||(e[30]=[m("به روز رسانی")])),_:1})])]),_:1}),l(u,{cols:"12",md:"3"},{default:o(()=>[i("div",oe,[l(y,{"prepend-icon":"ri-file-excel-line",block:""},{default:o(()=>e[31]||(e[31]=[m("خروجی اکسل")])),_:1})])]),_:1})]),_:1}),l($,{title:"فروش موفق"},{default:o(()=>[e[32]||(e[32]=i("ul",{class:"listGuide"},[i("li",null," معاملاتی که فرآیند فروش آن‌ها توسط کاربران در سایت و اپلیکیشن انجام شده و مبلغ مورد نظر از سوی حسابداری به حساب منتخب کاربر بازگردانده شده است. ")],-1)),l(j,{headers:_.value,items:b.value,loading:p.value},{"item.totalPrice":o(({item:a})=>[i("p",null,f(T(a.totalPrice)),1)]),"item.goldWeight":o(({item:a})=>[i("p",null,f((+a.goldWeight).toFixed(3)),1)]),"item.status":o(({item:a})=>[i("div",null,[l(L,{text:a.status=="completed"?"موفق":"نامشخص",color:a.status=="completed"?"#00853f":"#66666",size:"small"},null,8,["text","color"])])]),_:1},8,["headers","items","loading"])]),_:1})]),_:1}),l(H,{value:"two"},{default:o(()=>[l(k,{class:"filter my-3"},{default:o(()=>[l(u,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:t.value.startDate,"onUpdate:modelValue":e[14]||(e[14]=a=>t.value.startDate=a),placeholder:"از تاریخ"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(n,{type:"time",modelValue:t.value.startTime,"onUpdate:modelValue":e[15]||(e[15]=a=>t.value.startTime=a),placeholder:"از زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:t.value.endDate,"onUpdate:modelValue":e[16]||(e[16]=a=>t.value.endDate=a),placeholder:"تا تاریخ"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(n,{type:"time",modelValue:t.value.endTime,"onUpdate:modelValue":e[17]||(e[17]=a=>t.value.endTime=a),placeholder:"تا زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.firstName,"onUpdate:modelValue":e[18]||(e[18]=a=>t.value.firstName=a),label:"نام",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.lastName,"onUpdate:modelValue":e[19]||(e[19]=a=>t.value.lastName=a),label:"نام خانوادگی",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.phoneNumber,"onUpdate:modelValue":e[20]||(e[20]=a=>t.value.phoneNumber=a),label:"شماره موبایل",density:"compact",variant:"outlined",rules:C,onInput:W},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.nationalCode,"onUpdate:modelValue":e[21]||(e[21]=a=>t.value.nationalCode=a),label:"کد ملی",density:"compact",variant:"outlined",rules:S},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.goldPrice,"onUpdate:modelValue":e[22]||(e[22]=a=>t.value.goldPrice=a),label:"قیمت طلا",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.goldWeight,"onUpdate:modelValue":e[23]||(e[23]=a=>t.value.goldWeight=a),label:"وزن طلا",density:"compact",variant:"outlined",rules:B},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.goldWeight,"onUpdate:modelValue":e[24]||(e[24]=a=>t.value.goldWeight=a),label:"ادمین",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.goldWeight,"onUpdate:modelValue":e[25]||(e[25]=a=>t.value.goldWeight=a),label:"حسابدار",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{md:"6",class:"d-none d-md-flex"}),l(u,{cols:"12",md:"3"},{default:o(()=>[i("div",de,[l(y,{"prepend-icon":"ri-loop-left-line",variant:"tonal",block:"",onClick:e[26]||(e[26]=a=>D("failed"))},{default:o(()=>e[33]||(e[33]=[m("به روز رسانی")])),_:1})])]),_:1}),l(u,{cols:"12",md:"3"},{default:o(()=>[i("div",ue,[l(y,{"prepend-icon":"ri-file-excel-line",block:""},{default:o(()=>e[34]||(e[34]=[m("خروجی اکسل")])),_:1})])]),_:1})]),_:1}),l($,{title:"فروش ناموفق"},{default:o(()=>[e[35]||(e[35]=i("ul",{class:"listGuide"},[i("li",null," معاملاتی که فرایند فروش آنها توسط کاربران از طریق سایت یا اپلیکیشن صورت گرفته، اما به‌دلیل انصراف کاربر یا عوامل دیگر لغو شده‌اند. ")],-1)),l(j,{headers:z.value,items:x.value,search:E.value,loading:p.value},{"item.totalPrice":o(({item:a})=>[i("p",null,f(T(a.totalPrice)),1)]),"item.goldWeight":o(({item:a})=>[i("p",null,f((+a.goldWeight).toFixed(3)),1)]),"item.status":o(({item:a})=>[i("div",null,[l(L,{text:a.status=="failed"?"ناموفق":"نامشخص",color:a.status=="failed"?"#ff0000":"#66666",size:"small"},null,8,["text","color"])])]),_:1},8,["headers","items","search","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),v.value?(U(),G(I,{key:0,color:"error",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:o(()=>[m(f(V.value),1)]),_:1})):w("",!0),R.value?(U(),G(I,{key:1,color:"success",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:o(()=>[m(f(M.value),1)]),_:1})):w("",!0)])}}},Be=Q(se,[["__scopeId","data-v-2db2f3bc"]]);export{Be as default};
