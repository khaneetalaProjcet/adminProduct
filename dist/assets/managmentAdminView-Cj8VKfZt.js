import{_ as ae,r as o,k as se,c as m,b as s,w as t,a8 as te,e as B,h as P,F,a0 as v,o as i,a1 as G,a2 as A,a as n,a4 as f,C as z,V as D,a7 as oe,a3 as ne,t as h}from"./index-CdAMT_3h.js";import{M as p}from"./managment-BcampCuy.js";import{V as $}from"./VDialog-BxMNxr6i.js";import{V as re}from"./VAlert-BMm7IBIL.js";import{V as N}from"./VCard-1q86pdq_.js";import{V as b}from"./VTextField-BCEffTT9.js";import{V as ie}from"./VDataTable-C2eF2mVx.js";import{V as j}from"./VSwitch-CP3DG8ES.js";import{V as ue}from"./VForm-BhvwazX6.js";import"./api-CBLtChw8.js";import"./dialog-transition-BDMvgG2z.js";import"./index-BuZqeJ5n.js";import"./index-CNzcn5y8.js";import"./createSimpleFunctional-kU0jGw9L.js";import"./VAvatar-zfvx0gMW.js";import"./VImg-Cc-k-5-6.js";import"./VSelect-BxU8kfT2.js";import"./VMenu-BxMh9dNF.js";import"./VDivider-DACz2nk5.js";import"./VSelectionControl-_HD32Xl0.js";const de={class:"px-5 py-3 d-flex justify-end"},me={key:0,class:"table-green"},ce={key:1,class:"table-red"},ve={class:"d-flex flex-column w-100 h-100 my-2"},fe={key:0,class:"dialog-loading"},pe={class:"d-flex justify-space-between"},ge={class:"d-flex justify-space-between"},Ve={class:"d-flex flex-column w-100 h-100 my-2"},ye={key:0,class:"dialog-access-loading"},ke={key:1,class:"d-flex justify-space-between align-items-center mx-4 my-2"},Ae={class:"d-flex justify-space-between"},be={__name:"managmentAdminView",setup(we){const E=o([{title:"نام",key:"firstName"},{title:"نام خانوادگی",key:"lastName"},{title:"شماره همراه",key:"phoneNumber"},{title:"نقش",key:"role"},{title:"اکتیو",key:"isBlocked"},{title:"فعالیت",key:"action"},{title:"بلاک شده",key:"status"}]),I=o([]),S=o(""),C=o(!1),L=o(!1),U=o(!1),_=o(!1),c=o(!1),T=o(!1),w=o(),x=o(!1),g=o(!1),V=o(!1),d=o(""),r=o(!1),y=o(!1),u=o({firstName:"",lastName:"",phoneNumber:"",password:"",role:0}),M=o(""),R=async()=>{try{C.value=!0;const e=await p.AdminList();return I.value=e.data,e}catch(e){e.response.status==401&&(localStorage.clear(),v.replace("/login")),d.value=e.response.data.error||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{C.value=!1}},Z=async e=>{try{_.value=!0;const l=await p.AccessPoint(e);return w.value=l.data,l}catch(l){l.response.status==401&&(localStorage.clear(),v.replace("/login")),d.value=l.response.data.error||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{_.value=!1}},q=async()=>{try{c.value=!0;const e=await p.GetPermission();return e.data==0?x.value=!1:x.value=!0,V.value=!0,e}catch(e){e.response.status==401&&(localStorage.clear(),v.replace("/login")),d.value=e.response.data.error||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{c.value=!1}},H=async()=>{try{c.value=!0;const e=await p.TradePermission();return w.value=e.data,V.value=!1,e}catch(e){e.response.status==401&&(localStorage.clear(),v.replace("/login")),d.value=e.response.data.error||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{c.value=!1}},J=async e=>{g.value=!0,Z(e.id),M.value=e.id},K=async()=>{try{T.value=!0;const e=await p.SubmitAccessPoint(w.value,M.value);return g.value=!1,e}catch(e){e.response.status==401&&(localStorage.clear(),v.replace("/login")),d.value=e.response.data.error||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{T.value=!1}},O=async()=>{try{L.value=!0;const e=await p.AddAdmin(u.value);return y.value=!1,R(),e}catch(e){e.response.status==401&&(localStorage.clear(),v.replace("/login")),d.value=e.response.data.error||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{L.value=!1}},Q=[e=>!!e||"شماره همراه الزامی است",e=>/^09\d{9}$/.test(e)||"شماره معتبر نیست"],W=[e=>!!e||"رمز عبور الزامی است",e=>e&&e.length>=8||"رمز عبور باید حداقل ۸ کاراکتر باشد",e=>/[A-Z]/.test(e)||"رمز عبور باید حداقل یک حرف بزرگ داشته باشد",e=>/[a-z]/.test(e)||"رمز عبور باید حداقل یک حرف کوچک داشته باشد",e=>/[0-9]/.test(e)||"رمز عبور باید حداقل یک عدد داشته باشد",e=>/[^A-Za-z0-9]/.test(e)||"رمز عبور باید حداقل یک کاراکتر خاص (!@#$%^&*) داشته باشد"],X=[e=>!!e||"نام الزامی است"],Y=[e=>!!e||"نام خانوادگی الزامی است"],ee=async e=>{try{U.value=!0,console.log("test");const l=await p.SwitchAdminActivator(e.id);return console.log("test"),l}catch(l){l.response.status==401&&(localStorage.clear(),v.replace("/login")),d.value=l.response.data.error||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{U.value=!1}};return se(()=>{R()}),(e,l)=>(i(),m(F,null,[s(te,null,{default:t(()=>[s(G,null,{default:t(()=>[s(A,{cols:"12"},{default:t(()=>[s(N,{title:"سطح دسترسی ها"},{text:t(()=>[s(b,{modelValue:S.value,"onUpdate:modelValue":l[1]||(l[1]=a=>S.value=a),label:"جستجو","prepend-inner-icon":"ri-search-line"},null,8,["modelValue"])]),default:t(()=>[n("div",de,[s(f,{onClick:l[0]||(l[0]=a=>y.value=!0),class:"mx-2"},{default:t(()=>l[13]||(l[13]=[z("افزودن کاربر")])),_:1}),s(f,{color:"error",class:"error-btn",loading:c.value,onClick:q},{default:t(()=>l[14]||(l[14]=[z(" دسترسی های مدیریتی ")])),_:1},8,["loading"])]),s(ie,{headers:E.value,items:I.value,search:S.value,loading:C.value},{"item.isBlocked":t(({item:a})=>[a.isBlocked==!0?(i(),B(D,{key:0,size:"small",icon:"ri-close-line",color:"#c9190c"})):a.isBlocked==!1?(i(),B(D,{key:1,size:"small",icon:"ri-check-line",color:"#0b8707"})):P("",!0)]),"item.role":t(({item:a})=>[a.role==!0?(i(),m("span",me,"مدیر")):a.role==!1?(i(),m("span",ce,"کارشناس")):P("",!0)]),"item.action":t(({item:a})=>[s(D,{class:"me-2",size:"small",icon:"ri-user-settings-line",color:"#d4af37",onClick:k=>J(a)},null,8,["onClick"])]),"item.status":t(({item:a})=>[s(j,{modelValue:a.isBlocked,"onUpdate:modelValue":k=>a.isBlocked=k,color:"#b08c4d",onInput:k=>ee(a),loading:U.value},null,8,["modelValue","onUpdate:modelValue","onInput","loading"])]),_:1},8,["headers","items","search","loading"])]),_:1})]),_:1})]),_:1})]),_:1}),s($,{modelValue:g.value,"onUpdate:modelValue":l[3]||(l[3]=a=>g.value=a),"max-width":"450",class:"dialog"},{default:t(()=>[s(N,{class:"dialog-card"},{default:t(()=>[l[16]||(l[16]=n("div",{class:"k-dialog-title"},[n("p",null,"سطح دسترسی")],-1)),n("div",ve,[_.value==!0?(i(),m("div",fe,l[15]||(l[15]=[n("p",null,"لطفا منتظر بمانید ... ",-1)]))):(i(!0),m(F,{key:1},oe(w.value,(a,k)=>(i(),m("div",{class:"d-flex justify-space-between align-items-center mx-4 my-2",key:k},[n("span",null,h(a.persianName),1),s(j,{modelValue:a.isAccess,"onUpdate:modelValue":le=>a.isAccess=le,color:"#b08c4d"},null,8,["modelValue","onUpdate:modelValue"])]))),128))]),n("div",pe,[s(f,{text:"انصراف",onClick:l[2]||(l[2]=a=>g.value=!1),size:"large",class:"m-3",variant:"outlined"}),s(f,{text:"ثبت دسترسی",onClick:K,size:"large",class:"m-3",loading:T.value},null,8,["loading"])])]),_:1})]),_:1},8,["modelValue"]),s($,{modelValue:y.value,"onUpdate:modelValue":l[9]||(l[9]=a=>y.value=a),"max-width":"600",class:"dialog"},{default:t(()=>[s(N,{class:"dialog-card"},{default:t(()=>[l[17]||(l[17]=n("div",{class:"k-dialog-title"},[n("p",null,"افزودن ادمین جدید")],-1)),s(ue,{ref:"form",onSubmit:ne(O,["prevent"])},{default:t(()=>[s(G,null,{default:t(()=>[s(A,{cols:"12",md:"6",class:"my-4"},{default:t(()=>[s(b,{modelValue:u.value.firstName,"onUpdate:modelValue":l[4]||(l[4]=a=>u.value.firstName=a),label:"نام",variant:"outlined",rules:X},null,8,["modelValue"])]),_:1}),s(A,{cols:"12",md:"6",class:"my-4"},{default:t(()=>[s(b,{modelValue:u.value.lastName,"onUpdate:modelValue":l[5]||(l[5]=a=>u.value.lastName=a),label:"نام خانوادگی",variant:"outlined",rules:Y},null,8,["modelValue"])]),_:1}),s(A,{cols:"12",md:"6",class:"my-4"},{default:t(()=>[s(b,{modelValue:u.value.phoneNumber,"onUpdate:modelValue":l[6]||(l[6]=a=>u.value.phoneNumber=a),label:"شماره همراه",variant:"outlined",rules:Q},null,8,["modelValue"])]),_:1}),s(A,{cols:"12",md:"6",class:"my-4"},{default:t(()=>[s(b,{modelValue:u.value.password,"onUpdate:modelValue":l[7]||(l[7]=a=>u.value.password=a),label:"رمز عبور",variant:"outlined",rules:W},null,8,["modelValue"])]),_:1})]),_:1}),n("div",ge,[s(f,{text:"انصراف",onClick:l[8]||(l[8]=a=>y.value=!1),size:"large",class:"m-3",variant:"outlined"}),s(f,{type:"submit",text:"افزودن",size:"large",class:"m-3",loading:L.value},null,8,["loading"])])]),_:1},512)]),_:1})]),_:1},8,["modelValue"]),s($,{modelValue:V.value,"onUpdate:modelValue":l[12]||(l[12]=a=>V.value=a),"max-width":"450",class:"dialog"},{default:t(()=>[s(N,{class:"dialog-card"},{default:t(()=>[l[20]||(l[20]=n("div",{class:"k-dialog-title"},[n("p",null,"دسترسی های مدیرتی")],-1)),n("div",Ve,[c.value==!0?(i(),m("div",ye,l[18]||(l[18]=[n("p",null,"لطفا منتظر بمانید ... ",-1)]))):(i(),m("div",ke,[l[19]||(l[19]=n("span",null,"درگاه معاملات",-1)),s(j,{modelValue:x.value,"onUpdate:modelValue":l[10]||(l[10]=a=>x.value=a),color:"#b08c4d",onClick:H,loading:c.value},null,8,["modelValue","loading"])]))]),n("div",Ae,[s(f,{text:"انصراف",onClick:l[11]||(l[11]=a=>V.value=!1),size:"large",class:"m-3",variant:"outlined"})])]),_:1})]),_:1},8,["modelValue"]),r.value?(i(),B(re,{key:0,color:"error",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:t(()=>[z(h(d.value),1)]),_:1})):P("",!0)],64))}},Ee=ae(be,[["__scopeId","data-v-589a4df7"]]);export{Ee as default};
