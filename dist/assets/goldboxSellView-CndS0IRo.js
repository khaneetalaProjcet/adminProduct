import{_ as Pe,r as u,j as X,k as Ne,c as ke,b as l,w as o,a1 as G,e as Y,h as Z,a0 as I,q as Ce,o as W,a2 as s,C as m,a as i,a4 as P,t as v}from"./index-BkH5dq_V.js";import{G as _}from"./goldbox-DPn5sBD1.js";import{I as Ue}from"./inperson-CX7ma5mH.js";import{l as h}from"./lodash-ucq9eIi8.js";import{V as ee}from"./VAlert-URG6_RX0.js";import{V as we,a as le,b as Te,c as ae}from"./VTabs-BqXXcZmI.js";import{a as Se,V as te}from"./VCard-C7y9BE-P.js";import{V as n}from"./VTextField-qI54TM7-.js";import{V as oe,a as de}from"./VDataTable-BW-tyGIM.js";import{V as ue}from"./VChip-88C07mgm.js";import"./api-BnzD3sMC.js";import"./createSimpleFunctional-2Tr5NrWF.js";import"./index-rJ7hc3P5.js";import"./VWindowItem-LRD2Vs_9.js";import"./dialog-transition-BOR4k9gS.js";import"./index-B6PZEgFI.js";import"./VMenu-CzXYblIs.js";import"./VAvatar-CmMlPH2O.js";import"./VImg-BGm7fA-k.js";import"./VDivider-CVY66NnH.js";import"./VSelect-DyCA_Y7m.js";import"./VSelectionControl-DfcNo9gL.js";const Fe={class:"w-100 d-flex justify-end"},Be={class:"w-100 d-flex justify-end"},De={class:"text-center pt-2"},Ge={class:"w-100 d-flex justify-end"},Ie={class:"w-100 d-flex justify-end"},We={class:"text-center pt-2"},He={__name:"goldboxSellView",setup(Ee){const V=u(""),se=u(""),p=u(!1),ne=u(!1),g=u(null),ie=u([{title:"نام",key:"seller.firstName"},{title:"نام خانوادگی",key:"seller.lastName"},{title:"مبلغ خرید (تومان)",key:"totalPrice"},{title:"وزن طلا (گرم)",key:"goldWeight"},{title:"تاریخ",key:"date"},{title:"زمان",key:"time"},{title:"شناسه پرداخت",key:"invoiceId"},{title:"وضعیت",key:"status"}]),re=u([{title:"نام",key:"seller.firstName"},{title:"نام خانوادگی",key:"seller.lastName"},{title:"مبلغ خرید (تومان)",key:"totalPrice"},{title:"وزن طلا (گرم)",key:"goldWeight"},{title:"تاریخ",key:"date"},{title:"زمان",key:"time"},{title:"شناسه پرداخت",key:"invoiceId"},{title:"وضعیت",key:"status"}]),N=u(),c=u(),f=u(),k=u(),me=u(),t=u({firstName:"",lastName:"",nationalCode:"",phoneNumber:"",tradeType:0,type:"sell",goldPrice:"",goldWeight:"",admin:"",accounter:"",startDate:"",startTime:"",endDate:"",endTime:"",invoiceId:"",status:"",destCardPan:""}),H=u(!0),E=u(!0),L=u(""),b=u(!1),pe=u(50),C=u(50),U=u(1),$=u(1),ve=u([10,25]),w=u(0),j=u(1),y=u(""),ce=u(50),T=u(50),S=u(1),A=u(1),fe=u([10,25]),F=u(0),M=u(1),x=u(""),B=async()=>{try{c.value=!0;const d=await _.SellGoldBox({page:$.value,perPage:C.value,search:y.value},1);return w.value=d.data.totalItems,N.value=d.data.transActions,j.value=Math.ceil(w.value/C.value),d}catch(d){d.response.status==401&&(localStorage.clear(),I.replace("/login")),V.value=d.response.data.error||"خطایی رخ داده است!",p.value=!0,setTimeout(()=>{p.value=!1},1e4)}finally{c.value=!1}},Ve=d=>{U.value=d.page,pe.value=d.itemsPerPage,B()};X(y,h.debounce(()=>{B()},1e3));const D=async()=>{try{f.value=!0;const d=await _.SellGoldBox({page:A.value,perPage:T.value,search:x.value},0);return F.value=d.data.totalItems,k.value=d.data.transActions,M.value=Math.ceil(F.value/T.value),d}catch(d){d.response.status==401&&(localStorage.clear(),I.replace("/login")),V.value=d.response.data.error||"خطایی رخ داده است!",p.value=!0,setTimeout(()=>{p.value=!1},1e4)}finally{f.value=!1}},ge=d=>{S.value=d.page,ce.value=d.itemsPerPage,D()};X(x,h.debounce(()=>{D()},1e3));const O=d=>d.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),R=[d=>/^\d{10}$/.test(d)||"کد ملی باید ۱۰ رقم باشد",d=>{if(!/^\d{10}$/.test(d))return!0;const e=+d[9],r=d.split("").slice(0,9).reduce((a,ye,xe)=>a+ +ye*(10-xe),0)%11;return r<2&&e===r||r>=2&&e+r===11||"کد ملی نامعتبر است"}],z=()=>{t.value.phoneNumber=t.value.phoneNumber.replace(/\D/g,"").slice(0,11)},q=[d=>/^09\d{9}$/.test(d)||"شماره معتبر نیست"],J=[d=>!!d,d=>/^\d+(\.\d{1,3})?$/.test(d)],be=()=>{t.value.firstName="",t.value.lastName="",t.value.accounter="",t.value.admin="",t.value.endDate="",t.value.endTime="",t.value.goldPrice="",t.value.goldWeight="",t.value.invoiceId="",t.value.nationalCode="",t.value.phoneNumber="",t.value.startTime="",t.value.startDate="",t.value.destCardPan=""},K=async d=>{console.log(d);try{d=="completed"?c.value=!0:d=="failed"&&(f.value=!0),t.value.status=d;const e=await Ue.SubmitFilterInvoice(t.value);return L.value=e.link,d=="completed"?(N.value=e.data.transActions,H.value=!1):d=="failed"&&(k.value=e.data.transActions,E.value=!1),e}catch(e){e.response.status==401&&(localStorage.clear(),I.replace("/login")),V.value=e.response.data.error||"خطایی رخ داده است!",p.value=!0,setTimeout(()=>{p.value=!1},1e4)}finally{c.value=!1,f.value=!1}},Q=async()=>{b.value=!0,window.location.href=L.value,setTimeout(()=>{b.value=!1},5e3)};return Ne(()=>{B(),D()}),(d,e)=>{const r=Ce("persian-date-picker");return W(),ke("div",null,[l(G,null,{default:o(()=>[l(s,null,{default:o(()=>[l(we,{modelValue:g.value,"onUpdate:modelValue":[e[0]||(e[0]=a=>g.value=a),be],"align-tabs":"center"},{default:o(()=>[l(le,{value:"one"},{default:o(()=>e[32]||(e[32]=[m("فروش های موفق")])),_:1}),l(le,{value:"two"},{default:o(()=>e[33]||(e[33]=[m("فروش های ناموفق")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(s,{cols:"12"},{default:o(()=>[l(Se,null,{default:o(()=>[l(Te,{modelValue:g.value,"onUpdate:modelValue":e[31]||(e[31]=a=>g.value=a)},{default:o(()=>[l(ae,{value:"one"},{default:o(()=>[l(G,{class:"filter my-3"},{default:o(()=>[l(s,{cols:"6",md:"3"},{default:o(()=>[l(r,{modelValue:t.value.startDate,"onUpdate:modelValue":e[1]||(e[1]=a=>t.value.startDate=a),placeholder:"از تاریخ"},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:o(()=>[l(r,{type:"time",modelValue:t.value.startTime,"onUpdate:modelValue":e[2]||(e[2]=a=>t.value.startTime=a),placeholder:"از زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:o(()=>[l(r,{modelValue:t.value.endDate,"onUpdate:modelValue":e[3]||(e[3]=a=>t.value.endDate=a),placeholder:"تا تاریخ"},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:o(()=>[l(r,{type:"time",modelValue:t.value.endTime,"onUpdate:modelValue":e[4]||(e[4]=a=>t.value.endTime=a),placeholder:"تا زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:t.value.firstName,"onUpdate:modelValue":e[5]||(e[5]=a=>t.value.firstName=a),label:"نام",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:t.value.lastName,"onUpdate:modelValue":e[6]||(e[6]=a=>t.value.lastName=a),label:"نام خانوادگی",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:t.value.phoneNumber,"onUpdate:modelValue":e[7]||(e[7]=a=>t.value.phoneNumber=a),label:"شماره موبایل",density:"compact",variant:"outlined",rules:q,onInput:z},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:t.value.nationalCode,"onUpdate:modelValue":e[8]||(e[8]=a=>t.value.nationalCode=a),label:"کد ملی",density:"compact",variant:"outlined",rules:R},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:t.value.goldPrice,"onUpdate:modelValue":e[9]||(e[9]=a=>t.value.goldPrice=a),label:"قیمت طلا",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:t.value.goldWeight,"onUpdate:modelValue":e[10]||(e[10]=a=>t.value.goldWeight=a),label:"وزن طلا",density:"compact",variant:"outlined",rules:J},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:t.value.admin,"onUpdate:modelValue":e[11]||(e[11]=a=>t.value.admin=a),label:"ادمین",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:t.value.accounter,"onUpdate:modelValue":e[12]||(e[12]=a=>t.value.accounter=a),label:"حسابدار",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(s,{md:"6",class:"d-none d-md-flex"}),l(s,{cols:"12",md:"3"},{default:o(()=>[i("div",Fe,[l(P,{"prepend-icon":"ri-loop-left-line",variant:"tonal",block:"",onClick:e[13]||(e[13]=a=>K("completed"))},{default:o(()=>e[34]||(e[34]=[m("به روز رسانی")])),_:1})])]),_:1}),l(s,{cols:"12",md:"3"},{default:o(()=>[i("div",Be,[l(P,{"prepend-icon":"ri-file-excel-line",block:"",disabled:H.value,onClick:Q,loading:b.value},{default:o(()=>e[35]||(e[35]=[m("خروجی اکسل")])),_:1},8,["disabled","loading"])])]),_:1})]),_:1}),l(te,{title:"فروش موفق"},{default:o(()=>[e[36]||(e[36]=i("ul",{class:"listGuide"},[i("li",null," معاملاتی که فرآیند فروش آن‌ها توسط کاربران در سایت و اپلیکیشن انجام شده است ")],-1)),l(n,{modelValue:y.value,"onUpdate:modelValue":e[14]||(e[14]=a=>y.value=a),label:"جستجو","prepend-inner-icon":"ri-search-line",class:"ma-3"},null,8,["modelValue"]),l(oe,{headers:ie.value,items:N.value,loading:c.value,page:$.value,"items-per-page":C.value,"server-items-length":w.value,"items-per-page-options":ve.value,"onUpdate:options":Ve},{"item.totalPrice":o(({item:a})=>[i("p",null,v(O(a.totalPrice)),1)]),"item.goldWeight":o(({item:a})=>[i("p",null,v((+a.goldWeight).toFixed(3)),1)]),"item.status":o(({item:a})=>[i("div",null,[l(ue,{text:a.status=="completed"?"موفق":"نامشخص",color:a.status=="completed"?"#00853f":"#66666",size:"small"},null,8,["text","color"])])]),bottom:o(()=>[i("div",De,[l(de,{modelValue:U.value,"onUpdate:modelValue":e[15]||(e[15]=a=>U.value=a),length:j.value,"total-visible":4},null,8,["modelValue","length"])])]),_:1},8,["headers","items","loading","page","items-per-page","server-items-length","items-per-page-options"])]),_:1})]),_:1}),l(ae,{value:"two"},{default:o(()=>[l(G,{class:"filter my-3"},{default:o(()=>[l(s,{cols:"6",md:"3"},{default:o(()=>[l(r,{modelValue:t.value.startDate,"onUpdate:modelValue":e[16]||(e[16]=a=>t.value.startDate=a),placeholder:"از تاریخ"},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:o(()=>[l(r,{type:"time",modelValue:t.value.startTime,"onUpdate:modelValue":e[17]||(e[17]=a=>t.value.startTime=a),placeholder:"از زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:o(()=>[l(r,{modelValue:t.value.endDate,"onUpdate:modelValue":e[18]||(e[18]=a=>t.value.endDate=a),placeholder:"تا تاریخ"},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:o(()=>[l(r,{type:"time",modelValue:t.value.endTime,"onUpdate:modelValue":e[19]||(e[19]=a=>t.value.endTime=a),placeholder:"تا زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:t.value.firstName,"onUpdate:modelValue":e[20]||(e[20]=a=>t.value.firstName=a),label:"نام",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:t.value.lastName,"onUpdate:modelValue":e[21]||(e[21]=a=>t.value.lastName=a),label:"نام خانوادگی",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:t.value.phoneNumber,"onUpdate:modelValue":e[22]||(e[22]=a=>t.value.phoneNumber=a),label:"شماره موبایل",density:"compact",variant:"outlined",rules:q,onInput:z},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:t.value.nationalCode,"onUpdate:modelValue":e[23]||(e[23]=a=>t.value.nationalCode=a),label:"کد ملی",density:"compact",variant:"outlined",rules:R},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:t.value.goldPrice,"onUpdate:modelValue":e[24]||(e[24]=a=>t.value.goldPrice=a),label:"قیمت طلا",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:t.value.goldWeight,"onUpdate:modelValue":e[25]||(e[25]=a=>t.value.goldWeight=a),label:"وزن طلا",density:"compact",variant:"outlined",rules:J},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:t.value.admin,"onUpdate:modelValue":e[26]||(e[26]=a=>t.value.admin=a),label:"ادمین",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:o(()=>[l(n,{modelValue:t.value.accounter,"onUpdate:modelValue":e[27]||(e[27]=a=>t.value.accounter=a),label:"حسابدار",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(s,{md:"6",class:"d-none d-md-flex"}),l(s,{cols:"12",md:"3"},{default:o(()=>[i("div",Ge,[l(P,{"prepend-icon":"ri-loop-left-line",variant:"tonal",block:"",onClick:e[28]||(e[28]=a=>K("failed"))},{default:o(()=>e[37]||(e[37]=[m("به روز رسانی")])),_:1})])]),_:1}),l(s,{cols:"12",md:"3"},{default:o(()=>[i("div",Ie,[l(P,{"prepend-icon":"ri-file-excel-line",block:"",disabled:E.value,onClick:Q,loading:b.value},{default:o(()=>e[38]||(e[38]=[m("خروجی اکسل")])),_:1},8,["disabled","loading"])])]),_:1})]),_:1}),l(te,{title:"فروش ناموفق"},{default:o(()=>[e[39]||(e[39]=i("ul",{class:"listGuide"},[i("li",null," معاملاتی که فرایند فروش آنها توسط کاربران از طریق سایت یا اپلیکیشن صورت گرفته، اما به‌دلیل انصراف کاربر یا عوامل دیگر لغو شده‌اند. ")],-1)),l(n,{modelValue:x.value,"onUpdate:modelValue":e[29]||(e[29]=a=>x.value=a),label:"جستجو","prepend-inner-icon":"ri-search-line",class:"ma-3"},null,8,["modelValue"]),l(oe,{headers:re.value,items:k.value,search:me.value,loading:f.value,page:A.value,"items-per-page":T.value,"server-items-length":F.value,"items-per-page-options":fe.value,"onUpdate:options":ge},{"item.totalPrice":o(({item:a})=>[i("p",null,v(O(a.totalPrice)),1)]),"item.goldWeight":o(({item:a})=>[i("p",null,v((+a.goldWeight).toFixed(3)),1)]),"item.status":o(({item:a})=>[i("div",null,[l(ue,{text:a.status=="failed"?"ناموفق":"نامشخص",color:a.status=="failed"?"#ff0000":"#66666",size:"small"},null,8,["text","color"])])]),bottom:o(()=>[i("div",We,[l(de,{modelValue:S.value,"onUpdate:modelValue":e[30]||(e[30]=a=>S.value=a),length:M.value,"total-visible":4},null,8,["modelValue","length"])])]),_:1},8,["headers","items","search","loading","page","items-per-page","server-items-length","items-per-page-options"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),p.value?(W(),Y(ee,{key:0,color:"error",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:o(()=>[m(v(V.value),1)]),_:1})):Z("",!0),ne.value?(W(),Y(ee,{key:1,color:"success",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:o(()=>[m(v(se.value),1)]),_:1})):Z("",!0)])}}},dl=Pe(He,[["__scopeId","data-v-82de2555"]]);export{dl as default};
