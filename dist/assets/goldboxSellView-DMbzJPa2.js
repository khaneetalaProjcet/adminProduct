import{_ as ee,r as n,k as le,c as ae,b as l,w as o,a1 as N,e as H,h as E,a0 as T,q as te,o as U,a2 as u,C as m,a as i,a4 as b,t as f}from"./index-YxbGW_Kj.js";import{G as L}from"./goldbox-4b8B2n6l.js";import{I as oe}from"./inperson-CDcfAGrv.js";import{V as $}from"./VAlert-BlHHzYNd.js";import{V as de,a as j,b as ue,c as M}from"./VTabs-DqbHEzrm.js";import{a as ne,V as R}from"./VCard-BerrSmZ6.js";import{V as s}from"./VTextField-DQFwgkkF.js";import{V as _}from"./VDataTable-DFYVGawG.js";import{a as z}from"./VSelect-Cz9fscAG.js";import"./api-kDFbBZn5.js";import"./createSimpleFunctional-DAMy-n7r.js";import"./index-s-_os7y2.js";import"./VWindowItem-L279gGme.js";import"./dialog-transition-BEUVCgXp.js";import"./index-CfYn4Jym.js";import"./VMenu-xc3l3-Js.js";import"./VAvatar-a9mkcHnl.js";import"./VImg-BLJdCowe.js";import"./VDivider-DZ9MTMdX.js";import"./VSelectionControl-B5wK-S_z.js";const se={class:"w-100 d-flex justify-end"},ie={class:"w-100 d-flex justify-end"},re={class:"w-100 d-flex justify-end"},me={class:"w-100 d-flex justify-end"},ve={__name:"goldboxSellView",setup(pe){const V=n(""),q=n(""),v=n(!1),A=n(!1),c=n(null),J=n([{title:"نام",key:"seller.firstName"},{title:"نام خانوادگی",key:"seller.lastName"},{title:"مبلغ خرید (تومان)",key:"totalPrice"},{title:"وزن طلا (گرم)",key:"goldWeight"},{title:"تاریخ",key:"date"},{title:"زمان",key:"time"},{title:"شناسه پرداخت",key:"invoiceId"},{title:"وضعیت",key:"status"}]),K=n([{title:"نام",key:"seller.firstName"},{title:"نام خانوادگی",key:"seller.lastName"},{title:"مبلغ خرید (تومان)",key:"totalPrice"},{title:"وزن طلا (گرم)",key:"goldWeight"},{title:"تاریخ",key:"date"},{title:"زمان",key:"time"},{title:"شناسه پرداخت",key:"invoiceId"},{title:"وضعیت",key:"status"}]),x=n(),p=n(),g=n(),k=n(),O=n(),t=n({firstName:"",lastName:"",nationalCode:"",phoneNumber:"",tradeType:0,type:"sell",goldPrice:"",goldWeight:"",admin:"",accounter:"",startDate:"",startTime:"",endDate:"",endTime:"",invoiceId:"",status:"",destCardPan:""}),C=n(!0),S=n(!0),w=n(""),y=n(!1),Q=async()=>{try{p.value=!0;const d=await L.SellGoldBox(1);return x.value=d.data,d}catch(d){d.response.status==401&&(localStorage.clear(),T.replace("/login")),V.value=d.response.data.error||"خطایی رخ داده است!",v.value=!0,setTimeout(()=>{v.value=!1},1e4)}finally{p.value=!1}},X=async()=>{try{g.value=!0;const d=await L.SellGoldBox(0);return k.value=d.data,d}catch(d){d.response.status==401&&(localStorage.clear(),T.replace("/login")),V.value=d.response.data.error||"خطایی رخ داده است!",v.value=!0,setTimeout(()=>{v.value=!1},1e4)}finally{g.value=!1}},B=d=>d.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),D=[d=>/^\d{10}$/.test(d)||"کد ملی باید ۱۰ رقم باشد",d=>{if(!/^\d{10}$/.test(d))return!0;const e=+d[9],r=d.split("").slice(0,9).reduce((a,Z,h)=>a+ +Z*(10-h),0)%11;return r<2&&e===r||r>=2&&e+r===11||"کد ملی نامعتبر است"}],G=()=>{t.value.phoneNumber=t.value.phoneNumber.replace(/\D/g,"").slice(0,11)},P=[d=>/^09\d{9}$/.test(d)||"شماره معتبر نیست"],W=[d=>!!d,d=>/^\d+(\.\d{1,3})?$/.test(d)],Y=()=>{t.value.firstName="",t.value.lastName="",t.value.accounter="",t.value.admin="",t.value.endDate="",t.value.endTime="",t.value.goldPrice="",t.value.goldWeight="",t.value.invoiceId="",t.value.nationalCode="",t.value.phoneNumber="",t.value.startTime="",t.value.startDate="",t.value.destCardPan=""},I=async d=>{console.log(d);try{d=="completed"?p.value=!0:d=="failed"&&(g.value=!0),t.value.status=d;const e=await oe.SubmitFilterInvoice(t.value);return w.value=e.link,d=="completed"?(x.value=e.data,C.value=!1):d=="failed"&&(k.value=e.data,S.value=!1),e}catch(e){e.response.status==401&&(localStorage.clear(),T.replace("/login")),V.value=e.response.data.error||"خطایی رخ داده است!",v.value=!0,setTimeout(()=>{v.value=!1},1e4)}finally{p.value=!1,g.value=!1}},F=async()=>{y.value=!0,window.location.href=w.value,setTimeout(()=>{y.value=!1},5e3)};return le(()=>{Q(),X()}),(d,e)=>{const r=te("persian-date-picker");return U(),ae("div",null,[l(N,null,{default:o(()=>[l(u,null,{default:o(()=>[l(de,{modelValue:c.value,"onUpdate:modelValue":[e[0]||(e[0]=a=>c.value=a),Y],"align-tabs":"center"},{default:o(()=>[l(j,{value:"one"},{default:o(()=>e[28]||(e[28]=[m("فروش های موفق")])),_:1}),l(j,{value:"two"},{default:o(()=>e[29]||(e[29]=[m("فروش های ناموفق")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(u,{cols:"12"},{default:o(()=>[l(ne,null,{default:o(()=>[l(ue,{modelValue:c.value,"onUpdate:modelValue":e[27]||(e[27]=a=>c.value=a)},{default:o(()=>[l(M,{value:"one"},{default:o(()=>[l(N,{class:"filter my-3"},{default:o(()=>[l(u,{cols:"6",md:"3"},{default:o(()=>[l(r,{modelValue:t.value.startDate,"onUpdate:modelValue":e[1]||(e[1]=a=>t.value.startDate=a),placeholder:"از تاریخ"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(r,{type:"time",modelValue:t.value.startTime,"onUpdate:modelValue":e[2]||(e[2]=a=>t.value.startTime=a),placeholder:"از زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(r,{modelValue:t.value.endDate,"onUpdate:modelValue":e[3]||(e[3]=a=>t.value.endDate=a),placeholder:"تا تاریخ"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(r,{type:"time",modelValue:t.value.endTime,"onUpdate:modelValue":e[4]||(e[4]=a=>t.value.endTime=a),placeholder:"تا زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.firstName,"onUpdate:modelValue":e[5]||(e[5]=a=>t.value.firstName=a),label:"نام",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.lastName,"onUpdate:modelValue":e[6]||(e[6]=a=>t.value.lastName=a),label:"نام خانوادگی",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.phoneNumber,"onUpdate:modelValue":e[7]||(e[7]=a=>t.value.phoneNumber=a),label:"شماره موبایل",density:"compact",variant:"outlined",rules:P,onInput:G},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.nationalCode,"onUpdate:modelValue":e[8]||(e[8]=a=>t.value.nationalCode=a),label:"کد ملی",density:"compact",variant:"outlined",rules:D},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.goldPrice,"onUpdate:modelValue":e[9]||(e[9]=a=>t.value.goldPrice=a),label:"قیمت طلا",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.goldWeight,"onUpdate:modelValue":e[10]||(e[10]=a=>t.value.goldWeight=a),label:"وزن طلا",density:"compact",variant:"outlined",rules:W},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.admin,"onUpdate:modelValue":e[11]||(e[11]=a=>t.value.admin=a),label:"ادمین",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.accounter,"onUpdate:modelValue":e[12]||(e[12]=a=>t.value.accounter=a),label:"حسابدار",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{md:"6",class:"d-none d-md-flex"}),l(u,{cols:"12",md:"3"},{default:o(()=>[i("div",se,[l(b,{"prepend-icon":"ri-loop-left-line",variant:"tonal",block:"",onClick:e[13]||(e[13]=a=>I("completed"))},{default:o(()=>e[30]||(e[30]=[m("به روز رسانی")])),_:1})])]),_:1}),l(u,{cols:"12",md:"3"},{default:o(()=>[i("div",ie,[l(b,{"prepend-icon":"ri-file-excel-line",block:"",disabled:C.value,onClick:F,loading:y.value},{default:o(()=>e[31]||(e[31]=[m("خروجی اکسل")])),_:1},8,["disabled","loading"])])]),_:1})]),_:1}),l(R,{title:"فروش موفق"},{default:o(()=>[e[32]||(e[32]=i("ul",{class:"listGuide"},[i("li",null," معاملاتی که فرآیند فروش آن‌ها توسط کاربران در سایت و اپلیکیشن انجام شده و مبلغ مورد نظر از سوی حسابداری به حساب منتخب کاربر بازگردانده شده است. ")],-1)),l(_,{headers:J.value,items:x.value,loading:p.value},{"item.totalPrice":o(({item:a})=>[i("p",null,f(B(a.totalPrice)),1)]),"item.goldWeight":o(({item:a})=>[i("p",null,f((+a.goldWeight).toFixed(3)),1)]),"item.status":o(({item:a})=>[i("div",null,[l(z,{text:a.status=="completed"?"موفق":"نامشخص",color:a.status=="completed"?"#00853f":"#66666",size:"small"},null,8,["text","color"])])]),_:1},8,["headers","items","loading"])]),_:1})]),_:1}),l(M,{value:"two"},{default:o(()=>[l(N,{class:"filter my-3"},{default:o(()=>[l(u,{cols:"6",md:"3"},{default:o(()=>[l(r,{modelValue:t.value.startDate,"onUpdate:modelValue":e[14]||(e[14]=a=>t.value.startDate=a),placeholder:"از تاریخ"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(r,{type:"time",modelValue:t.value.startTime,"onUpdate:modelValue":e[15]||(e[15]=a=>t.value.startTime=a),placeholder:"از زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(r,{modelValue:t.value.endDate,"onUpdate:modelValue":e[16]||(e[16]=a=>t.value.endDate=a),placeholder:"تا تاریخ"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(r,{type:"time",modelValue:t.value.endTime,"onUpdate:modelValue":e[17]||(e[17]=a=>t.value.endTime=a),placeholder:"تا زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.firstName,"onUpdate:modelValue":e[18]||(e[18]=a=>t.value.firstName=a),label:"نام",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.lastName,"onUpdate:modelValue":e[19]||(e[19]=a=>t.value.lastName=a),label:"نام خانوادگی",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.phoneNumber,"onUpdate:modelValue":e[20]||(e[20]=a=>t.value.phoneNumber=a),label:"شماره موبایل",density:"compact",variant:"outlined",rules:P,onInput:G},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.nationalCode,"onUpdate:modelValue":e[21]||(e[21]=a=>t.value.nationalCode=a),label:"کد ملی",density:"compact",variant:"outlined",rules:D},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.goldPrice,"onUpdate:modelValue":e[22]||(e[22]=a=>t.value.goldPrice=a),label:"قیمت طلا",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.goldWeight,"onUpdate:modelValue":e[23]||(e[23]=a=>t.value.goldWeight=a),label:"وزن طلا",density:"compact",variant:"outlined",rules:W},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.admin,"onUpdate:modelValue":e[24]||(e[24]=a=>t.value.admin=a),label:"ادمین",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.accounter,"onUpdate:modelValue":e[25]||(e[25]=a=>t.value.accounter=a),label:"حسابدار",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{md:"6",class:"d-none d-md-flex"}),l(u,{cols:"12",md:"3"},{default:o(()=>[i("div",re,[l(b,{"prepend-icon":"ri-loop-left-line",variant:"tonal",block:"",onClick:e[26]||(e[26]=a=>I("failed"))},{default:o(()=>e[33]||(e[33]=[m("به روز رسانی")])),_:1})])]),_:1}),l(u,{cols:"12",md:"3"},{default:o(()=>[i("div",me,[l(b,{"prepend-icon":"ri-file-excel-line",block:"",disabled:S.value,onClick:F,loading:y.value},{default:o(()=>e[34]||(e[34]=[m("خروجی اکسل")])),_:1},8,["disabled","loading"])])]),_:1})]),_:1}),l(R,{title:"فروش ناموفق"},{default:o(()=>[e[35]||(e[35]=i("ul",{class:"listGuide"},[i("li",null," معاملاتی که فرایند فروش آنها توسط کاربران از طریق سایت یا اپلیکیشن صورت گرفته، اما به‌دلیل انصراف کاربر یا عوامل دیگر لغو شده‌اند. ")],-1)),l(_,{headers:K.value,items:k.value,search:O.value,loading:p.value},{"item.totalPrice":o(({item:a})=>[i("p",null,f(B(a.totalPrice)),1)]),"item.goldWeight":o(({item:a})=>[i("p",null,f((+a.goldWeight).toFixed(3)),1)]),"item.status":o(({item:a})=>[i("div",null,[l(z,{text:a.status=="failed"?"ناموفق":"نامشخص",color:a.status=="failed"?"#ff0000":"#66666",size:"small"},null,8,["text","color"])])]),_:1},8,["headers","items","search","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),v.value?(U(),H($,{key:0,color:"error",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:o(()=>[m(f(V.value),1)]),_:1})):E("",!0),A.value?(U(),H($,{key:1,color:"success",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:o(()=>[m(f(q.value),1)]),_:1})):E("",!0)])}}},Fe=ee(ve,[["__scopeId","data-v-40806c83"]]);export{Fe as default};
