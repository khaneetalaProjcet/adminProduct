import{_ as te,r as o,k as se,c as oe,a as n,b as l,w as s,a8 as E,e as G,h as H,F as ne,bP as x,o as M,a1 as B,a2 as u,a4 as c,C as S,V as ue,a3 as P,t as b}from"./index-CLfhNXuh.js";import{M as _}from"./managment-CWnfqtG-.js";import{V as j}from"./VDialog-DyHlB0j7.js";import{V as q}from"./VAlert-BNkka9Ru.js";import{V as N}from"./VCard-DQuYPE3h.js";import{V as i}from"./VTextField-jrFvn0Ba.js";import{V as J}from"./VDataTable-PLuuGawL.js";import{V as K}from"./VForm-wFxgx5WI.js";import"./api-DS03iIn1.js";import"./dialog-transition-DSt2qH8B.js";import"./index-9IB1bUgs.js";import"./index-DFvKNuzC.js";import"./createSimpleFunctional-Crb98gMd.js";import"./VAvatar-DxXhlc4L.js";import"./VImg-17gxqnfN.js";import"./VSelect-BoFHSLoR.js";import"./VMenu-PGKjzO-h.js";import"./VDivider-DgHylfGo.js";import"./VSelectionControl-pV4wKr3j.js";const re={class:"px-5 py-3 d-flex justify-end"},de={class:"d-flex justify-space-between"},ie={class:"d-flex justify-end pa-5"},me={class:"d-flex justify-end"},ve={class:"content"},ce={class:"desc"},fe={class:"content"},pe={class:"desc"},Ve={class:"content"},ge={class:"desc"},ye={class:"d-flex justify-space-between"},be={__name:"branchView",setup(ke){const p=o(!1),k=o(!1),w=o(""),V=o(""),r=o(!1),C=o(""),f=o(!1),L=o(!1),U=o(!1),T=o(!1),A=o(!1),D=o(!1),m=o({}),O=o([{title:"id",key:"id"},{title:"نام شعبه",key:"name"},{title:"کد شعبه",key:"code"},{title:"مدیر",key:"manager"},{title:"اطلاعات",key:"action"}]),d=o({firstName:null,lastName:null,phoneNumber:null,nationalcode:null}),g=o(!1),z=o([]),Q=o([{title:"نام",key:"fristName"},{title:"نام خانوادگی",key:"lastName"},{title:"شماره موبایل",key:"phoneNumber"},{title:"کد ملی",key:"nationalCode"}]),F=o([]),$=o(!1),v=o({manager:null,code:null,name:null}),h=async()=>{try{$.value=!0;const t=await _.BranchList();return F.value=t.data,t}catch(t){t.response.status==401&&(localStorage.clear(),x.replace("/login")),V.value=t.response.data.error||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{$.value=!1}},W=async()=>{try{T.value=!0;const t=await _.AddBranch(v.value);return p.value=!1,C.value=t.msg,f.value=!0,h(),setTimeout(()=>{f.value=!1},1e4),t}catch(t){t.response.status==401&&(localStorage.clear(),x.replace("/login")),V.value=t.response.data.error||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{T.value=!1}},X=async t=>{m.value=t,k.value=!0,R(m.value.id)},R=async t=>{try{D.value=!0;const e=await _.SellerList(t);return z.value=e.data,setTimeout(()=>{f.value=!1},1e4),e}catch(e){e.response.status==401&&(localStorage.clear(),x.replace("/login")),V.value=e.response.data.error||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{D.value=!1}},Y=async()=>{try{A.value=!0;const t=await _.AddSeller(d.value,m.value.id);return g.value=!1,C.value=t.msg,f.value=!0,R(m.value.id),setTimeout(()=>{f.value=!1},1e4),t}catch(t){t.response.status==401&&(localStorage.clear(),x.replace("/login")),V.value=t.response.data.error||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{A.value=!1}},y=[t=>!!t||"این فیلد الزامی است"],Z=[t=>!!t||"شماره همراه الزامی است",t=>/^09\d{9}$/.test(t)||"شماره معتبر نیست"],ee=[t=>!!t||"کد ملی الزامی است",t=>/^\d{10}$/.test(t)||"کد ملی باید ۱۰ رقم باشد",t=>{if(!/^\d{10}$/.test(t))return!0;const e=+t[9],a=t.split("").slice(0,9).reduce((I,le,ae)=>I+ +le*(10-ae),0)%11;return a<2&&e===a||a>=2&&e+a===11||"کد ملی نامعتبر است"}];return se(()=>{h()}),(t,e)=>(M(),oe(ne,null,[n("div",null,[l(E,null,{default:s(()=>[l(B,null,{default:s(()=>[l(u,{cols:"12"},{default:s(()=>[l(N,{title:"شعبه ها"},{text:s(()=>[l(i,{modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=a=>w.value=a),label:"جستجو","prepend-inner-icon":"ri-search-line"},null,8,["modelValue"])]),default:s(()=>[n("div",re,[l(c,{onClick:e[0]||(e[0]=a=>p.value=!0),class:"mx-2"},{default:s(()=>e[18]||(e[18]=[S("افزودن شعبه")])),_:1})]),l(J,{headers:O.value,items:F.value,search:w.value,loading:$.value},{"item.action":s(({item:a})=>[l(ue,{class:"me-2",size:"small",icon:"ri-store-line",color:"#d4af37",onClick:I=>X(a)},null,8,["onClick"])]),_:1},8,["headers","items","search","loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),l(j,{modelValue:p.value,"onUpdate:modelValue":e[7]||(e[7]=a=>p.value=a),"max-width":"600",class:"dialog"},{default:s(()=>[l(N,{class:"dialog-card"},{default:s(()=>[e[19]||(e[19]=n("div",{class:"k-dialog-title"},[n("p",null,"افزودن شعبه جدید")],-1)),l(K,{ref:"form",modelValue:L.value,"onUpdate:modelValue":e[6]||(e[6]=a=>L.value=a),onSubmit:P(W,["prevent"])},{default:s(()=>[l(B,null,{default:s(()=>[l(u,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[l(i,{modelValue:v.value.name,"onUpdate:modelValue":e[2]||(e[2]=a=>v.value.name=a),label:"نام شعبه",variant:"outlined",rules:y},null,8,["modelValue"])]),_:1}),l(u,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[l(i,{modelValue:v.value.code,"onUpdate:modelValue":e[3]||(e[3]=a=>v.value.code=a),label:"کد شعبه",variant:"outlined",rules:y},null,8,["modelValue"])]),_:1}),l(u,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[l(i,{modelValue:v.value.manager,"onUpdate:modelValue":e[4]||(e[4]=a=>v.value.manager=a),label:"مدیر شعبه",variant:"outlined",rules:y},null,8,["modelValue"])]),_:1})]),_:1}),n("div",de,[l(c,{text:"انصراف",onClick:e[5]||(e[5]=a=>p.value=!1),size:"large",class:"m-3",variant:"outlined"}),l(c,{type:"submit",text:"افزودن",size:"large",class:"m-3",loading:T.value,disabled:!L.value},null,8,["loading","disabled"])])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),l(j,{modelValue:k.value,"onUpdate:modelValue":e[10]||(e[10]=a=>k.value=a),transition:"dialog-bottom-transition",fullscreen:""},{default:s(()=>[l(N,null,{default:s(()=>[n("div",ie,[l(c,{variant:"text",icon:"ri-close-large-line",onClick:e[8]||(e[8]=a=>k.value=!1)})]),l(E,null,{default:s(()=>[l(B,{class:"wallet-info-box"},{default:s(()=>[l(u,{cols:"12"},{default:s(()=>[n("div",me,[l(c,{onClick:e[9]||(e[9]=a=>g.value=!0),class:"mx-2"},{default:s(()=>e[20]||(e[20]=[S("افزودن فروشنده")])),_:1})])]),_:1}),l(u,{cols:"6",md:"4",class:"my-3"},{default:s(()=>[n("div",ve,[e[21]||(e[21]=n("p",{class:"title"},"نام شعبه: ",-1)),n("p",ce,b(m.value.name),1)])]),_:1}),l(u,{cols:"6",md:"4",class:"my-3"},{default:s(()=>[n("div",fe,[e[22]||(e[22]=n("p",{class:"title"},"کد شعبه: ",-1)),n("p",pe,b(m.value.code),1)])]),_:1}),l(u,{cols:"6",md:"4",class:"my-3"},{default:s(()=>[n("div",Ve,[e[23]||(e[23]=n("p",{class:"title"},"مدیریت شعبه: ",-1)),n("p",ge,b(m.value.manager),1)])]),_:1}),l(u,{cols:"12",class:"my-2"},{default:s(()=>[l(J,{headers:Q.value,items:z.value,loading:D.value},null,8,["headers","items","loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(j,{modelValue:g.value,"onUpdate:modelValue":e[17]||(e[17]=a=>g.value=a),"max-width":"600",class:"dialog"},{default:s(()=>[l(N,{class:"dialog-card"},{default:s(()=>[e[24]||(e[24]=n("div",{class:"k-dialog-title"},[n("p",null,"افزودن کارمند جدید")],-1)),l(K,{ref:"form",modelValue:U.value,"onUpdate:modelValue":e[16]||(e[16]=a=>U.value=a),onSubmit:P(Y,["prevent"])},{default:s(()=>[l(B,null,{default:s(()=>[l(u,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[l(i,{modelValue:d.value.firstName,"onUpdate:modelValue":e[11]||(e[11]=a=>d.value.firstName=a),label:"نام",variant:"outlined",rules:y},null,8,["modelValue"])]),_:1}),l(u,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[l(i,{modelValue:d.value.lastName,"onUpdate:modelValue":e[12]||(e[12]=a=>d.value.lastName=a),label:"نام خانوادگی",variant:"outlined",rules:y},null,8,["modelValue"])]),_:1}),l(u,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[l(i,{modelValue:d.value.phoneNumber,"onUpdate:modelValue":e[13]||(e[13]=a=>d.value.phoneNumber=a),label:"شماره همراه",variant:"outlined",rules:Z},null,8,["modelValue"])]),_:1}),l(u,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[l(i,{modelValue:d.value.nationalcode,"onUpdate:modelValue":e[14]||(e[14]=a=>d.value.nationalcode=a),label:"کد ملی",variant:"outlined",rules:ee},null,8,["modelValue"])]),_:1})]),_:1}),n("div",ye,[l(c,{text:"انصراف",onClick:e[15]||(e[15]=a=>g.value=!1),size:"large",class:"m-3",variant:"outlined"}),l(c,{type:"submit",text:"افزودن",size:"large",class:"m-3",loading:A.value,disabled:!U.value},null,8,["loading","disabled"])])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),r.value?(M(),G(q,{key:0,color:"error",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:s(()=>[S(b(V.value),1)]),_:1})):H("",!0),f.value?(M(),G(q,{key:1,color:"success",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:s(()=>[S(b(C.value),1)]),_:1})):H("",!0)],64))}},Ie=te(be,[["__scopeId","data-v-b62a555a"]]);export{Ie as default};
