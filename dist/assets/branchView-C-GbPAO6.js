import{_ as pe,r as o,k as Ve,c as ge,a as n,b as l,w as s,a7 as Q,e as W,h as X,F as ye,bR as f,o as H,a1 as N,a2 as r,a4 as m,C as U,V as q,a3 as Y,t as x}from"./index-kIM0J7p6.js";import{M as p}from"./managment-C7UamsOL.js";import{V as B}from"./VDialog-Dx0dlomF.js";import{V as Z}from"./VAlert-Bf6f0eKq.js";import{V as b}from"./VCard-Dq28bNsi.js";import{V as g}from"./VTextField-BVsAqBpZ.js";import{V as ee}from"./VDataTable-DvUH3Et_.js";import{V as le}from"./VSwitch-DK2d4iNi.js";import{V as ae}from"./VForm-DMvjvzFb.js";import"./api-B5ylx0Q2.js";import"./dialog-transition-CJlGBmQA.js";import"./index-DzISJ_UR.js";import"./index-8DLNIlez.js";import"./createSimpleFunctional-D5yrpv8H.js";import"./VAvatar-BOOUUsLE.js";import"./VImg-CLfSGMaR.js";import"./VSelect-kAmPipQQ.js";import"./VMenu-DrI0nLf-.js";import"./VDivider-BmeK8uHf.js";import"./VSelectionControl-DlKHsbGm.js";const be={class:"px-5 py-3 d-flex justify-end"},Se={class:"d-flex justify-space-between"},ke={class:"d-flex justify-end pa-5"},we={class:"d-flex justify-end"},xe={class:"content"},Be={class:"desc"},he={class:"content"},De={class:"desc"},_e={class:"content"},Ce={class:"desc"},Ne={class:"d-flex justify-space-between"},Ue={__name:"branchView",setup(Ae){const S=o(!1),h=o(!1),D=o(!1),_=o(!1),A=o(""),c=o(""),u=o(!1),L=o(""),y=o(!1),T=o(!1),$=o(!1),z=o(!1),I=o(!1),M=o(!1),j=o(!1),F=o(!1),i=o({}),J=o({}),te=o([{title:"id",key:"id"},{title:"نام شعبه",key:"name"},{title:"کد شعبه",key:"code"},{title:"مدیر",key:"manager"},{title:"اطلاعات",key:"action"},{title:"فعال / غیر فعال",key:"status"}]),d=o({firstName:null,lastName:null,phoneNumber:null}),k=o(!1),K=o([]),se=o([{title:"نام",key:"firstName"},{title:"نام خانوادگی",key:"lastName"},{title:"شماره موبایل",key:"phoneNumber"},{title:"فعالیت",key:"action"},{title:"فعال / غیر فعال",key:"status"}]),O=o([]),R=o(!1),V=o({manager:null,code:null,name:null}),C=o(!1),P=o(!1),E=async()=>{try{R.value=!0;const a=await p.BranchList();return O.value=a.data,a}catch(a){a.response.status==401&&(localStorage.clear(),f.replace("/login")),c.value=a.response.data.error||"خطایی رخ داده است!",u.value=!0,setTimeout(()=>{u.value=!1},1e4)}finally{R.value=!1}},oe=async()=>{try{z.value=!0;const a=await p.AddBranch(V.value);return S.value=!1,L.value=a.msg,y.value=!0,E(),setTimeout(()=>{y.value=!1},1e4),a}catch(a){a.response.status==401&&(localStorage.clear(),f.replace("/login")),c.value=a.response.data.error||"خطایی رخ داده است!",u.value=!0,setTimeout(()=>{u.value=!1},1e4)}finally{z.value=!1}},ne=async a=>{i.value=a,_.value=!0,G(i.value.id)},ue=a=>{i.value=a,h.value=!0},re=async()=>{try{M.value=!0;const a=await p.DeleteBranch(i.value.id);return h.value=!1,E(),a}catch(a){a.response.status==401&&(localStorage.clear(),f.replace("/login")),c.value=a.response.data.error||"خطایی رخ داده است!",u.value=!0,setTimeout(()=>{u.value=!1},1e4)}finally{M.value=!1}},ie=a=>{J.value=a,D.value=!0},de=async()=>{try{j.value=!0;const a=await p.DeleteSeller(J.value.id);return D.value=!1,G(i.value.id),a}catch(a){a.response.status==401&&(localStorage.clear(),f.replace("/login")),c.value=a.response.data.error||"خطایی رخ داده است!",u.value=!0,setTimeout(()=>{u.value=!1},1e4)}finally{j.value=!1}},G=async a=>{try{F.value=!0;const e=await p.SellerList(a);return K.value=e.data,setTimeout(()=>{y.value=!1},1e4),e}catch(e){e.response.status==401&&(localStorage.clear(),f.replace("/login")),c.value=e.response.data.error||"خطایی رخ داده است!",u.value=!0,setTimeout(()=>{u.value=!1},1e4)}finally{F.value=!1}},ce=async()=>{try{I.value=!0;const a=await p.AddSeller(d.value,i.value.id);return k.value=!1,L.value=a.msg,y.value=!0,G(i.value.id),setTimeout(()=>{y.value=!1},1e4),d.value.firstName=null,d.value.lastName=null,d.value.phoneNumber=null,a}catch(a){a.response.status==401&&(localStorage.clear(),f.replace("/login")),c.value=a.response.data.error||"خطایی رخ داده است!",u.value=!0,setTimeout(()=>{u.value=!1},1e4)}finally{I.value=!1}},w=[a=>!!a||"این فیلد الزامی است"],me=[a=>!!a||"شماره همراه الزامی است",a=>/^09\d{9}$/.test(a)||"شماره معتبر نیست"],ve=async a=>{try{return C.value=!0,await p.SwitchBranchActivator(a.id)}catch(e){e.response.status==401&&(localStorage.clear(),f.replace("/login")),c.value=e.response.data.error||"خطایی رخ داده است!",u.value=!0,setTimeout(()=>{u.value=!1},1e4)}finally{C.value=!1}},fe=async a=>{try{return P.value=!0,await p.SwitchBranchSellerActivator(a.id)}catch(e){e.response.status==401&&(localStorage.clear(),f.replace("/login")),c.value=e.response.data.error||"خطایی رخ داده است!",u.value=!0,setTimeout(()=>{u.value=!1},1e4)}finally{P.value=!1}};return Ve(()=>{E()}),(a,e)=>(H(),ge(ye,null,[n("div",null,[l(Q,null,{default:s(()=>[l(N,null,{default:s(()=>[l(r,{cols:"12"},{default:s(()=>[l(b,{title:"شعبه ها"},{text:s(()=>[l(g,{modelValue:A.value,"onUpdate:modelValue":e[1]||(e[1]=t=>A.value=t),label:"جستجو","prepend-inner-icon":"ri-search-line"},null,8,["modelValue"])]),default:s(()=>[n("div",be,[l(m,{onClick:e[0]||(e[0]=t=>S.value=!0),class:"mx-2"},{default:s(()=>e[19]||(e[19]=[U("افزودن شعبه")])),_:1})]),l(ee,{headers:te.value,items:O.value,search:A.value,loading:R.value},{"item.action":s(({item:t})=>[l(q,{class:"me-2",size:"small",icon:"ri-store-line",color:"#d4af37",onClick:v=>ne(t)},null,8,["onClick"]),l(q,{class:"me-2",size:"small",icon:"ri-delete-bin-line",color:"#c9190c",onClick:v=>ue(t)},null,8,["onClick"])]),"item.status":s(({item:t})=>[l(le,{modelValue:t.isActive,"onUpdate:modelValue":v=>t.isActive=v,color:"#b08c4d",onInput:v=>ve(t),loading:C.value},null,8,["modelValue","onUpdate:modelValue","onInput","loading"])]),_:1},8,["headers","items","search","loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),l(B,{modelValue:S.value,"onUpdate:modelValue":e[7]||(e[7]=t=>S.value=t),"max-width":"600",class:"dialog"},{default:s(()=>[l(b,{class:"dialog-card"},{default:s(()=>[e[20]||(e[20]=n("div",{class:"k-dialog-title"},[n("p",null,"افزودن شعبه جدید")],-1)),l(ae,{ref:"form",modelValue:T.value,"onUpdate:modelValue":e[6]||(e[6]=t=>T.value=t),onSubmit:Y(oe,["prevent"])},{default:s(()=>[l(N,null,{default:s(()=>[l(r,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[l(g,{modelValue:V.value.name,"onUpdate:modelValue":e[2]||(e[2]=t=>V.value.name=t),label:"نام شعبه",variant:"outlined",rules:w},null,8,["modelValue"])]),_:1}),l(r,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[l(g,{modelValue:V.value.code,"onUpdate:modelValue":e[3]||(e[3]=t=>V.value.code=t),label:"کد شعبه",variant:"outlined",rules:w},null,8,["modelValue"])]),_:1}),l(r,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[l(g,{modelValue:V.value.manager,"onUpdate:modelValue":e[4]||(e[4]=t=>V.value.manager=t),label:"مدیر شعبه",variant:"outlined",rules:w},null,8,["modelValue"])]),_:1})]),_:1}),n("div",Se,[l(m,{text:"انصراف",onClick:e[5]||(e[5]=t=>S.value=!1),size:"large",class:"m-3",variant:"outlined"}),l(m,{type:"submit",text:"افزودن",size:"large",class:"m-3",loading:z.value,disabled:!T.value},null,8,["loading","disabled"])])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),l(B,{modelValue:_.value,"onUpdate:modelValue":e[10]||(e[10]=t=>_.value=t),transition:"dialog-bottom-transition",fullscreen:""},{default:s(()=>[l(b,null,{default:s(()=>[n("div",ke,[l(m,{variant:"text",icon:"ri-close-large-line",onClick:e[8]||(e[8]=t=>_.value=!1)})]),l(Q,null,{default:s(()=>[l(N,{class:"wallet-info-box"},{default:s(()=>[l(r,{cols:"12"},{default:s(()=>[n("div",we,[l(m,{onClick:e[9]||(e[9]=t=>k.value=!0),class:"mx-2"},{default:s(()=>e[21]||(e[21]=[U("افزودن فروشنده")])),_:1})])]),_:1}),l(r,{cols:"6",md:"4",class:"my-3"},{default:s(()=>[n("div",xe,[e[22]||(e[22]=n("p",{class:"title"},"نام شعبه: ",-1)),n("p",Be,x(i.value.name),1)])]),_:1}),l(r,{cols:"6",md:"4",class:"my-3"},{default:s(()=>[n("div",he,[e[23]||(e[23]=n("p",{class:"title"},"کد شعبه: ",-1)),n("p",De,x(i.value.code),1)])]),_:1}),l(r,{cols:"6",md:"4",class:"my-3"},{default:s(()=>[n("div",_e,[e[24]||(e[24]=n("p",{class:"title"},"مدیریت شعبه: ",-1)),n("p",Ce,x(i.value.manager),1)])]),_:1}),l(r,{cols:"12",class:"my-2"},{default:s(()=>[l(ee,{headers:se.value,items:K.value,loading:F.value},{"item.action":s(({item:t})=>[l(q,{class:"me-2",size:"small",icon:"ri-delete-bin-line",color:"#c9190c",onClick:v=>ie(t)},null,8,["onClick"])]),"item.status":s(({item:t})=>[l(le,{modelValue:t.isActive,"onUpdate:modelValue":v=>t.isActive=v,color:"#b08c4d",onInput:v=>fe(t),loading:C.value},null,8,["modelValue","onUpdate:modelValue","onInput","loading"])]),_:1},8,["headers","items","loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(B,{modelValue:k.value,"onUpdate:modelValue":e[16]||(e[16]=t=>k.value=t),"max-width":"600",class:"dialog"},{default:s(()=>[l(b,{class:"dialog-card"},{default:s(()=>[e[25]||(e[25]=n("div",{class:"k-dialog-title"},[n("p",null,"افزودن کارمند جدید")],-1)),l(ae,{ref:"form",modelValue:$.value,"onUpdate:modelValue":e[15]||(e[15]=t=>$.value=t),onSubmit:Y(ce,["prevent"])},{default:s(()=>[l(N,null,{default:s(()=>[l(r,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[l(g,{modelValue:d.value.firstName,"onUpdate:modelValue":e[11]||(e[11]=t=>d.value.firstName=t),label:"نام",variant:"outlined",rules:w},null,8,["modelValue"])]),_:1}),l(r,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[l(g,{modelValue:d.value.lastName,"onUpdate:modelValue":e[12]||(e[12]=t=>d.value.lastName=t),label:"نام خانوادگی",variant:"outlined",rules:w},null,8,["modelValue"])]),_:1}),l(r,{cols:"12",md:"6",class:"my-4"},{default:s(()=>[l(g,{modelValue:d.value.phoneNumber,"onUpdate:modelValue":e[13]||(e[13]=t=>d.value.phoneNumber=t),label:"شماره همراه",variant:"outlined",rules:me},null,8,["modelValue"])]),_:1})]),_:1}),n("div",Ne,[l(m,{text:"انصراف",onClick:e[14]||(e[14]=t=>k.value=!1),size:"large",class:"m-3",variant:"outlined"}),l(m,{type:"submit",text:"افزودن",size:"large",class:"m-3",loading:I.value,disabled:!$.value},null,8,["loading","disabled"])])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),l(B,{modelValue:h.value,"onUpdate:modelValue":e[17]||(e[17]=t=>h.value=t),width:"auto"},{default:s(()=>[l(b,{width:"400","prepend-icon":"mdi-delete",text:"آیا از حذف شعبه مطمئن هستید؟",title:"حذف شعبه"},{actions:s(()=>[l(m,{class:"ms-auto",text:"حذف",onClick:re,loading:M.value},null,8,["loading"])]),_:1})]),_:1},8,["modelValue"]),l(B,{modelValue:D.value,"onUpdate:modelValue":e[18]||(e[18]=t=>D.value=t),width:"auto"},{default:s(()=>[l(b,{width:"400","prepend-icon":"mdi-delete",text:"آیا از حذف کارشناس مطمئن هستید؟",title:"حذف کارشناس"},{actions:s(()=>[l(m,{class:"ms-auto",text:"حذف",onClick:de,loading:j.value},null,8,["loading"])]),_:1})]),_:1},8,["modelValue"]),u.value?(H(),W(Z,{key:0,color:"error",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:s(()=>[U(x(c.value),1)]),_:1})):X("",!0),y.value?(H(),W(Z,{key:1,color:"success",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:s(()=>[U(x(L.value),1)]),_:1})):X("",!0)],64))}},Ye=pe(Ue,[["__scopeId","data-v-78ca046a"]]);export{Ye as default};
