import{_ as ee,r as o,k as le,c as d,b as s,w as t,a8 as ae,e as P,h as T,F as R,a0 as f,o as i,a1 as F,a2 as k,a as n,a4 as v,C as U,V as z,a7 as se,a3 as te,t as I}from"./index-DspVVL0a.js";import{M as p}from"./managment-HR4C-0Ae.js";import{V as D}from"./VDialog-BrOD-zke.js";import{V as oe}from"./VAlert-CPnzodZR.js";import{V as w}from"./VCard-CIAQPhJK.js";import{V as A}from"./VTextField-CCdD-OwD.js";import{V as ne}from"./VDataTable-Elu1ylr1.js";import{V as re}from"./VForm-CsYt4xCn.js";import{V as G}from"./VSwitch-Cw7VSTEO.js";import"./api-C8aKTHNb.js";import"./dialog-transition-TVHj_z4n.js";import"./index-BHlbWO4l.js";import"./index-DeSb4V3Q.js";import"./createSimpleFunctional-Dm17snd8.js";import"./VAvatar-DhXly0cQ.js";import"./VImg-D-S7GJ_L.js";import"./VSelect-CZGpGuWU.js";import"./VMenu-ygNVPEm6.js";import"./VDivider-xxE4-xEZ.js";import"./VSelectionControl-CDYyKLCF.js";const ie={class:"px-5 py-3 d-flex justify-end"},ue={key:0,class:"table-green"},de={key:1,class:"table-red"},me={class:"d-flex flex-column w-100 h-100 my-2"},ce={key:0,class:"dialog-loading"},ve={class:"d-flex justify-space-between"},fe={class:"d-flex justify-space-between"},pe={class:"d-flex flex-column w-100 h-100 my-2"},ge={key:0,class:"dialog-access-loading"},Ve={key:1,class:"d-flex justify-space-between align-items-center mx-4 my-2"},ye={class:"d-flex justify-space-between"},ke={__name:"managmentAdminView",setup(Ae){const E=o([{title:"نام",key:"firstName"},{title:"نام خانوادگی",key:"lastName"},{title:"شماره همراه",key:"phoneNumber"},{title:"نقش",key:"role"},{title:"اکتیو",key:"isBlocked"},{title:"فعالیت",key:"action"}]),B=o([]),N=o(""),C=o(!1),S=o(!1),_=o(!1),m=o(!1),L=o(!1),b=o(),x=o(!1),g=o(!1),V=o(!1),c=o(""),r=o(!1),y=o(!1),u=o({firstName:"",lastName:"",phoneNumber:"",password:"",role:0}),$=o(""),j=async()=>{try{C.value=!0;const e=await p.AdminList();return B.value=e.data,e}catch(e){e.response.status==401&&(localStorage.clear(),f.replace("/login")),c.value=e.response.data.error||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{C.value=!1}},Z=async e=>{try{_.value=!0;const l=await p.AccessPoint(e);return b.value=l.data,l}catch(l){l.response.status==401&&(localStorage.clear(),f.replace("/login")),c.value=l.response.data.error||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{_.value=!1}},q=async()=>{try{m.value=!0;const e=await p.GetPermission();return e.data==0?x.value=!1:x.value=!0,V.value=!0,e}catch(e){e.response.status==401&&(localStorage.clear(),f.replace("/login")),c.value=e.response.data.error||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{m.value=!1}},H=async()=>{try{m.value=!0;const e=await p.TradePermission();return b.value=e.data,V.value=!1,e}catch(e){e.response.status==401&&(localStorage.clear(),f.replace("/login")),c.value=e.response.data.error||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{m.value=!1}},J=async e=>{g.value=!0,Z(e.id),$.value=e.id},K=async()=>{try{L.value=!0;const e=await p.SubmitAccessPoint(b.value,$.value);return g.value=!1,e}catch(e){e.response.status==401&&(localStorage.clear(),f.replace("/login")),c.value=e.response.data.error||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{L.value=!1}},O=async()=>{try{S.value=!0;const e=await p.AddAdmin(u.value);return y.value=!1,j(),e}catch(e){e.response.status==401&&(localStorage.clear(),f.replace("/login")),c.value=e.response.data.error||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{S.value=!1}},Q=[e=>!!e||"شماره همراه الزامی است",e=>/^09\d{9}$/.test(e)||"شماره معتبر نیست"],W=[e=>!!e||"رمز عبور الزامی است",e=>e&&e.length>=8||"رمز عبور باید حداقل ۸ کاراکتر باشد",e=>/[A-Z]/.test(e)||"رمز عبور باید حداقل یک حرف بزرگ داشته باشد",e=>/[a-z]/.test(e)||"رمز عبور باید حداقل یک حرف کوچک داشته باشد",e=>/[0-9]/.test(e)||"رمز عبور باید حداقل یک عدد داشته باشد",e=>/[^A-Za-z0-9]/.test(e)||"رمز عبور باید حداقل یک کاراکتر خاص (!@#$%^&*) داشته باشد"],X=[e=>!!e||"نام الزامی است"],Y=[e=>!!e||"نام خانوادگی الزامی است"];return le(()=>{j()}),(e,l)=>(i(),d(R,null,[s(ae,null,{default:t(()=>[s(F,null,{default:t(()=>[s(k,{cols:"12"},{default:t(()=>[s(w,{title:"سطح دسترسی ها"},{text:t(()=>[s(A,{modelValue:N.value,"onUpdate:modelValue":l[1]||(l[1]=a=>N.value=a),label:"جستجو","prepend-inner-icon":"ri-search-line"},null,8,["modelValue"])]),default:t(()=>[n("div",ie,[s(v,{onClick:l[0]||(l[0]=a=>y.value=!0),class:"mx-2"},{default:t(()=>l[13]||(l[13]=[U("افزودن کاربر")])),_:1}),s(v,{color:"error",class:"error-btn",loading:m.value,onClick:q},{default:t(()=>l[14]||(l[14]=[U(" دسترسی های مدیریتی ")])),_:1},8,["loading"])]),s(ne,{headers:E.value,items:B.value,search:N.value,loading:C.value},{"item.isBlocked":t(({item:a})=>[a.isBlocked==!0?(i(),P(z,{key:0,size:"small",icon:"ri-close-line",color:"#c9190c"})):a.isBlocked==!1?(i(),P(z,{key:1,size:"small",icon:"ri-check-line",color:"#0b8707"})):T("",!0)]),"item.role":t(({item:a})=>[a.role==!0?(i(),d("span",ue,"مدیر")):a.role==!1?(i(),d("span",de,"کارشناس")):T("",!0)]),"item.action":t(({item:a})=>[s(z,{class:"me-2",size:"small",icon:"ri-user-settings-line",color:"#d4af37",onClick:M=>J(a)},null,8,["onClick"])]),_:1},8,["headers","items","search","loading"])]),_:1})]),_:1})]),_:1})]),_:1}),s(D,{modelValue:g.value,"onUpdate:modelValue":l[3]||(l[3]=a=>g.value=a),"max-width":"450",class:"dialog"},{default:t(()=>[s(w,{class:"dialog-card"},{default:t(()=>[l[16]||(l[16]=n("div",{class:"k-dialog-title"},[n("p",null,"سطح دسترسی")],-1)),n("div",me,[_.value==!0?(i(),d("div",ce,l[15]||(l[15]=[n("p",null,"لطفا منتظر بمانید ... ",-1)]))):(i(!0),d(R,{key:1},se(b.value,(a,M)=>(i(),d("div",{class:"d-flex justify-space-between align-items-center mx-4 my-2",key:M},[n("span",null,I(a.persianName),1),s(G,{modelValue:a.isAccess,"onUpdate:modelValue":h=>a.isAccess=h,color:"#b08c4d"},null,8,["modelValue","onUpdate:modelValue"])]))),128))]),n("div",ve,[s(v,{text:"انصراف",onClick:l[2]||(l[2]=a=>g.value=!1),size:"large",class:"m-3",variant:"outlined"}),s(v,{text:"ثبت دسترسی",onClick:K,size:"large",class:"m-3",loading:L.value},null,8,["loading"])])]),_:1})]),_:1},8,["modelValue"]),s(D,{modelValue:y.value,"onUpdate:modelValue":l[9]||(l[9]=a=>y.value=a),"max-width":"600",class:"dialog"},{default:t(()=>[s(w,{class:"dialog-card"},{default:t(()=>[l[17]||(l[17]=n("div",{class:"k-dialog-title"},[n("p",null,"افزودن ادمین جدید")],-1)),s(re,{ref:"form",onSubmit:te(O,["prevent"])},{default:t(()=>[s(F,null,{default:t(()=>[s(k,{cols:"12",md:"6",class:"my-4"},{default:t(()=>[s(A,{modelValue:u.value.firstName,"onUpdate:modelValue":l[4]||(l[4]=a=>u.value.firstName=a),label:"نام",variant:"outlined",rules:X},null,8,["modelValue"])]),_:1}),s(k,{cols:"12",md:"6",class:"my-4"},{default:t(()=>[s(A,{modelValue:u.value.lastName,"onUpdate:modelValue":l[5]||(l[5]=a=>u.value.lastName=a),label:"نام خانوادگی",variant:"outlined",rules:Y},null,8,["modelValue"])]),_:1}),s(k,{cols:"12",md:"6",class:"my-4"},{default:t(()=>[s(A,{modelValue:u.value.phoneNumber,"onUpdate:modelValue":l[6]||(l[6]=a=>u.value.phoneNumber=a),label:"شماره همراه",variant:"outlined",rules:Q},null,8,["modelValue"])]),_:1}),s(k,{cols:"12",md:"6",class:"my-4"},{default:t(()=>[s(A,{modelValue:u.value.password,"onUpdate:modelValue":l[7]||(l[7]=a=>u.value.password=a),label:"رمز عبور",variant:"outlined",rules:W},null,8,["modelValue"])]),_:1})]),_:1}),n("div",fe,[s(v,{text:"انصراف",onClick:l[8]||(l[8]=a=>y.value=!1),size:"large",class:"m-3",variant:"outlined"}),s(v,{type:"submit",text:"افزودن",size:"large",class:"m-3",loading:S.value},null,8,["loading"])])]),_:1},512)]),_:1})]),_:1},8,["modelValue"]),s(D,{modelValue:V.value,"onUpdate:modelValue":l[12]||(l[12]=a=>V.value=a),"max-width":"450",class:"dialog"},{default:t(()=>[s(w,{class:"dialog-card"},{default:t(()=>[l[20]||(l[20]=n("div",{class:"k-dialog-title"},[n("p",null,"دسترسی های مدیرتی")],-1)),n("div",pe,[m.value==!0?(i(),d("div",ge,l[18]||(l[18]=[n("p",null,"لطفا منتظر بمانید ... ",-1)]))):(i(),d("div",Ve,[l[19]||(l[19]=n("span",null,"درگاه معاملات",-1)),s(G,{modelValue:x.value,"onUpdate:modelValue":l[10]||(l[10]=a=>x.value=a),color:"#b08c4d",onClick:H,loading:m.value},null,8,["modelValue","loading"])]))]),n("div",ye,[s(v,{text:"انصراف",onClick:l[11]||(l[11]=a=>V.value=!1),size:"large",class:"m-3",variant:"outlined"})])]),_:1})]),_:1},8,["modelValue"]),r.value?(i(),P(oe,{key:0,color:"error",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:t(()=>[U(I(c.value),1)]),_:1})):T("",!0)],64))}},Ge=ee(ke,[["__scopeId","data-v-5ccf3078"]]);export{Ge as default};
