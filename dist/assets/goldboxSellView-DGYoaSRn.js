import{_ as Q,r as n,k as X,c as Y,b as l,w as o,a1 as k,e as w,h as G,a0 as N,q as Z,o as U,a2 as u,C as r,a as m,a4 as y,t as f}from"./index-Btd-pi8F.js";import{G as P}from"./goldbox-BN2hSd8r.js";import{I as h}from"./inperson-BFQE8kOS.js";import{V as I}from"./VAlert-BADi81bL.js";import{V as ee,a as F,b as le,c as H}from"./VTabs-rC-b-IHl.js";import{a as ae,V as _}from"./VCard-wD3li9KV.js";import{V as i}from"./VTextField-B8DrViBe.js";import{V as $}from"./VDataTable-B9giFIW_.js";import{a as j}from"./VSelect-CTwbYWFp.js";import"./api-DSoKIxC4.js";import"./createSimpleFunctional-CB_v5xJt.js";import"./index-CavluHze.js";import"./VWindowItem-DP27_SKH.js";import"./dialog-transition-BEUyEo-d.js";import"./index-B4ht9OuV.js";import"./VMenu-ucJDf81l.js";import"./VAvatar-90kupNrm.js";import"./VImg-B6gkO-4u.js";import"./VDivider-BGmw5LPC.js";import"./VSelectionControl-DocqfYLK.js";const te={class:"w-100 d-flex justify-end"},oe={class:"w-100 d-flex justify-end"},de={class:"w-100 d-flex justify-end"},ue={class:"w-100 d-flex justify-end"},ie={__name:"goldboxSellView",setup(se){const V=n(""),L=n(""),v=n(!1),M=n(!1),c=n(null),R=n([{title:"نام",key:"seller.firstName"},{title:"نام خانوادگی",key:"seller.lastName"},{title:"مبلغ خرید (تومان)",key:"totalPrice"},{title:"وزن طلا (گرم)",key:"goldWeight"},{title:"تاریخ",key:"date"},{title:"زمان",key:"time"},{title:"شناسه پرداخت",key:"invoiceId"},{title:"وضعیت",key:"status"}]),z=n([{title:"نام",key:"seller.firstName"},{title:"نام خانوادگی",key:"seller.lastName"},{title:"مبلغ خرید (تومان)",key:"totalPrice"},{title:"وزن طلا (گرم)",key:"goldWeight"},{title:"تاریخ",key:"date"},{title:"زمان",key:"time"},{title:"شناسه پرداخت",key:"invoiceId"},{title:"وضعیت",key:"status"}]),b=n(),p=n(),g=n(),x=n(),E=n(),t=n({firstName:"",lastName:"",nationalCode:"",phoneNumber:"",tradeType:0,type:"sell",goldPrice:"",goldWeight:"",admin:"",accounter:"",startDate:"",startTime:"",endDate:"",endTime:"",invoiceId:"",status:""}),q=async()=>{try{p.value=!0;const d=await P.SellGoldBox(1);return b.value=d.data,d}catch(d){d.response.status==401&&(localStorage.clear(),N.replace("/login")),V.value=d.response.data.error||"خطایی رخ داده است!",v.value=!0,setTimeout(()=>{v.value=!1},1e4)}finally{p.value=!1}},A=async()=>{try{g.value=!0;const d=await P.SellGoldBox(0);return x.value=d.data,d}catch(d){d.response.status==401&&(localStorage.clear(),N.replace("/login")),V.value=d.response.data.error||"خطایی رخ داده است!",v.value=!0,setTimeout(()=>{v.value=!1},1e4)}finally{g.value=!1}},T=d=>d.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),S=[d=>/^\d{10}$/.test(d)||"کد ملی باید ۱۰ رقم باشد",d=>{if(!/^\d{10}$/.test(d))return!0;const e=+d[9],s=d.split("").slice(0,9).reduce((a,K,O)=>a+ +K*(10-O),0)%11;return s<2&&e===s||s>=2&&e+s===11||"کد ملی نامعتبر است"}],W=()=>{t.value.phoneNumber=t.value.phoneNumber.replace(/\D/g,"").slice(0,11)},C=[d=>/^09\d{9}$/.test(d)||"شماره معتبر نیست"],B=[d=>!!d,d=>/^\d+(\.\d{1,3})?$/.test(d)],J=()=>{t.value.firstName="",t.value.lastName="",t.value.accounter="",t.value.admin="",t.value.endDate="",t.value.endTime="",t.value.goldPrice="",t.value.goldWeight="",t.value.invoiceId="",t.value.nationalCode="",t.value.phoneNumber="",t.value.startTime="",t.value.startDate=""},D=async d=>{console.log(d);try{d=="completed"?p.value=!0:d=="failed"&&(g.value=!0),t.value.status=d;const e=await h.SubmitFilterInvoice(t.value);return d=="completed"?b.value=e.data:d=="failed"&&(x.value=e.data),e}catch(e){e.response.status==401&&(localStorage.clear(),N.replace("/login")),V.value=e.response.data.error||"خطایی رخ داده است!",v.value=!0,setTimeout(()=>{v.value=!1},1e4)}finally{p.value=!1,g.value=!1}};return X(()=>{q(),A()}),(d,e)=>{const s=Z("persian-date-picker");return U(),Y("div",null,[l(k,null,{default:o(()=>[l(u,null,{default:o(()=>[l(ee,{modelValue:c.value,"onUpdate:modelValue":[e[0]||(e[0]=a=>c.value=a),J],"align-tabs":"center"},{default:o(()=>[l(F,{value:"one"},{default:o(()=>e[28]||(e[28]=[r("فروش های موفق")])),_:1}),l(F,{value:"two"},{default:o(()=>e[29]||(e[29]=[r("فروش های ناموفق")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(u,{cols:"12"},{default:o(()=>[l(ae,null,{default:o(()=>[l(le,{modelValue:c.value,"onUpdate:modelValue":e[27]||(e[27]=a=>c.value=a)},{default:o(()=>[l(H,{value:"one"},{default:o(()=>[l(k,{class:"filter my-3"},{default:o(()=>[l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.fromDate,"onUpdate:modelValue":e[1]||(e[1]=a=>t.value.fromDate=a),placeholder:"از تاریخ"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{type:"time",modelValue:t.value.fromTime,"onUpdate:modelValue":e[2]||(e[2]=a=>t.value.fromTime=a),placeholder:"از زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.toDate,"onUpdate:modelValue":e[3]||(e[3]=a=>t.value.toDate=a),placeholder:"تا تاریخ"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{type:"time",modelValue:t.value.toTime,"onUpdate:modelValue":e[4]||(e[4]=a=>t.value.toTime=a),placeholder:"تا زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:t.value.firstName,"onUpdate:modelValue":e[5]||(e[5]=a=>t.value.firstName=a),label:"نام",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:t.value.lastName,"onUpdate:modelValue":e[6]||(e[6]=a=>t.value.lastName=a),label:"نام خانوادگی",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:t.value.phoneNumber,"onUpdate:modelValue":e[7]||(e[7]=a=>t.value.phoneNumber=a),label:"شماره موبایل",density:"compact",variant:"outlined",rules:C,onInput:W},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:t.value.nationalCode,"onUpdate:modelValue":e[8]||(e[8]=a=>t.value.nationalCode=a),label:"کد ملی",density:"compact",variant:"outlined",rules:S},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:t.value.goldPrice,"onUpdate:modelValue":e[9]||(e[9]=a=>t.value.goldPrice=a),label:"قیمت طلا",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:t.value.goldWeight,"onUpdate:modelValue":e[10]||(e[10]=a=>t.value.goldWeight=a),label:"وزن طلا",density:"compact",variant:"outlined",rules:B},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:t.value.goldWeight,"onUpdate:modelValue":e[11]||(e[11]=a=>t.value.goldWeight=a),label:"ادمین",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:t.value.goldWeight,"onUpdate:modelValue":e[12]||(e[12]=a=>t.value.goldWeight=a),label:"حسابدار",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{md:"6",class:"d-none d-md-flex"}),l(u,{cols:"12",md:"3"},{default:o(()=>[m("div",te,[l(y,{"prepend-icon":"ri-loop-left-line",variant:"tonal",block:"",onClick:e[13]||(e[13]=a=>D("completed"))},{default:o(()=>e[30]||(e[30]=[r("به روز رسانی")])),_:1})])]),_:1}),l(u,{cols:"12",md:"3"},{default:o(()=>[m("div",oe,[l(y,{"prepend-icon":"ri-file-excel-line",block:""},{default:o(()=>e[31]||(e[31]=[r("خروجی اکسل")])),_:1})])]),_:1})]),_:1}),l(_,{title:"فروش موفق"},{default:o(()=>[l($,{headers:R.value,items:b.value,loading:p.value},{"item.totalPrice":o(({item:a})=>[m("p",null,f(T(a.totalPrice)),1)]),"item.goldWeight":o(({item:a})=>[m("p",null,f((+a.goldWeight).toFixed(3)),1)]),"item.status":o(({item:a})=>[m("div",null,[l(j,{text:a.status=="completed"?"موفق":"نامشخص",color:a.status=="completed"?"#00853f":"#66666",size:"small"},null,8,["text","color"])])]),_:1},8,["headers","items","loading"])]),_:1})]),_:1}),l(H,{value:"two"},{default:o(()=>[l(k,{class:"filter my-3"},{default:o(()=>[l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.fromDate,"onUpdate:modelValue":e[14]||(e[14]=a=>t.value.fromDate=a),placeholder:"از تاریخ"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{type:"time",modelValue:t.value.fromTime,"onUpdate:modelValue":e[15]||(e[15]=a=>t.value.fromTime=a),placeholder:"از زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{modelValue:t.value.toDate,"onUpdate:modelValue":e[16]||(e[16]=a=>t.value.toDate=a),placeholder:"تا تاریخ"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(s,{type:"time",modelValue:t.value.toTime,"onUpdate:modelValue":e[17]||(e[17]=a=>t.value.toTime=a),placeholder:"تا زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:t.value.firstName,"onUpdate:modelValue":e[18]||(e[18]=a=>t.value.firstName=a),label:"نام",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:t.value.lastName,"onUpdate:modelValue":e[19]||(e[19]=a=>t.value.lastName=a),label:"نام خانوادگی",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:t.value.phoneNumber,"onUpdate:modelValue":e[20]||(e[20]=a=>t.value.phoneNumber=a),label:"شماره موبایل",density:"compact",variant:"outlined",rules:C,onInput:W},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:t.value.nationalCode,"onUpdate:modelValue":e[21]||(e[21]=a=>t.value.nationalCode=a),label:"کد ملی",density:"compact",variant:"outlined",rules:S},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:t.value.goldPrice,"onUpdate:modelValue":e[22]||(e[22]=a=>t.value.goldPrice=a),label:"قیمت طلا",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:t.value.goldWeight,"onUpdate:modelValue":e[23]||(e[23]=a=>t.value.goldWeight=a),label:"وزن طلا",density:"compact",variant:"outlined",rules:B},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:t.value.goldWeight,"onUpdate:modelValue":e[24]||(e[24]=a=>t.value.goldWeight=a),label:"ادمین",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:t.value.goldWeight,"onUpdate:modelValue":e[25]||(e[25]=a=>t.value.goldWeight=a),label:"حسابدار",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{md:"6",class:"d-none d-md-flex"}),l(u,{cols:"12",md:"3"},{default:o(()=>[m("div",de,[l(y,{"prepend-icon":"ri-loop-left-line",variant:"tonal",block:"",onClick:e[26]||(e[26]=a=>D("failed"))},{default:o(()=>e[32]||(e[32]=[r("به روز رسانی")])),_:1})])]),_:1}),l(u,{cols:"12",md:"3"},{default:o(()=>[m("div",ue,[l(y,{"prepend-icon":"ri-file-excel-line",block:""},{default:o(()=>e[33]||(e[33]=[r("خروجی اکسل")])),_:1})])]),_:1})]),_:1}),l(_,{title:"فروش ناموفق"},{default:o(()=>[l($,{headers:z.value,items:x.value,search:E.value,loading:p.value},{"item.totalPrice":o(({item:a})=>[m("p",null,f(T(a.totalPrice)),1)]),"item.goldWeight":o(({item:a})=>[m("p",null,f((+a.goldWeight).toFixed(3)),1)]),"item.status":o(({item:a})=>[m("div",null,[l(j,{text:a.status=="failed"?"ناموفق":"نامشخص",color:a.status=="failed"?"#ff0000":"#66666",size:"small"},null,8,["text","color"])])]),_:1},8,["headers","items","search","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),v.value?(U(),w(I,{key:0,color:"error",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:o(()=>[r(f(V.value),1)]),_:1})):G("",!0),M.value?(U(),w(I,{key:1,color:"success",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:o(()=>[r(f(L.value),1)]),_:1})):G("",!0)])}}},De=Q(ie,[["__scopeId","data-v-9bd0af58"]]);export{De as default};
