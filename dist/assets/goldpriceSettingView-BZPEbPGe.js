import{_ as T,r,k as C,c as V,b as o,w as n,a1 as I,e as j,h as F,F as L,bP as p,o as v,a2 as w,a as t,a3 as D,a4 as E,C as S,t as c}from"./index-D5IW2YVy.js";import{G as m}from"./price-5m1DUo0I.js";import{V as U}from"./VAlert-DpF4ZrVk.js";import{V as z}from"./VSwitch-DRzNHCHK.js";import{V as A}from"./VDivider-CDHm-Z6B.js";import{V as R}from"./VForm-Cn1ldXGE.js";import{V as W}from"./VTextField-BtM-ROXs.js";import"./createSimpleFunctional-rVjvmkLf.js";import"./index-gzafSOdb.js";import"./VSelectionControl-CG1oV9gi.js";import"./index-ChZLivdR.js";const q={class:"box"},H={class:"d-flex justify-space-between my-4"},J={class:"my-4"},K={class:"box"},O={class:"d-flex justify-space-between align-center manual-price-box my-4"},Q={key:0},X={key:1},Y={class:"d-flex justify-space-between align-center my-4"},Z={class:"d-flex justify-space-between align-center my-4"},$={__name:"goldpriceSettingView",setup(ee){const _=r(!1),f=r(!1),g=r(!1),M=r(!1),s=r(!1),i=r(""),a=r({setManual:!1,goldPriceManual:null}),d=r({buyPrice:"",sellPrice:""}),u=r(""),x=()=>{a.value.goldPriceManual=a.value.goldPriceManual.replace(/\D/g,""),a.value.goldPriceManual.length>10&&(a.value.goldPriceManual=a.value.goldPriceManual.slice(0,11)),a.value.goldPriceManual=h(a.value.goldPriceManual)},h=e=>e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),P=e=>e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),k=[e=>!!e||"مقدار ورودی نمی‌تواند خالی باشد"],y=async()=>{try{_.value=!0;const e=await m.PriceStatus();return a.value.setManual=e.data.active,e.data.active==!1?u.value="غیر فعال است":u.value=e.data.price,e}catch(e){e.response.status==401&&(localStorage.clear(),p.replace("/login")),i.value=e.response.data.error||"خطایی رخ داده است!",s.value=!0,setTimeout(()=>{s.value=!1},1e4)}finally{_.value=!1}},G=async()=>{try{f.value=!0;const e=await m.SetPriceStatus(a.value.goldPriceManual);return y(),e}catch(e){e.response.status==401&&(localStorage.clear(),p.replace("/login")),i.value=e.response.data.error||"خطایی رخ داده است!",s.value=!0,setTimeout(()=>{s.value=!1},1e4)}finally{f.value=!1}},B=async()=>{try{g.value=!0;const e=await m.switchPriceStatus();return y(),e}catch(e){e.response.status==401&&(localStorage.clear(),p.replace("/login")),i.value=e.response.data.error||"خطایی رخ داده است!",s.value=!0,setTimeout(()=>{s.value=!1},1e4)}finally{g.value=!1}},N=async()=>{try{M.value=!0;const e=await m.GetGoldPrice();return d.value.buyPrice=e.buyPrice,d.value.sellPrice=e.sellPrice,e}catch(e){e.response.status==401&&(localStorage.clear(),p.replace("/login")),i.value=e.response.data.error||"خطایی رخ داده است!",s.value=!0,setTimeout(()=>{s.value=!1},1e4)}finally{M.value=!1}};return C(()=>{y(),N()}),(e,l)=>(v(),V(L,null,[o(I,null,{default:n(()=>[o(w,{cols:"12",md:"6"},{default:n(()=>[t("div",q,[t("div",H,[l[2]||(l[2]=t("h4",null,"اعمال قیمت دستی",-1)),o(z,{modelValue:a.value.setManual,"onUpdate:modelValue":l[0]||(l[0]=b=>a.value.setManual=b),color:"#b08c4d",onInput:B,loading:g.value},null,8,["modelValue","loading"])]),o(A),t("div",J,[o(R,{ref:"form",class:"d-flex align-center",onSubmit:D(G,["prevent"])},{default:n(()=>[o(W,{modelValue:a.value.goldPriceManual,"onUpdate:modelValue":l[1]||(l[1]=b=>a.value.goldPriceManual=b),label:"قیمت دستی طلا (تومان)",variant:"outlined",class:"ma-1",rules:k,onInput:x},null,8,["modelValue"]),o(E,{type:"submit",color:"primary",size:"large",class:"mx-1",loading:f.value,disabled:!a.value.setManual},{default:n(()=>l[3]||(l[3]=[S("اعمال قیمت دستی")])),_:1},8,["loading","disabled"])]),_:1},512)])])]),_:1}),o(w,{cols:"12",md:"6"},{default:n(()=>[t("div",K,[t("div",O,[l[4]||(l[4]=t("span",null,"قیمت دستی طلا: ",-1)),u.value!="غیر فعال است"?(v(),V("span",Q,c(P(u.value))+" تومان",1)):(v(),V("span",X,c(u.value),1))]),t("div",Y,[l[5]||(l[5]=t("span",null,"قیمت لحظه ای فروش: ",-1)),t("span",null,c(P(d.value.sellPrice))+" تومان",1)]),t("div",Z,[l[6]||(l[6]=t("span",null,"قیمت لحظه ای خرید: ",-1)),t("span",null,c(P(d.value.buyPrice))+" تومان",1)])])]),_:1})]),_:1}),s.value?(v(),j(U,{key:0,color:"error",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:n(()=>[S(c(i.value),1)]),_:1})):F("",!0)],64))}},pe=T($,[["__scopeId","data-v-0bf8ed31"]]);export{pe as default};
