import{_ as H,r as i,i as $,c,a as l,b as s,w as t,a5 as A,e as u,j as r,F as I,at as M,o,$ as w,a0 as p,D as f,t as m,V as x,Y as D}from"./index-vyj39tW9.js";import{R as U}from"./report-BfxjVtaW.js";import{V as j}from"./VDialog-CIICYXOi.js";import{V as b}from"./VAlert-BuAvxl6f.js";import{V as z}from"./VCard-CMdc9oMR.js";import{V as G}from"./VTextField-DLnG0Yyy.js";import{V as J}from"./VDataTable-DdWWjz77.js";import{V as C}from"./VTooltip-DTjEvvKS.js";import{V as v}from"./VChip-CwdE6eEi.js";import"./api-CGWAiGu1.js";import"./dialog-transition-BaMTXQKf.js";import"./index-BnlBV6sc.js";import"./index-6qbU7tIu.js";import"./createSimpleFunctional-DqyXimQb.js";import"./VAvatar-BNvu0nmS.js";import"./VImg-DeMP08Iy.js";import"./VSelect-brMGNXgg.js";import"./VMenu-jlXDHhpJ.js";import"./VDivider-Cie7d4gu.js";import"./VSelectionControl-DUcUHVUW.js";const O={class:"d-flex"},P={class:"d-flex align-center py-6"},Y={class:"d-flex align-center py-6"},q={key:0},K={key:1},Q={key:2},W={class:"d-flex align-center py-6"},X={key:0},Z={key:1},ee={key:2},te={key:3},ae={class:"d-flex align-center py-6"},le={class:"d-flex align-center py-6"},se={class:"d-flex align-center py-6"},oe={class:"d-flex align-center py-6"},re={class:"d-flex align-center py-6"},ne={__name:"ReportHistoryView",setup(ie){const _=i(""),R=i(""),k=i(!1),h=i(""),L=i(!1);i(!1),i(!1);const B=i([{title:"تاریخ",key:"date"},{title:"زمان",key:"time"},{title:"گزارش گیرنده",key:"fullName"},{title:"وضعیت",key:"status"},{title:"فعالیت",key:"action"}]);i({firstName:null,lastName:null,phoneNumber:null}),i(!1),i(!1);const T=i([]),V=i(!1),g=i(!1),a=i({auth:"-",deal:"-",endDate:"-",endTime:"-",nationalCode:"-",report:"-",startDate:"-",startTime:"-",status:"-",type:"-"}),F=async()=>{try{V.value=!0;const d=await U.ReportHistoryList();return T.value=d.data,d}catch(d){d.response.status==401&&(localStorage.clear(),M.replace("/login")),R.value=d.response.data.error||"خطایی رخ داده است!",k.value=!0,setTimeout(()=>{k.value=!1},1e4)}finally{V.value=!1}},S=d=>{window.location.href=d.link},E=d=>{g.value=!0;let e=JSON.parse(d.reportBody);a.value.auth=e.auth,a.value.deal=e.deal,a.value.endDate=e.endDate,a.value.endTime=e.endTime,a.value.nationalCode=e.nationalCode,a.value.report=e.report,a.value.startDate=e.startDate,a.value.startTime=e.startTime,a.value.status=e.status,a.value.type=e.type};return $(()=>{F()}),(d,e)=>(o(),c(I,null,[l("div",null,[s(A,null,{default:t(()=>[s(w,null,{default:t(()=>[s(p,{cols:"12"},{default:t(()=>[s(z,{title:"تاریخچه گزارشات"},{text:t(()=>[s(G,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=n=>_.value=n),label:"جستجو","prepend-inner-icon":"ri-search-line"},null,8,["modelValue"])]),default:t(()=>[s(J,{headers:B.value,items:T.value,search:_.value,loading:V.value},{"item.fullName":t(({item:n})=>[f(m(n.firstName)+" "+m(n.lastName),1)]),"item.status":t(({item:n})=>[n.status==0?(o(),u(v,{key:0,text:"در انتظار پردازش",color:"#1A237E",size:"small"})):r("",!0),n.status==1?(o(),u(v,{key:1,text:"در حال پردازش",color:"#F9A825",size:"small"})):r("",!0),n.status==2?(o(),u(v,{key:2,text:"پردازش شده",color:"#2E7D32",size:"small"})):r("",!0),n.status==3?(o(),u(v,{key:3,text:"به مشکل خورده",color:"#B71C1C",size:"small"})):r("",!0)]),"item.action":t(({item:n})=>[s(C,{text:"جزئیات",location:"top"},{activator:t(({props:y})=>[s(x,D({class:"me-2",size:"small",icon:"ri-information-line",color:"#d4af37"},y,{onClick:N=>E(n)}),null,16,["onClick"])]),_:2},1024),n.status==2?(o(),u(C,{key:0,text:"دانلود",location:"top"},{activator:t(({props:y})=>[s(x,D({class:"me-2",size:"small",icon:"ri-download-2-line",color:"#2E7D32"},y,{onClick:N=>S(n)}),null,16,["onClick"])]),_:2},1024)):r("",!0),n.status==3?(o(),u(C,{key:1,text:"پردازش مجدد",location:"top"},{activator:t(({props:y})=>[s(x,D({class:"me-2",size:"small",icon:"ri-repeat-line",color:"#D32F2F"},y,{onClick:N=>d.ReportRepeat(n)}),null,16,["onClick"])]),_:2},1024)):r("",!0)]),_:1},8,["headers","items","search","loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),s(j,{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=n=>g.value=n),"max-width":"600",class:"dialog"},{default:t(()=>[s(z,{class:"dialog-card"},{default:t(()=>[e[13]||(e[13]=l("div",{class:"k-dialog-title"},[l("p",null,"جزئیات گزارش")],-1)),l("div",O,[s(w,null,{default:t(()=>[s(p,{cols:"6",md:"4"},{default:t(()=>[l("div",P,[e[5]||(e[5]=l("span",null,"نوع گزارش:",-1)),a.value.report==1?(o(),u(v,{key:0,size:"small"},{default:t(()=>e[2]||(e[2]=[f("واریز و برداشت")])),_:1})):r("",!0),a.value.report==2?(o(),u(v,{key:1},{default:t(()=>e[3]||(e[3]=[f("معاملات")])),_:1})):r("",!0),a.value.report==3?(o(),u(v,{key:2},{default:t(()=>e[4]||(e[4]=[f("کاربران")])),_:1})):r("",!0)])]),_:1}),a.value.report==3?(o(),u(p,{key:0,cols:"6",md:"4"},{default:t(()=>[l("div",Y,[e[6]||(e[6]=l("span",null,"وضعیت احراز:",-1)),a.value.auth=="approved"?(o(),c("span",q,"احراز هویت شده")):r("",!0),a.value.auth=="approved"?(o(),c("span",K,"احراز هویت نشده")):r("",!0),a.value.auth=="approved"?(o(),c("span",Q,"تمامی کاربران")):r("",!0)])]),_:1})):r("",!0),s(p,{cols:"6",md:"4"},{default:t(()=>[l("div",W,[e[7]||(e[7]=l("span",null,"وضعیت معامله:",-1)),a.value.status=="completed"?(o(),c("span",X,"موفق")):r("",!0),a.value.status=="pending"?(o(),c("span",Z,"در انتظار")):r("",!0),a.value.status=="failed"?(o(),c("span",ee,"ناموفق")):r("",!0),a.value.status=="all"?(o(),c("span",te,"همه")):r("",!0)])]),_:1}),s(p,{cols:"6",md:"4"},{default:t(()=>[l("div",ae,[e[8]||(e[8]=l("span",null,"کد ملی:",-1)),l("span",null,m(a.value.nationalCode),1)])]),_:1}),s(p,{cols:"6",md:"4"},{default:t(()=>[l("div",le,[e[9]||(e[9]=l("span",null,"تاریخ شروع:",-1)),l("span",null,m(a.value.startDate),1)])]),_:1}),s(p,{cols:"6",md:"4"},{default:t(()=>[l("div",se,[e[10]||(e[10]=l("span",null,"زمان شروع:",-1)),l("span",null,m(a.value.startTime),1)])]),_:1}),s(p,{cols:"6",md:"4"},{default:t(()=>[l("div",oe,[e[11]||(e[11]=l("span",null,"تاریخ پایان:",-1)),l("span",null,m(a.value.endDate),1)])]),_:1}),s(p,{cols:"6",md:"4"},{default:t(()=>[l("div",re,[e[12]||(e[12]=l("span",null,"زمان پایان:",-1)),l("span",null,m(a.value.endTime),1)])]),_:1})]),_:1})])]),_:1})]),_:1},8,["modelValue"]),k.value?(o(),u(b,{key:0,color:"error",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:t(()=>[f(m(R.value),1)]),_:1})):r("",!0),L.value?(o(),u(b,{key:1,color:"success",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:t(()=>[f(m(h.value),1)]),_:1})):r("",!0)],64))}},ze=H(ne,[["__scopeId","data-v-107d3d8c"]]);export{ze as default};
