import{G as j}from"./goldbox-B7PqXjxh.js";import{_ as A,r as i,c as H,b as a,w as t,a7 as J,e as K,h as O,F as P,o as z,a1 as c,a2 as u,a as o,a4 as y,C as g,t as f,V as T}from"./index-kIM0J7p6.js";import{V as D}from"./VDialog-Dx0dlomF.js";import{V as Q}from"./VAlert-Bf6f0eKq.js";import{V,a as I}from"./VCard-Dq28bNsi.js";import{V as S}from"./VTextField-BVsAqBpZ.js";import"./api-B5ylx0Q2.js";import"./dialog-transition-CJlGBmQA.js";import"./index-DzISJ_UR.js";import"./index-8DLNIlez.js";import"./createSimpleFunctional-D5yrpv8H.js";import"./VAvatar-BOOUUsLE.js";import"./VImg-CLfSGMaR.js";const X={class:"d-flex align-center justify-start"},Y={class:"d-flex align-center justify-start"},Z={class:"d-flex align-center justify-start"},h={class:"d-flex align-center justify-start"},ee={class:"d-flex justify-center align-center"},le={class:"d-flex align-center justify-start"},ae={class:"d-flex align-center justify-start"},te={class:"d-flex align-center justify-start"},oe={class:"d-flex align-center justify-start"},se={class:"d-flex align-center justify-start"},re={class:"d-flex justify-end"},ue={class:"w-100 d-flex justify-space-between mt-4"},ne={__name:"EmergencyTransferView",setup(de){const r=i({sender:"",reciever:"",goldWeight:""}),$=i(!1),k=i(!1),W=i(!1),w=i(!1),p=i(!1),m=i(!1),N=i(!1),x=i(""),d=i({firstName:"",lastName:"",nationalCode:"",goldWeight:""}),n=i({firstName:"",lastName:"",nationalCode:"",phoneNumber:"",goldWeight:"",goldBlock:0}),B=i(!1),G=async()=>{var s;try{k.value=!0;const e=await j.inquiryGoldBoxSender(r.value.sender);return W.value=!0,d.value.firstName=e==null?void 0:e.firstName,d.value.lastName=e==null?void 0:e.lastName,d.value.nationalCode=e==null?void 0:e.nationalCode,d.value.goldWeight=(s=e==null?void 0:e.wallet)==null?void 0:s.goldWeight,e}catch(e){e.response.status==401&&(localStorage.clear(),router.replace("/login")),x.value=e.response.data.error||"خطایی رخ داده است!",m.value=!0,setTimeout(()=>{m.value=!1},1e4)}finally{k.value=!1}},U=async()=>{var s,e,l,b,_;try{$.value=!0;const v=await j.inquiryGoldBoxReciever(r.value.reciever);return w.value=!0,n.value.firstName=(s=v.data)==null?void 0:s.firstName,n.value.lastName=(e=v.data)==null?void 0:e.lastName,n.value.nationalCode=(l=v.data)==null?void 0:l.nationalCode,n.value.goldWeight=(b=v.data)==null?void 0:b.goldWeight,n.value.goldBlock=(_=v.data)==null?void 0:_.goldBlock,v}catch(v){v.response.status==401&&(localStorage.clear(),router.replace("/login")),x.value=v.response.data.error||"خطایی رخ داده است!",m.value=!0,setTimeout(()=>{m.value=!1},1e4)}finally{$.value=!1}},q=async()=>{try{B.value=!0;const s=await j.confirmTransfer(r.value);return p.value=!1,E(),s}catch(s){s.response.status==401&&(localStorage.clear(),router.replace("/login")),x.value=s.response.data.error||"خطایی رخ داده است!",m.value=!0,setTimeout(()=>{m.value=!1},1e4)}finally{B.value=!1}},E=async()=>{N.value=!0,setInterval(()=>{N.value=!1,r.value.sender="",r.value.reciever="",r.value.goldWeight="",d.value.firstName="",d.value.lastName="",d.value.goldWeight="",d.value.nationalCode="",n.value.firstName="",n.value.lastName="",n.value.goldBlock="",n.value.goldWeight="",n.value.nationalCode="",n.value.phoneNumber=""},3e3)},F=()=>{r.value.sender=r.value.sender.replace(/\D/g,"").slice(0,10),C.every(s=>s(r.value.sender)===!0)},R=()=>{r.value.reciever=r.value.reciever.replace(/\D/g,"").slice(0,10),C.every(s=>s(r.value.reciever)===!0)},C=[s=>!!s||"کد ملی الزامی است",s=>/^\d{10}$/.test(s)||"کد ملی باید ۱۰ رقم باشد",s=>{if(!/^\d{10}$/.test(s))return!0;const e=+s[9],l=s.split("").slice(0,9).reduce((b,_,v)=>b+ +_*(10-v),0)%11;return l<2&&e===l||l>=2&&e+l===11||"کد ملی نامعتبر است"}],L=()=>{r.value.goldWeight=r.value.goldWeight.replace(/[^0-9.]/g,"")},M=[s=>!!s||"مقدار ورودی نمی‌تواند خالی باشد"];return(s,e)=>(z(),H(P,null,[a(J,null,{default:t(()=>[a(c,null,{default:t(()=>[a(u,{cols:"12",class:"my-2"},{default:t(()=>[a(V,null,{default:t(()=>[a(I,null,{default:t(()=>[e[14]||(e[14]=o("h3",{class:"mb-2"},"اطلاعات انتقال دهنده",-1)),a(c,null,{default:t(()=>[a(u,{cols:"12",md:"6"},{default:t(()=>[a(S,{modelValue:r.value.sender,"onUpdate:modelValue":e[0]||(e[0]=l=>r.value.sender=l),label:"کد ملی",variant:"outlined",rules:C,onInput:F},null,8,["modelValue"])]),_:1}),a(u,{cols:"12",md:"6"},{default:t(()=>[a(y,{class:"h-100 py-2",color:"primary",size:"large",variant:"elevated",block:"",onClick:e[1]||(e[1]=l=>G()),loading:k.value},{default:t(()=>e[9]||(e[9]=[g(" استعلام انتقال دهنده ")])),_:1},8,["loading"])]),_:1})]),_:1}),a(c,null,{default:t(()=>[a(u,{cols:"12",md:"4"},{default:t(()=>{var l;return[o("div",X,[e[10]||(e[10]=o("p",null,"نام : ",-1)),o("p",null,f((l=d.value)==null?void 0:l.firstName),1)])]}),_:1}),a(u,{cols:"12",md:"4"},{default:t(()=>{var l;return[o("div",Y,[e[11]||(e[11]=o("p",null,"نام خانوادگی : ",-1)),o("p",null,f((l=d.value)==null?void 0:l.lastName),1)])]}),_:1}),a(u,{cols:"12",md:"4"},{default:t(()=>{var l;return[o("div",Z,[e[12]||(e[12]=o("p",null,"کد ملی : ",-1)),o("p",null,f((l=d.value)==null?void 0:l.nationalCode),1)])]}),_:1}),a(u,{cols:"12",md:"4"},{default:t(()=>{var l;return[o("div",h,[e[13]||(e[13]=o("p",null,"موجودی صندوق طلا : ",-1)),o("p",null,f((l=d.value)==null?void 0:l.goldWeight)+" گرم",1)])]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(u,{cols:"12"},{default:t(()=>[o("div",ee,[a(T,{icon:"ri-arrow-up-down-line",color:"#000"})])]),_:1}),a(u,{cols:"12",class:"my-2"},{default:t(()=>[a(V,null,{default:t(()=>[a(I,null,{default:t(()=>[e[21]||(e[21]=o("h3",{class:"mb-2"},"اطلاعات انتقال گیرنده",-1)),a(c,null,{default:t(()=>[a(u,{cols:"12",md:"6"},{default:t(()=>[a(S,{modelValue:r.value.reciever,"onUpdate:modelValue":e[2]||(e[2]=l=>r.value.reciever=l),label:"کد ملی",variant:"outlined",rules:C,onInput:R},null,8,["modelValue"])]),_:1}),a(u,{cols:"12",md:"6"},{default:t(()=>[a(y,{class:"h-100 py-2",color:"primary",size:"large",variant:"elevated",block:"",onClick:e[3]||(e[3]=l=>U())},{default:t(()=>e[15]||(e[15]=[g(" استعلام انتقال گیرنده ")])),_:1})]),_:1})]),_:1}),a(c,null,{default:t(()=>[a(u,{cols:"12",md:"4"},{default:t(()=>{var l;return[o("div",le,[e[16]||(e[16]=o("p",null,"نام : ",-1)),o("p",null,f((l=n.value)==null?void 0:l.firstName),1)])]}),_:1}),a(u,{cols:"12",md:"4"},{default:t(()=>{var l;return[o("div",ae,[e[17]||(e[17]=o("p",null,"نام خانوادگی : ",-1)),o("p",null,f((l=n.value)==null?void 0:l.lastName),1)])]}),_:1}),a(u,{cols:"12",md:"4"},{default:t(()=>{var l;return[o("div",te,[e[18]||(e[18]=o("p",null,"کد ملی : ",-1)),o("p",null,f((l=n.value)==null?void 0:l.nationalCode),1)])]}),_:1}),a(u,{cols:"12",md:"4"},{default:t(()=>{var l;return[o("div",oe,[e[19]||(e[19]=o("p",null,"طلای در انتظار : ",-1)),o("p",null,f((l=n.value)==null?void 0:l.goldBlock),1)])]}),_:1}),a(u,{cols:"12",md:"4"},{default:t(()=>{var l;return[o("div",se,[e[20]||(e[20]=o("p",null,"موجودی صندوق طلا : ",-1)),o("p",null,f((l=n.value)==null?void 0:l.goldWeight)+" گرم",1)])]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(u,{cols:"12",class:"my-2"},{default:t(()=>[a(V,null,{default:t(()=>[a(I,null,{default:t(()=>[a(c,null,{default:t(()=>[a(u,{cols:"12",md:"6"},{default:t(()=>[a(S,{modelValue:r.value.goldWeight,"onUpdate:modelValue":e[4]||(e[4]=l=>r.value.goldWeight=l),label:"وزن (گرم)",variant:"outlined",rules:M,onInput:L,disabled:W.value!=!0||w.value!=!0},null,8,["modelValue","disabled"])]),_:1}),a(u,{cols:"12",md:"6"},{default:t(()=>[o("div",re,[a(y,{class:"py-2 px-10",color:"#c61a09",size:"large",variant:"elevated",disabled:W.value!=!0||w.value!=!0||r.value.goldWeight=="",onClick:e[5]||(e[5]=l=>p.value=!0)},{default:t(()=>e[22]||(e[22]=[g(" تایید انتقال ")])),_:1},8,["disabled"])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(D,{modelValue:p.value,"onUpdate:modelValue":e[7]||(e[7]=l=>p.value=l),"max-width":"500"},{default:t(()=>[a(V,{title:"تایید انتقال",class:"modal-card"},{default:t(()=>[a(T,{class:"mt-3 mb-6",icon:"ri-error-warning-fill",color:"#c61a09"}),e[25]||(e[25]=o("h4",{class:"my-3"}," آیا از این انتقال مطمئن هستید؟ ",-1)),e[26]||(e[26]=o("p",{class:"my-3"},"در صورت انجام این انتقال، امکان بازگشت وجود ندارد",-1)),o("div",ue,[a(y,{color:"#c61a09",size:"large",variant:"outlined",onClick:e[6]||(e[6]=l=>p.value=!1)},{default:t(()=>e[23]||(e[23]=[g(" لغو ")])),_:1}),a(y,{color:"#c61a09",size:"large",variant:"elevated",onClick:q,loading:B.value},{default:t(()=>e[24]||(e[24]=[g(" تایید ")])),_:1},8,["loading"])])]),_:1})]),_:1},8,["modelValue"]),a(D,{modelValue:N.value,"onUpdate:modelValue":e[8]||(e[8]=l=>N.value=l),"max-width":"500"},{default:t(()=>[a(V,{title:"تایید انتقال",class:"modal-card"},{default:t(()=>[a(T,{class:"mt-3 mb-6",icon:"ri-checkbox-circle-fill",color:"#0b8707"}),e[27]||(e[27]=o("h4",null," انتقال طلا با موفقیت انجام شد ",-1))]),_:1})]),_:1},8,["modelValue"]),m.value?(z(),K(Q,{key:0,color:"error",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:t(()=>[g(f(x.value),1)]),_:1})):O("",!0)],64))}},_e=A(ne,[["__scopeId","data-v-4b318833"]]);export{_e as default};
