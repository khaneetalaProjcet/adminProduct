import{D as oe,G as ne,H as Q,aj as ie,r as n,ak as ue,A as X,I as re,K as de,al as ce,b as l,J as Y,F as W,ah as me,V as M,am as ve,an as fe,_ as pe,k as Ve,c as g,w as o,e as q,a7 as ge,h as J,o as c,a1 as ee,a2 as U,a as i,a4 as C,C as K,a8 as ye,a3 as ke,t as ae}from"./index-3Gb3Dr87.js";import{M as P}from"./managment-hRrVgN--.js";import{V as be}from"./VContainer-DwomlH1n.js";import{V as O}from"./VDialog-B9sJn9W8.js";import{V as F}from"./VCard-B28GXbkq.js";import{m as we,u as Ae,a as le,V as z}from"./VTextField-Bih2bCYg.js";import{V as xe}from"./VDataTable-BhNSyDIN.js";import{V as Ce}from"./VForm-Cnm_IdVK.js";import{b as he}from"./index-MdKM_L2w.js";import{m as _e,b as te}from"./VSelect-BZvwABMP.js";import"./api-cTxqDW9U.js";import"./VMenu-khQ79lc0.js";import"./VImg-BJXVsm4H.js";const Pe=oe({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...we(),..._e()},"VSwitch"),se=ne()({name:"VSwitch",inheritAttrs:!1,props:Pe(),emits:{"update:focused":s=>!0,"update:modelValue":s=>!0,"update:indeterminate":s=>!0},setup(s,$){let{attrs:T,slots:r}=$;const p=Q(s,"indeterminate"),m=Q(s,"modelValue"),{loaderClasses:N}=ie(s),{isFocused:v,focus:S,blur:h}=Ae(s),y=n(),V=ue&&window.matchMedia("(forced-colors: active)").matches,k=X(()=>typeof s.loading=="string"&&s.loading!==""?s.loading:s.color),f=re(),u=X(()=>s.id||`switch-${f}`);function b(){p.value&&(p.value=!1)}function d(w){var A,_;w.stopPropagation(),w.preventDefault(),(_=(A=y.value)==null?void 0:A.input)==null||_.click()}return de(()=>{const[w,A]=ce(T),_=le.filterProps(s),j=te.filterProps(s);return l(le,Y({class:["v-switch",{"v-switch--flat":s.flat},{"v-switch--inset":s.inset},{"v-switch--indeterminate":p.value},N.value,s.class]},w,_,{modelValue:m.value,"onUpdate:modelValue":B=>m.value=B,id:u.value,focused:v.value,style:s.style}),{...r,default:B=>{let{id:G,messagesId:E,isDisabled:H,isReadonly:Z,isValid:I}=B;const D={model:m,isValid:I};return l(te,Y({ref:y},j,{modelValue:m.value,"onUpdate:modelValue":[x=>m.value=x,b],id:G.value,"aria-describedby":E.value,type:"checkbox","aria-checked":p.value?"mixed":void 0,disabled:H.value,readonly:Z.value,onFocus:S,onBlur:h},A),{...r,default:x=>{let{backgroundColorClasses:a,backgroundColorStyles:e}=x;return l("div",{class:["v-switch__track",V?void 0:a.value],style:e.value,onClick:d},[r["track-true"]&&l("div",{key:"prepend",class:"v-switch__track-true"},[r["track-true"](D)]),r["track-false"]&&l("div",{key:"append",class:"v-switch__track-false"},[r["track-false"](D)])])},input:x=>{let{inputNode:a,icon:e,backgroundColorClasses:t,backgroundColorStyles:R}=x;return l(W,null,[a,l("div",{class:["v-switch__thumb",{"v-switch__thumb--filled":e||s.loading},s.inset||V?void 0:t.value],style:s.inset?void 0:R.value},[r.thumb?l(me,{defaults:{VIcon:{icon:e,size:"x-small"}}},{default:()=>[r.thumb({...D,icon:e})]}):l(he,null,{default:()=>[s.loading?l(ve,{name:"v-switch",active:!0,color:I.value===!1?void 0:k.value},{default:L=>r.loader?r.loader(L):l(fe,{active:L.isActive,color:L.color,indeterminate:!0,size:"16",width:"2"},null)}):e&&l(M,{key:String(e),icon:e,size:"x-small"},null)]})])])}})}})}),{}}}),Ne={class:"px-5 py-3 d-flex justify-end"},Se={key:0,class:"table-green"},Be={key:1,class:"table-red"},De={class:"d-flex flex-column w-100 h-100 my-2"},Le={key:0,class:"dialog-loading"},Ue={class:"d-flex justify-space-between"},ze={class:"d-flex justify-space-between"},Te={class:"d-flex flex-column w-100 h-100 my-2"},Ie={key:0,class:"dialog-access-loading"},Re={key:1,class:"d-flex justify-space-between align-items-center mx-4 my-2"},Fe={class:"d-flex justify-space-between"},Me={__name:"managmentAdminView",setup(s){const $=n([{title:"نام",key:"firstName"},{title:"نام خانوادگی",key:"lastName"},{title:"شماره همراه",key:"phoneNumber"},{title:"نقش",key:"role"},{title:"اکتیو",key:"isBlocked"},{title:"فعالیت",key:"action"}]),T=n([]),r=n(""),p=n(!1),m=n(!1),N=n(!1),v=n(!1),S=n(!1),h=n(),y=n(!1),V=n(!1),k=n(!1),f=n(""),u=n(!1),b=n(!1),d=n({firstName:"",lastName:"",phoneNumber:"",password:"",role:0}),w=n(""),A=async()=>{try{p.value=!0;const a=await P.AdminList();return T.value=a.data,a}catch(a){f.value=a.response.data.error||"خطایی رخ داده است!",u.value=!0,setTimeout(()=>{u.value=!1},1e4)}finally{p.value=!1}},_=async a=>{try{N.value=!0;const e=await P.AccessPoint(a);return h.value=e.data,e}catch(e){f.value=e.response.data.error||"خطایی رخ داده است!",u.value=!0,setTimeout(()=>{u.value=!1},1e4)}finally{N.value=!1}},j=async()=>{try{v.value=!0;const a=await P.GetPermission();return a.data.data==0?y.value=!1:y.value=!0,k.value=!0,a}catch(a){f.value=a.response.data.error||"خطایی رخ داده است!",u.value=!0,setTimeout(()=>{u.value=!1},1e4)}finally{v.value=!1}},B=async()=>{try{v.value=!0;const a=await P.TradePermission();return h.value=a.data,k.value=!1,a}catch(a){f.value=a.response.data.error||"خطایی رخ داده است!",u.value=!0,setTimeout(()=>{u.value=!1},1e4)}finally{v.value=!1}},G=async a=>{V.value=!0,_(a.id),w.value=a.id},E=async()=>{try{S.value=!0;const a=await P.SubmitAccessPoint(h.value,w.value);return V.value=!1,a}catch(a){f.value=a.response.data.error||"خطایی رخ داده است!",u.value=!0,setTimeout(()=>{u.value=!1},1e4)}finally{S.value=!1}},H=async()=>{try{m.value=!0;const a=await P.AddAdmin(d.value);return b.value=!1,A(),a}catch(a){f.value=a.response.data.error||"خطایی رخ داده است!",u.value=!0,setTimeout(()=>{u.value=!1},1e4)}finally{m.value=!1}},Z=[a=>!!a||"شماره همراه الزامی است",a=>/^09\d{9}$/.test(a)||"شماره معتبر نیست"],I=[a=>!!a||"رمز عبور الزامی است",a=>a&&a.length>=8||"رمز عبور باید حداقل ۸ کاراکتر باشد",a=>/[A-Z]/.test(a)||"رمز عبور باید حداقل یک حرف بزرگ داشته باشد",a=>/[a-z]/.test(a)||"رمز عبور باید حداقل یک حرف کوچک داشته باشد",a=>/[0-9]/.test(a)||"رمز عبور باید حداقل یک عدد داشته باشد",a=>/[^A-Za-z0-9]/.test(a)||"رمز عبور باید حداقل یک کاراکتر خاص (!@#$%^&*) داشته باشد"],D=[a=>!!a||"نام الزامی است"],x=[a=>!!a||"نام خانوادگی الزامی است"];return Ve(()=>{A()}),(a,e)=>(c(),g(W,null,[l(be,null,{default:o(()=>[l(ee,null,{default:o(()=>[l(U,{cols:"12"},{default:o(()=>[l(F,{title:"سطح دسترسی ها"},{text:o(()=>[l(z,{modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=t=>r.value=t),label:"جستجو","prepend-inner-icon":"ri-search-line"},null,8,["modelValue"])]),default:o(()=>[i("div",Ne,[l(C,{onClick:e[0]||(e[0]=t=>b.value=!0),class:"mx-2"},{default:o(()=>e[13]||(e[13]=[K("افزودن کاربر")])),_:1}),l(C,{color:"error",class:"error-btn",loading:v.value,onClick:j},{default:o(()=>e[14]||(e[14]=[K(" دسترسی های مدیریتی ")])),_:1},8,["loading"])]),l(xe,{headers:$.value,items:T.value,search:r.value,loading:p.value},{"item.isBlocked":o(({item:t})=>[t.isBlocked==!0?(c(),q(M,{key:0,size:"small",icon:"ri-close-line",color:"#c9190c"})):t.isBlocked==!1?(c(),q(M,{key:1,size:"small",icon:"ri-check-line",color:"#0b8707"})):J("",!0)]),"item.role":o(({item:t})=>[t.role==!0?(c(),g("span",Se,"مدیر")):t.role==!1?(c(),g("span",Be,"کارشناس")):J("",!0)]),"item.action":o(({item:t})=>[l(M,{class:"me-2",size:"small",icon:"ri-user-settings-line",color:"#d4af37",onClick:R=>G(t)},null,8,["onClick"])]),_:1},8,["headers","items","search","loading"])]),_:1})]),_:1})]),_:1})]),_:1}),l(O,{modelValue:V.value,"onUpdate:modelValue":e[3]||(e[3]=t=>V.value=t),"max-width":"450",class:"dialog"},{default:o(()=>[l(F,{class:"dialog-card"},{default:o(()=>[e[16]||(e[16]=i("div",{class:"k-dialog-title"},[i("p",null,"سطح دسترسی")],-1)),i("div",De,[N.value==!0?(c(),g("div",Le,e[15]||(e[15]=[i("p",null,"لطفا منتظر بمانید ... ",-1)]))):(c(!0),g(W,{key:1},ye(h.value,(t,R)=>(c(),g("div",{class:"d-flex justify-space-between align-items-center mx-4 my-2",key:R},[i("span",null,ae(t.persianName),1),l(se,{modelValue:t.isAccess,"onUpdate:modelValue":L=>t.isAccess=L,color:"#b08c4d"},null,8,["modelValue","onUpdate:modelValue"])]))),128))]),i("div",Ue,[l(C,{text:"انصراف",onClick:e[2]||(e[2]=t=>V.value=!1),size:"large",class:"m-3",variant:"outlined"}),l(C,{text:"ثبت دسترسی",onClick:E,size:"large",class:"m-3",loading:S.value},null,8,["loading"])])]),_:1})]),_:1},8,["modelValue"]),l(O,{modelValue:b.value,"onUpdate:modelValue":e[9]||(e[9]=t=>b.value=t),"max-width":"600",class:"dialog"},{default:o(()=>[l(F,{class:"dialog-card"},{default:o(()=>[e[17]||(e[17]=i("div",{class:"k-dialog-title"},[i("p",null,"افزودن ادمین جدید")],-1)),l(Ce,{ref:"form",onSubmit:ke(H,["prevent"])},{default:o(()=>[l(ee,null,{default:o(()=>[l(U,{cols:"12",md:"6",class:"my-4"},{default:o(()=>[l(z,{modelValue:d.value.firstName,"onUpdate:modelValue":e[4]||(e[4]=t=>d.value.firstName=t),label:"نام",variant:"outlined",rules:D},null,8,["modelValue"])]),_:1}),l(U,{cols:"12",md:"6",class:"my-4"},{default:o(()=>[l(z,{modelValue:d.value.lastName,"onUpdate:modelValue":e[5]||(e[5]=t=>d.value.lastName=t),label:"نام خانوادگی",variant:"outlined",rules:x},null,8,["modelValue"])]),_:1}),l(U,{cols:"12",md:"6",class:"my-4"},{default:o(()=>[l(z,{modelValue:d.value.phoneNumber,"onUpdate:modelValue":e[6]||(e[6]=t=>d.value.phoneNumber=t),label:"شماره همراه",variant:"outlined",rules:Z},null,8,["modelValue"])]),_:1}),l(U,{cols:"12",md:"6",class:"my-4"},{default:o(()=>[l(z,{modelValue:d.value.password,"onUpdate:modelValue":e[7]||(e[7]=t=>d.value.password=t),label:"رمز عبور",variant:"outlined",rules:I},null,8,["modelValue"])]),_:1})]),_:1}),i("div",ze,[l(C,{text:"انصراف",onClick:e[8]||(e[8]=t=>b.value=!1),size:"large",class:"m-3",variant:"outlined"}),l(C,{type:"submit",text:"افزودن",size:"large",class:"m-3",loading:m.value},null,8,["loading"])])]),_:1},512)]),_:1})]),_:1},8,["modelValue"]),l(O,{modelValue:k.value,"onUpdate:modelValue":e[12]||(e[12]=t=>k.value=t),"max-width":"450",class:"dialog"},{default:o(()=>[l(F,{class:"dialog-card"},{default:o(()=>[e[20]||(e[20]=i("div",{class:"k-dialog-title"},[i("p",null,"دسترسی های مدیرتی")],-1)),i("div",Te,[v.value==!0?(c(),g("div",Ie,e[18]||(e[18]=[i("p",null,"لطفا منتظر بمانید ... ",-1)]))):(c(),g("div",Re,[e[19]||(e[19]=i("span",null,"درگاه معاملات",-1)),l(se,{modelValue:y.value,"onUpdate:modelValue":e[10]||(e[10]=t=>y.value=t),color:"#b08c4d",onClick:B,loading:v.value},null,8,["modelValue","loading"])]))]),i("div",Fe,[l(C,{text:"انصراف",onClick:e[11]||(e[11]=t=>k.value=!1),size:"large",class:"m-3",variant:"outlined"})])]),_:1})]),_:1},8,["modelValue"]),u.value?(c(),q(ge,{key:0,color:"error",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:o(()=>[K(ae(f.value),1)]),_:1})):J("",!0)],64))}},Ye=pe(Me,[["__scopeId","data-v-3e50f61c"]]);export{Ye as default};
