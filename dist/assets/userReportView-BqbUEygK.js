import{_ as ne,r as m,j,c as p,a as t,b as l,w as a,a1 as C,e as de,h as ie,F as ue,a0 as E,q as re,o as c,a2 as n,a4 as F,C as T,V as G,t as u,a7 as me}from"./index-COp8Femz.js";import{W as L}from"./wallet-YRnOdXsM.js";import{l as ce}from"./lodash-CrZEPlQY.js";import{V as O}from"./VDialog-CPV2nvMC.js";import{V as pe}from"./VAlert-DtSdAWzj.js";import{a as ve,V as M}from"./VCard-utaOD2US.js";import{V as y}from"./VTextField-ChuTXgnI.js";import{V as q,a as fe}from"./VDataTable-Bh8p0hUN.js";import{V as ye,a as ge}from"./VToolbar-BKGgRqux.js";import{V as Ve}from"./VSpacer-BL7FnAye.js";import{V as _e}from"./VDivider-pD0Bt5iF.js";import{a as S}from"./VSelect-6fH1cGtC.js";import"./api-B7VnIS8G.js";import"./api-Zim9QLc9.js";import"./api-BaT6f1a_.js";import"./dialog-transition-CSvw-sHq.js";import"./index-Ba5kH-P9.js";import"./index-aFCJ0sEf.js";import"./createSimpleFunctional-B0cxyTcr.js";import"./VAvatar-kL8u6qNb.js";import"./VImg-9uvMLLrV.js";import"./VMenu-BJEog3wQ.js";import"./VSelectionControl-Br1aGvX3.js";const be={class:"w-100 d-flex justify-end"},ke={class:"w-100 d-flex justify-end"},xe={class:"text-center pt-2"},Ne={class:"text-center pa-4"},Ce={class:"content"},Te={class:"desc"},Pe={class:"content"},he={class:"desc"},we={class:"content"},Ie={class:"desc"},Ue={class:"content"},De={class:"desc"},We={class:"content"},Fe={class:"desc"},Me={class:"content"},Se={class:"desc"},$e={class:"content"},Be={class:"desc"},He={class:"d-flex align-center"},ze={class:"d-flex align-center"},Re={class:"d-flex align-center"},Ae={class:"d-flex align-center"},je={class:"d-flex align-center"},Ee={class:"d-flex align-center"},Ge={class:"d-flex align-center"},Le={key:0},Oe={key:1},qe={key:2},Je={class:"d-flex align-center"},Ke={key:0},Qe={key:1},Xe={key:2},Ye={key:3},Ze={key:4},el={key:5},ll={class:"d-flex align-center"},tl={key:0},al={key:1},sl={key:2},ol={key:3},nl={key:4},dl={class:"d-flex align-center"},il={class:"d-flex align-center"},ul={class:"d-flex align-center"},rl={class:"d-flex align-center"},ml={class:"d-flex align-center"},cl={__name:"userReportView",setup(pl){const P=m(""),_=m(!1),h=m(!1),w=m(!1),k=m(!1),b=m(50),g=m(1),J=m([5,10,25,50]),I=m(0),$=m(1),U=m(!1),K=m([{title:"نام",key:"firstName"},{title:"نام خانوادگی",key:"lastName"},{title:"شماره موبایل",key:"phoneNumber"},{title:"کد ملی",key:"nationalCode"},{title:"کیف پول (ریال)",key:"wallet.balance"},{title:"صندوق طلا (گرم)",key:"wallet.goldWeight"},{title:"فعالیت",key:"action"}]),Q=m([{title:"تاریخ",key:"date"},{title:"زمان",key:"time"},{title:"وزن طلا(گرم)",key:"goldWeight"},{title:"مبلغ (تومان)",key:"goldPrice"},{title:"وضعیت",key:"status"},{title:"نوع پرداخت",key:"tradeType"},{title:"شماره فاکتور",key:"invoiceId"},{title:"نوع تراکنش",key:"type.title"},{title:"فعالیت",key:"action"}]),x=m(""),B=m(),r=m({firstName:"",lastName:"",phoneNumber:"",nationalCode:"",bankAccounts:[],buys:[],wallet:{balance:"-",blocked:"-",goldWeight:"-"}}),d=m({date:"-",time:"-",totalPrice:"-",goldPrice:"-",goldWeight:"-",invoiceId:"-",originCardPan:"-",paymentMethod:"-",status:"-",tradeType:"-",destCardPan:"-",description:"-",adminId:"-",accounterId:"-",accounterDescription:"-"}),i=m({firstName:"",lastName:"",nationalCode:"",phoneNumber:"",tradeType:1,type:"buy",goldPrice:"",goldWeight:"",admin:"",accounter:"",startDate:"",startTime:"",endDate:"",endTime:"",invoiceId:"",status:""}),X=o=>{g.value=o.page,b.value=o.itemsPerPage,D()},D=async()=>{try{h.value=!0;const o=await L.UserFinance({page:g.value,perPage:b.value,search:x.value});return I.value=o.data.totalItem,B.value=o.data.users,$.value=Math.ceil(I.value/b.value),o}catch(o){o.response.status==401&&(localStorage.clear(),E.replace("/login")),P.value=o.response.data.error||"خطایی رخ داده است!",_.value=!0,setTimeout(()=>{_.value=!1},1e4)}finally{h.value=!1}},W=o=>o.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),Y=async o=>{var e,f,s,V,N,H,z,R,A;try{w.value=!0,k.value=!0;const v=await L.UserFinanceItem(o.id);return r.value.firstName=(e=v.data)==null?void 0:e.firstName,r.value.lastName=(f=v.data)==null?void 0:f.lastName,r.value.nationalCode=(s=v.data)==null?void 0:s.nationalCode,r.value.phoneNumber=(V=v.data)==null?void 0:V.phoneNumber,r.value.bankAccounts=(N=v.data)==null?void 0:N.bankAccounts,r.value.buys=(H=v.data)==null?void 0:H.buys,r.value.wallet.balance=(z=v.data)==null?void 0:z.wallet.balance,r.value.wallet.blocked=(R=v.data)==null?void 0:R.wallet.blocked,r.value.wallet.goldWeight=(A=v.data)==null?void 0:A.wallet.goldWeight,r.value.buys.map(oe=>{console.log(oe.type)}),v}catch(v){v.response.status==401&&(localStorage.clear(),E.replace("/login")),P.value=v.response.data.error||"خطایی رخ داده است!",_.value=!0,setTimeout(()=>{_.value=!1},1e4)}finally{w.value=!1}},Z=async o=>{U.value=!0,d.value.accounterDescription=o.accounterDescription,d.value.accounterId=o.accounterId,d.value.adminId=o.adminId,d.value.date=o.date,d.value.description=o.description,d.value.destCardPan=o.destCardPan,d.value.goldPrice=o.goldPrice,d.value.goldWeight=o.goldWeight,d.value.invoiceId=o.invoiceId,d.value.originCardPan=o.originCardPan,d.value.paymentMethod=o.paymentMethod,d.value.status=o.status,d.value.time=o.time,d.value.totalPrice=o.totalPrice,d.value.tradeType=o.tradeType},ee=()=>{searchFilter.value.phoneNumber=searchFilter.value.phoneNumber.replace(/\D/g,"").slice(0,11)},le=async o=>{console.log(o)},te=[o=>!!o||"شماره همراه نمی‌تواند خالی باشد",o=>/^\d{11}$/.test(o)||"شماره همراه باید 11 رقم باشد",o=>o.startsWith("09")||"شماره همراه باید با 09 شروع شود"],ae=[o=>!!o||"کد ملی الزامی است",o=>/^\d{10}$/.test(o)||"کد ملی باید ۱۰ رقم باشد",o=>{if(!/^\d{10}$/.test(o))return!0;const e=+o[9],f=o.split("").slice(0,9).reduce((s,V,N)=>s+ +V*(10-N),0)%11;return f<2&&e===f||f>=2&&e+f===11||"کد ملی نامعتبر است"}],se=[o=>!!o,o=>/^\d+(\.\d{1,3})?$/.test(o)];return j([g,b],()=>{D()}),j(x,ce.debounce(()=>{D()},1e3)),(o,e)=>{const f=re("persian-date-picker");return c(),p(ue,null,[t("div",null,[l(C,null,{default:a(()=>[l(n,{cols:"12"},{default:a(()=>[l(ve,null,{default:a(()=>[l(C,{class:"filter my-3"},{default:a(()=>[l(n,{cols:"6",md:"3"},{default:a(()=>[l(f,{modelValue:i.value.fromDate,"onUpdate:modelValue":e[0]||(e[0]=s=>i.value.fromDate=s),placeholder:"از تاریخ"},null,8,["modelValue"])]),_:1}),l(n,{cols:"6",md:"3"},{default:a(()=>[l(f,{type:"time",modelValue:i.value.fromTime,"onUpdate:modelValue":e[1]||(e[1]=s=>i.value.fromTime=s),placeholder:"از زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(n,{cols:"6",md:"3"},{default:a(()=>[l(f,{modelValue:i.value.toDate,"onUpdate:modelValue":e[2]||(e[2]=s=>i.value.toDate=s),placeholder:"تا تاریخ"},null,8,["modelValue"])]),_:1}),l(n,{cols:"6",md:"3"},{default:a(()=>[l(f,{type:"time",modelValue:i.value.toTime,"onUpdate:modelValue":e[3]||(e[3]=s=>i.value.toTime=s),placeholder:"تا زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(n,{cols:"6",md:"3"},{default:a(()=>[l(y,{modelValue:i.value.firstName,"onUpdate:modelValue":e[4]||(e[4]=s=>i.value.firstName=s),label:"نام",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(n,{cols:"6",md:"3"},{default:a(()=>[l(y,{modelValue:i.value.lastName,"onUpdate:modelValue":e[5]||(e[5]=s=>i.value.lastName=s),label:"نام خانوادگی",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(n,{cols:"6",md:"3"},{default:a(()=>[l(y,{modelValue:i.value.phoneNumber,"onUpdate:modelValue":e[6]||(e[6]=s=>i.value.phoneNumber=s),label:"شماره موبایل",density:"compact",variant:"outlined",rules:te,onInput:ee},null,8,["modelValue"])]),_:1}),l(n,{cols:"6",md:"3"},{default:a(()=>[l(y,{modelValue:i.value.nationalCode,"onUpdate:modelValue":e[7]||(e[7]=s=>i.value.nationalCode=s),label:"کد ملی",density:"compact",variant:"outlined",rules:ae},null,8,["modelValue"])]),_:1}),l(n,{cols:"6",md:"3"},{default:a(()=>[l(y,{modelValue:i.value.goldPrice,"onUpdate:modelValue":e[8]||(e[8]=s=>i.value.goldPrice=s),label:"قیمت طلا",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(n,{cols:"6",md:"3"},{default:a(()=>[l(y,{modelValue:i.value.goldWeight,"onUpdate:modelValue":e[9]||(e[9]=s=>i.value.goldWeight=s),label:"وزن طلا",density:"compact",variant:"outlined",rules:se},null,8,["modelValue"])]),_:1}),l(n,{cols:"6",md:"3"},{default:a(()=>[l(y,{modelValue:i.value.admin,"onUpdate:modelValue":e[10]||(e[10]=s=>i.value.admin=s),label:"ادمین",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(n,{cols:"6",md:"3"},{default:a(()=>[l(y,{modelValue:i.value.accounter,"onUpdate:modelValue":e[11]||(e[11]=s=>i.value.accounter=s),label:"حسابدار",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(n,{md:"6",class:"d-none d-md-flex"}),l(n,{cols:"12",md:"3"},{default:a(()=>[t("div",be,[l(F,{"prepend-icon":"ri-loop-left-line",variant:"tonal",block:"",onClick:e[12]||(e[12]=s=>le("pending"))},{default:a(()=>e[18]||(e[18]=[T("به روز رسانی")])),_:1})])]),_:1}),l(n,{cols:"12",md:"3"},{default:a(()=>[t("div",ke,[l(F,{"prepend-icon":"ri-file-excel-line",block:""},{default:a(()=>e[19]||(e[19]=[T("خروجی اکسل")])),_:1})])]),_:1})]),_:1}),l(M,{title:"اطلاعات مالی کاربران"},{text:a(()=>[e[20]||(e[20]=t("ul",{class:"listGuide"},[t("li",null," در این صفحه می‌توان تمامی فعالیت‌های مالی کاربر و موجودی‌ها را مشاهده و بررسی کرد. ")],-1)),l(y,{modelValue:x.value,"onUpdate:modelValue":e[13]||(e[13]=s=>x.value=s),label:"جستجو","prepend-inner-icon":"ri-search-line"},null,8,["modelValue"])]),default:a(()=>[l(q,{page:g.value,"items-per-page":b.value,headers:K.value,items:B.value,loading:h.value,"server-items-length":I.value,"items-per-page-options":J.value,"onUpdate:options":X},{"item.action":a(({item:s})=>[l(G,{class:"me-2",size:"small",icon:"ri-information-line",color:"#d4af37",onClick:V=>Y(s)},null,8,["onClick"])]),"item.balance":a(({item:s})=>[t("p",null,u(W(s.balance)),1)]),bottom:a(()=>[t("div",xe,[l(fe,{modelValue:g.value,"onUpdate:modelValue":e[14]||(e[14]=s=>g.value=s),length:$.value,"total-visible":4},null,8,["modelValue","length"])])]),_:1},8,["page","items-per-page","headers","items","loading","server-items-length","items-per-page-options"])]),_:1})]),_:1})]),_:1})]),_:1}),t("template",null,[t("div",Ne,[l(O,{modelValue:k.value,"onUpdate:modelValue":e[16]||(e[16]=s=>k.value=s),transition:"dialog-bottom-transition",fullscreen:""},{default:a(()=>[l(M,null,{default:a(()=>[l(ye,{class:"px-7"},{default:a(()=>[l(ge,null,{default:a(()=>[T(" تراکنش های مالی "+u(r.value.firstName)+" "+u(r.value.lastName),1)]),_:1}),l(Ve),l(F,{icon:"ri-close-large-line",color:"#000",onClick:e[15]||(e[15]=s=>k.value=!1)})]),_:1}),l(me,null,{default:a(()=>[l(C,{class:"wallet-info-box"},{default:a(()=>[l(n,{cols:"6",md:"3",class:"my-3"},{default:a(()=>[t("div",Ce,[e[21]||(e[21]=t("p",{class:"title"},"نام: ",-1)),t("p",Te,u(r.value.firstName),1)])]),_:1}),l(n,{cols:"6",md:"3",class:"my-3"},{default:a(()=>[t("div",Pe,[e[22]||(e[22]=t("p",{class:"title"},"نام خانوادگی: ",-1)),t("p",he,u(r.value.lastName),1)])]),_:1}),l(n,{cols:"6",md:"3",class:"my-3"},{default:a(()=>[t("div",we,[e[23]||(e[23]=t("p",{class:"title"},"شماره موبایل: ",-1)),t("p",Ie,u(r.value.phoneNumber),1)])]),_:1}),l(n,{cols:"6",md:"3",class:"my-3"},{default:a(()=>[t("div",Ue,[e[24]||(e[24]=t("p",{class:"title"},"کدملی: ",-1)),t("p",De,u(r.value.nationalCode),1)])]),_:1}),l(n,{cols:"6",md:"3",class:"my-3"},{default:a(()=>[t("div",We,[e[25]||(e[25]=t("p",{class:"title"},"موجودی صندوق طلا: ",-1)),t("p",Fe,u(r.value.wallet.goldWeight)+" گرم",1)])]),_:1}),l(n,{cols:"6",md:"3",class:"my-3"},{default:a(()=>[t("div",Me,[e[26]||(e[26]=t("p",{class:"title"},"موجودی کیف پول: ",-1)),t("p",Se,u(W(r.value.wallet.balance))+" تومان",1)])]),_:1}),l(n,{cols:"6",md:"3",class:"my-3"},{default:a(()=>[t("div",$e,[e[27]||(e[27]=t("p",{class:"title red"},"در انتظار برداشت: ",-1)),t("p",Be,u(W(r.value.wallet.blocked))+" تومان",1)])]),_:1}),l(_e,{class:"my-10"}),l(n,{cols:"12",class:"my-2"},{default:a(()=>[l(q,{headers:Q.value,items:r.value.buys,loading:w.value},{"item.status":a(({item:s})=>[t("div",null,[l(S,{text:s.status=="completed"?"موفق":s.status=="pending"?"در انتظار":"ناموفق",color:s.status=="completed"?"#00853f":s.status=="pending"?"#666666":"#ff0000",size:"small"},null,8,["text","color"])])]),"item.tradeType":a(({item:s})=>[t("div",null,[l(S,{text:s.tradeType=="0"?"آنلاین":s.tradeType=="1"?"تلفنی":s.tradeType=="2"?"حضوری":s.tradeType=="3"?"حواله":s.tradeType=="4"?"تبدیل حضوری":"نامشخص",color:"#666666",size:"small"},null,8,["text"])])]),"item.type.title":a(({item:s})=>[t("div",null,[l(S,{text:s.type.title=="sell"?"فروش":"خرید",color:"#666666",size:"small"},null,8,["text"])])]),"item.action":a(({item:s})=>[l(G,{class:"me-2",size:"small",icon:"ri-info-i",color:"#d4af37",onClick:V=>Z(s)},null,8,["onClick"])]),_:1},8,["headers","items","loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_.value?(c(),de(pe,{key:0,color:"error",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:a(()=>[T(u(P.value),1)]),_:1})):ie("",!0)]),l(O,{"max-width":"500",modelValue:U.value,"onUpdate:modelValue":e[17]||(e[17]=s=>U.value=s)},{default:a(()=>[l(M,{class:"trade-modal"},{default:a(()=>[e[42]||(e[42]=t("div",{class:"modal-title"},[t("h3",{class:"my-4"},"جزئیات تراکنش")],-1)),l(C,{class:"px-3"},{default:a(()=>[l(n,{cols:"6",class:"my-1 pa-1"},{default:a(()=>[t("div",He,[e[28]||(e[28]=t("p",null,"تاریخ : ",-1)),t("p",null,u(d.value.date),1)])]),_:1}),l(n,{cols:"6",class:"my-1 pa-1"},{default:a(()=>[t("div",ze,[e[29]||(e[29]=t("p",null,"زمان : ",-1)),t("p",null,u(d.value.time),1)])]),_:1}),l(n,{cols:"6",class:"my-1 pa-1"},{default:a(()=>[t("div",Re,[e[30]||(e[30]=t("p",null,"قیمت لحظه ای طلا : ",-1)),t("p",null,u(d.value.goldPrice),1)])]),_:1}),l(n,{cols:"6",class:"my-1 pa-1"},{default:a(()=>[t("div",Ae,[e[31]||(e[31]=t("p",null,"وزن طلا : ",-1)),t("p",null,u(d.value.goldWeight),1)])]),_:1}),l(n,{cols:"6",class:"my-1 pa-1"},{default:a(()=>[t("div",je,[e[32]||(e[32]=t("p",null,"قیمت کل : ",-1)),t("p",null,u(d.value.totalPrice),1)])]),_:1}),l(n,{cols:"6",class:"my-1 pa-1"},{default:a(()=>[t("div",Ee,[e[33]||(e[33]=t("p",null,"شماره فاکتور : ",-1)),t("p",null,u(d.value.invoiceId),1)])]),_:1}),l(n,{cols:"6",class:"my-1 pa-1"},{default:a(()=>[t("div",Ge,[e[34]||(e[34]=t("p",null,"وضعیت فاکتور : ",-1)),d.value.status=="completed"?(c(),p("p",Le,"موفق")):d.value.status=="pending"?(c(),p("p",Oe,"در انتظار")):(c(),p("p",qe,"ناموفق"))])]),_:1}),l(n,{cols:"6",class:"my-1 pa-1"},{default:a(()=>[t("div",Je,[e[35]||(e[35]=t("p",null,"نوع معامله : ",-1)),d.value.tradeType==0?(c(),p("p",Ke,"آنلاین")):d.value.tradeType==1?(c(),p("p",Qe,"تلفنی")):d.value.tradeType==2?(c(),p("p",Xe,"حضوری")):d.value.tradeType==3?(c(),p("p",Ye,"حواله")):d.value.tradeType==4?(c(),p("p",Ze,"تبدیل حضوری")):(c(),p("p",el,"ناموفق"))])]),_:1}),l(n,{cols:"6",class:"my-1 pa-1"},{default:a(()=>[t("div",ll,[e[36]||(e[36]=t("p",null,"نوع پرداخت : ",-1)),d.value.paymentMethod==0?(c(),p("p",tl,"درگاه")):d.value.paymentMethod==1?(c(),p("p",al,"کارت به کارت")):d.value.paymentMethod==2?(c(),p("p",sl,"کارتخوان")):d.value.paymentMethod==3?(c(),p("p",ol,"پول نقد")):(c(),p("p",nl," - "))])]),_:1}),l(n,{cols:"6",class:"my-1 pa-1"},{default:a(()=>[t("div",dl,[e[37]||(e[37]=t("p",null,"ادمین : ",-1)),t("p",null,u(d.value.adminId),1)])]),_:1}),l(n,{cols:"6",class:"my-1 pa-1"},{default:a(()=>[t("div",il,[e[38]||(e[38]=t("p",null,"حسابدار : ",-1)),t("p",null,u(d.value.accounterId),1)])]),_:1}),l(n,{cols:"12",class:"my-1 pa-1"},{default:a(()=>[t("div",ul,[e[39]||(e[39]=t("p",null,"شماره کارت مبدا : ",-1)),t("p",null,u(d.value.originCardPan),1)])]),_:1}),l(n,{cols:"12",class:"my-1 pa-1"},{default:a(()=>[t("div",rl,[e[40]||(e[40]=t("p",null,"شماره کارت مقصد : ",-1)),t("p",null,u(d.value.destCardPan),1)])]),_:1}),l(n,{cols:"12",class:"my-1 pa-1"},{default:a(()=>[t("div",ml,[e[41]||(e[41]=t("p",null,"توضیحات حسابدار : ",-1)),t("p",null,u(d.value.accounterDescription),1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},Bl=ne(cl,[["__scopeId","data-v-993595c5"]]);export{Bl as default};
