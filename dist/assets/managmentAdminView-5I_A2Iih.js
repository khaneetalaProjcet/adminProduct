import{D as ne,H as ie,I as X,as as re,r as n,at as ue,A as Y,K as de,M as ce,au as me,b as l,L as ee,F as Q,ap as ve,V as $,av as fe,aw as pe,_ as ge,k as Ve,c as V,w as o,af as ye,ac as K,e as O,h as W,a6 as h,o as c,a7 as ae,a8 as T,a as i,aa as C,C as J,ae as ke,a9 as be,t as le}from"./index-C9yqJSFV.js";import{M as P}from"./managment-F215KLlA.js";import{V as we}from"./VAlert-D4fT7Mn_.js";import{V as F}from"./VCard-BJQPcNNo.js";import{m as Ae,u as xe,a as te,V as U}from"./VTextField-FfkoJG28.js";import{V as Ce}from"./VDataTable-CWf0on0g.js";import{V as Se}from"./VForm-CCJG3Uv2.js";import{b as _e}from"./VAvatar-mGsasfoH.js";import{m as he,b as se}from"./VSelect-V6tcFLf1.js";import"./api-TeNC-Exm.js";import"./createSimpleFunctional-BHOJu7FA.js";import"./VImg-_speSVzn.js";import"./VMenu-LpBFxmRx.js";const Pe=ne({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...Ae(),...he()},"VSwitch"),oe=ie()({name:"VSwitch",inheritAttrs:!1,props:Pe(),emits:{"update:focused":s=>!0,"update:modelValue":s=>!0,"update:indeterminate":s=>!0},setup(s,j){let{attrs:I,slots:u}=j;const p=X(s,"indeterminate"),m=X(s,"modelValue"),{loaderClasses:N}=re(s),{isFocused:v,focus:B,blur:S}=xe(s),y=n(),g=ue&&window.matchMedia("(forced-colors: active)").matches,k=Y(()=>typeof s.loading=="string"&&s.loading!==""?s.loading:s.color),f=de(),r=Y(()=>s.id||`switch-${f}`);function b(){p.value&&(p.value=!1)}function d(w){var A,_;w.stopPropagation(),w.preventDefault(),(_=(A=y.value)==null?void 0:A.input)==null||_.click()}return ce(()=>{const[w,A]=me(I),_=te.filterProps(s),E=se.filterProps(s);return l(te,ee({class:["v-switch",{"v-switch--flat":s.flat},{"v-switch--inset":s.inset},{"v-switch--indeterminate":p.value},N.value,s.class]},w,_,{modelValue:m.value,"onUpdate:modelValue":L=>m.value=L,id:r.value,focused:v.value,style:s.style}),{...u,default:L=>{let{id:G,messagesId:H,isDisabled:Z,isReadonly:q,isValid:M}=L;const D={model:m,isValid:M};return l(se,ee({ref:y},E,{modelValue:m.value,"onUpdate:modelValue":[x=>m.value=x,b],id:G.value,"aria-describedby":H.value,type:"checkbox","aria-checked":p.value?"mixed":void 0,disabled:Z.value,readonly:q.value,onFocus:B,onBlur:S},A),{...u,default:x=>{let{backgroundColorClasses:e,backgroundColorStyles:a}=x;return l("div",{class:["v-switch__track",g?void 0:e.value],style:a.value,onClick:d},[u["track-true"]&&l("div",{key:"prepend",class:"v-switch__track-true"},[u["track-true"](D)]),u["track-false"]&&l("div",{key:"append",class:"v-switch__track-false"},[u["track-false"](D)])])},input:x=>{let{inputNode:e,icon:a,backgroundColorClasses:t,backgroundColorStyles:R}=x;return l(Q,null,[e,l("div",{class:["v-switch__thumb",{"v-switch__thumb--filled":a||s.loading},s.inset||g?void 0:t.value],style:s.inset?void 0:R.value},[u.thumb?l(ve,{defaults:{VIcon:{icon:a,size:"x-small"}}},{default:()=>[u.thumb({...D,icon:a})]}):l(_e,null,{default:()=>[s.loading?l(fe,{name:"v-switch",active:!0,color:M.value===!1?void 0:k.value},{default:z=>u.loader?u.loader(z):l(pe,{active:z.isActive,color:z.color,indeterminate:!0,size:"16",width:"2"},null)}):a&&l($,{key:String(a),icon:a,size:"x-small"},null)]})])])}})}})}),{}}}),Ne={class:"px-5 py-3 d-flex justify-end"},Be={key:0,class:"table-green"},Le={key:1,class:"table-red"},De={class:"d-flex flex-column w-100 h-100 my-2"},ze={key:0,class:"dialog-loading"},Te={class:"d-flex justify-space-between"},Ue={class:"d-flex justify-space-between"},Ie={class:"d-flex flex-column w-100 h-100 my-2"},Me={key:0,class:"dialog-access-loading"},Re={key:1,class:"d-flex justify-space-between align-items-center mx-4 my-2"},Fe={class:"d-flex justify-space-between"},$e={__name:"managmentAdminView",setup(s){const j=n([{title:"نام",key:"firstName"},{title:"نام خانوادگی",key:"lastName"},{title:"شماره همراه",key:"phoneNumber"},{title:"نقش",key:"role"},{title:"اکتیو",key:"isBlocked"},{title:"فعالیت",key:"action"}]),I=n([]),u=n(""),p=n(!1),m=n(!1),N=n(!1),v=n(!1),B=n(!1),S=n(),y=n(!1),g=n(!1),k=n(!1),f=n(""),r=n(!1),b=n(!1),d=n({firstName:"",lastName:"",phoneNumber:"",password:"",role:0}),w=n(""),A=async()=>{try{p.value=!0;const e=await P.AdminList();return I.value=e.data,e}catch(e){e.response.status==401&&(localStorage.clear(),h.replace("/login")),f.value=e.response.data.error||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{p.value=!1}},_=async e=>{try{N.value=!0;const a=await P.AccessPoint(e);return S.value=a.data,a}catch(a){a.response.status==401&&(localStorage.clear(),h.replace("/login")),f.value=a.response.data.error||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{N.value=!1}},E=async()=>{try{v.value=!0;const e=await P.GetPermission();return e.data==0?y.value=!1:y.value=!0,k.value=!0,e}catch(e){e.response.status==401&&(localStorage.clear(),h.replace("/login")),f.value=e.response.data.error||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{v.value=!1}},L=async()=>{try{v.value=!0;const e=await P.TradePermission();return S.value=e.data,k.value=!1,e}catch(e){e.response.status==401&&(localStorage.clear(),h.replace("/login")),f.value=e.response.data.error||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{v.value=!1}},G=async e=>{g.value=!0,_(e.id),w.value=e.id},H=async()=>{try{B.value=!0;const e=await P.SubmitAccessPoint(S.value,w.value);return g.value=!1,e}catch(e){e.response.status==401&&(localStorage.clear(),h.replace("/login")),f.value=e.response.data.error||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{B.value=!1}},Z=async()=>{try{m.value=!0;const e=await P.AddAdmin(d.value);return b.value=!1,A(),e}catch(e){e.response.status==401&&(localStorage.clear(),h.replace("/login")),f.value=e.response.data.error||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{m.value=!1}},q=[e=>!!e||"شماره همراه الزامی است",e=>/^09\d{9}$/.test(e)||"شماره معتبر نیست"],M=[e=>!!e||"رمز عبور الزامی است",e=>e&&e.length>=8||"رمز عبور باید حداقل ۸ کاراکتر باشد",e=>/[A-Z]/.test(e)||"رمز عبور باید حداقل یک حرف بزرگ داشته باشد",e=>/[a-z]/.test(e)||"رمز عبور باید حداقل یک حرف کوچک داشته باشد",e=>/[0-9]/.test(e)||"رمز عبور باید حداقل یک عدد داشته باشد",e=>/[^A-Za-z0-9]/.test(e)||"رمز عبور باید حداقل یک کاراکتر خاص (!@#$%^&*) داشته باشد"],D=[e=>!!e||"نام الزامی است"],x=[e=>!!e||"نام خانوادگی الزامی است"];return Ve(()=>{A()}),(e,a)=>(c(),V(Q,null,[l(ye,null,{default:o(()=>[l(ae,null,{default:o(()=>[l(T,{cols:"12"},{default:o(()=>[l(F,{title:"سطح دسترسی ها"},{text:o(()=>[l(U,{modelValue:u.value,"onUpdate:modelValue":a[1]||(a[1]=t=>u.value=t),label:"جستجو","prepend-inner-icon":"ri-search-line"},null,8,["modelValue"])]),default:o(()=>[i("div",Ne,[l(C,{onClick:a[0]||(a[0]=t=>b.value=!0),class:"mx-2"},{default:o(()=>a[13]||(a[13]=[J("افزودن کاربر")])),_:1}),l(C,{color:"error",class:"error-btn",loading:v.value,onClick:E},{default:o(()=>a[14]||(a[14]=[J(" دسترسی های مدیریتی ")])),_:1},8,["loading"])]),l(Ce,{headers:j.value,items:I.value,search:u.value,loading:p.value},{"item.isBlocked":o(({item:t})=>[t.isBlocked==!0?(c(),O($,{key:0,size:"small",icon:"ri-close-line",color:"#c9190c"})):t.isBlocked==!1?(c(),O($,{key:1,size:"small",icon:"ri-check-line",color:"#0b8707"})):W("",!0)]),"item.role":o(({item:t})=>[t.role==!0?(c(),V("span",Be,"مدیر")):t.role==!1?(c(),V("span",Le,"کارشناس")):W("",!0)]),"item.action":o(({item:t})=>[l($,{class:"me-2",size:"small",icon:"ri-user-settings-line",color:"#d4af37",onClick:R=>G(t)},null,8,["onClick"])]),_:1},8,["headers","items","search","loading"])]),_:1})]),_:1})]),_:1})]),_:1}),l(K,{modelValue:g.value,"onUpdate:modelValue":a[3]||(a[3]=t=>g.value=t),"max-width":"450",class:"dialog"},{default:o(()=>[l(F,{class:"dialog-card"},{default:o(()=>[a[16]||(a[16]=i("div",{class:"k-dialog-title"},[i("p",null,"سطح دسترسی")],-1)),i("div",De,[N.value==!0?(c(),V("div",ze,a[15]||(a[15]=[i("p",null,"لطفا منتظر بمانید ... ",-1)]))):(c(!0),V(Q,{key:1},ke(S.value,(t,R)=>(c(),V("div",{class:"d-flex justify-space-between align-items-center mx-4 my-2",key:R},[i("span",null,le(t.persianName),1),l(oe,{modelValue:t.isAccess,"onUpdate:modelValue":z=>t.isAccess=z,color:"#b08c4d"},null,8,["modelValue","onUpdate:modelValue"])]))),128))]),i("div",Te,[l(C,{text:"انصراف",onClick:a[2]||(a[2]=t=>g.value=!1),size:"large",class:"m-3",variant:"outlined"}),l(C,{text:"ثبت دسترسی",onClick:H,size:"large",class:"m-3",loading:B.value},null,8,["loading"])])]),_:1})]),_:1},8,["modelValue"]),l(K,{modelValue:b.value,"onUpdate:modelValue":a[9]||(a[9]=t=>b.value=t),"max-width":"600",class:"dialog"},{default:o(()=>[l(F,{class:"dialog-card"},{default:o(()=>[a[17]||(a[17]=i("div",{class:"k-dialog-title"},[i("p",null,"افزودن ادمین جدید")],-1)),l(Se,{ref:"form",onSubmit:be(Z,["prevent"])},{default:o(()=>[l(ae,null,{default:o(()=>[l(T,{cols:"12",md:"6",class:"my-4"},{default:o(()=>[l(U,{modelValue:d.value.firstName,"onUpdate:modelValue":a[4]||(a[4]=t=>d.value.firstName=t),label:"نام",variant:"outlined",rules:D},null,8,["modelValue"])]),_:1}),l(T,{cols:"12",md:"6",class:"my-4"},{default:o(()=>[l(U,{modelValue:d.value.lastName,"onUpdate:modelValue":a[5]||(a[5]=t=>d.value.lastName=t),label:"نام خانوادگی",variant:"outlined",rules:x},null,8,["modelValue"])]),_:1}),l(T,{cols:"12",md:"6",class:"my-4"},{default:o(()=>[l(U,{modelValue:d.value.phoneNumber,"onUpdate:modelValue":a[6]||(a[6]=t=>d.value.phoneNumber=t),label:"شماره همراه",variant:"outlined",rules:q},null,8,["modelValue"])]),_:1}),l(T,{cols:"12",md:"6",class:"my-4"},{default:o(()=>[l(U,{modelValue:d.value.password,"onUpdate:modelValue":a[7]||(a[7]=t=>d.value.password=t),label:"رمز عبور",variant:"outlined",rules:M},null,8,["modelValue"])]),_:1})]),_:1}),i("div",Ue,[l(C,{text:"انصراف",onClick:a[8]||(a[8]=t=>b.value=!1),size:"large",class:"m-3",variant:"outlined"}),l(C,{type:"submit",text:"افزودن",size:"large",class:"m-3",loading:m.value},null,8,["loading"])])]),_:1},512)]),_:1})]),_:1},8,["modelValue"]),l(K,{modelValue:k.value,"onUpdate:modelValue":a[12]||(a[12]=t=>k.value=t),"max-width":"450",class:"dialog"},{default:o(()=>[l(F,{class:"dialog-card"},{default:o(()=>[a[20]||(a[20]=i("div",{class:"k-dialog-title"},[i("p",null,"دسترسی های مدیرتی")],-1)),i("div",Ie,[v.value==!0?(c(),V("div",Me,a[18]||(a[18]=[i("p",null,"لطفا منتظر بمانید ... ",-1)]))):(c(),V("div",Re,[a[19]||(a[19]=i("span",null,"درگاه معاملات",-1)),l(oe,{modelValue:y.value,"onUpdate:modelValue":a[10]||(a[10]=t=>y.value=t),color:"#b08c4d",onClick:L,loading:v.value},null,8,["modelValue","loading"])]))]),i("div",Fe,[l(C,{text:"انصراف",onClick:a[11]||(a[11]=t=>k.value=!1),size:"large",class:"m-3",variant:"outlined"})])]),_:1})]),_:1},8,["modelValue"]),r.value?(c(),O(we,{key:0,color:"error",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:o(()=>[J(le(f.value),1)]),_:1})):W("",!0)],64))}},ea=ge($e,[["__scopeId","data-v-5ccf3078"]]);export{ea as default};
