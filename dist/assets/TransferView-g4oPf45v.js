import{_ as z,r,c as A,a as e,b as a,w as t,a1 as p,e as c,h as g,F as P,o as m,a2 as o,a4 as b,C as V,t as d,bP as k}from"./index-DF93Nzvp.js";import{W as C}from"./wallet-DIcM18Mj.js";import{V as Q}from"./VDialog-BCTub0bV.js";import{V as j}from"./VAlert-C0QUlPrn.js";import{V as D}from"./VCard--Y2usBvo.js";import{V as B}from"./VTextField-CXmmLowC.js";import{V as R}from"./VOtpInput-C1_yB82R.js";import{V as U}from"./VDivider-C5qminVQ.js";import"./api-ovRPbq6Z.js";import"./api-BRWFBsB6.js";import"./dialog-transition-DBit8UVm.js";import"./index-DeOiSdPS.js";import"./index-CYE23lj9.js";import"./createSimpleFunctional-B744msb8.js";import"./VAvatar-Deh8dhBo.js";import"./VImg-CaGVLfSf.js";const G={class:"d-flex align-center"},H={class:"d-flex align-center"},J={class:"d-flex align-center"},K={class:"d-flex align-center"},X={class:"d-flex align-center"},Y={class:"d-flex align-center"},Z={class:"d-flex justify-center"},$={class:"d-flex justify-end"},h={class:"transferModal-content py-5"},ee={class:"d-flex align-center"},le={class:"d-flex align-center"},ae={class:"d-flex align-center"},te={class:"d-flex align-center"},se={class:"d-flex align-center"},oe={class:"d-flex align-center"},ne={class:"d-flex align-center"},de={class:"d-flex align-center"},re={class:"d-flex align-center"},ue={class:"d-flex align-center"},ie={class:"d-flex align-center"},fe={class:"d-flex justify-space-around mt-2 mb-7"},ve={__name:"TransferView",setup(me){const y=r(""),f=r(!1),x=r(!1),I=r(!1),W=r(!1),O=r(!1),N=r(!1),S=r(""),T=r(!1),i=r({reciever:"",sender:"",goldWeight:""}),u=r({firstName:"",lastName:"",nationalCode:"",phoneNumber:"",goldWeight:"",goldBlock:""}),n=r({id:"",time:"",date:"",goldWeight:"",invoiceId:"",reciever:{firstName:"",lastName:"",nationalCode:""},sender:{firstName:"",lastName:"",nationalCode:"",goldWeight:""}}),w=r(),_=r(!1),L=r(!1),M=async()=>{try{L.value=!0;const s=await C.QuiryWallet(i.value.sender);return u.value.firstName=s.data.firstName,u.value.lastName=s.data.lastName,u.value.nationalCode=s.data.nationalCode,u.value.goldBlock=s.data.goldBlock,u.value.phoneNumber=s.data.phoneNumber,u.value.goldWeight=s.data.goldWeight,_.value=!0,s}catch(s){s.response.status==401&&(localStorage.clear(),k.replace("/login")),y.value=s.response.data.error||"خطایی رخ داده است!",f.value=!0,setTimeout(()=>{f.value=!1},1e4)}finally{L.value=!1}},E=async()=>{try{I.value=!0;const s=await C.CreateTransfer(i.value);return N.value=!0,n.value=s.data,n.value.id=s.data.id,n.value.invoiceId=s.data.invoiceId,n.value.date=s.data.date,n.value.time=s.data.time,n.value.sender.firstName=s.data.sender.firstName,n.value.sender.lastName=s.data.sender.lastName,n.value.sender.nationalCode=s.data.sender.nationalCode,n.value.sender.goldWeight=s.data.sender.wallet.goldWeight,n.value.reciever.firstName=s.data.reciever.firstName,n.value.reciever.lastName=s.data.reciever.lastName,n.value.reciever.nationalCode=s.data.reciever.nationalCode,s}catch(s){s.response.status==401&&(localStorage.clear(),k.replace("/Login")),y.value=s.response.data.msg||"خطایی رخ داده است!",f.value=!0,setTimeout(()=>{f.value=!1},5e3)}finally{I.value=!1}},F=async()=>{try{W.value=!0;const s=await C.TransferOtp(n.value.id);return N.value=!1,x.value=!0,s}catch(s){s.response.status==401&&(localStorage.clear(),k.replace("/Login")),y.value=s.response.data.msg||"خطایی رخ داده است!",f.value=!0,setTimeout(()=>{f.value=!1},5e3)}finally{W.value=!1}},q=async()=>{try{O.value=!0;const s=await C.VerifyTransferOtp(w.value,n.value.id);return x.value=!1,_.value=!1,i.value.sender=null,i.value.reciever=null,i.value.goldWeight=null,S.value=s.msg,T.value=!0,setTimeout(()=>{T.value=!1},5e3),s}catch(s){s.response.status==401&&(localStorage.clear(),k.replace("/Login")),y.value=s.response.data.msg||"خطایی رخ داده است!",f.value=!0,setTimeout(()=>{f.value=!1},5e3)}finally{O.value=!1}};return(s,l)=>(m(),A(P,null,[e("div",null,[a(p,null,{default:t(()=>[a(o,{cols:"12"},{default:t(()=>[a(D,{title:"انتقال طلا",class:"transfer-card"},{default:t(()=>[a(p,null,{default:t(()=>[a(o,{class:"d-none d-md-flex",md:"2"}),a(o,{cols:"12",md:"4"},{default:t(()=>[a(B,{modelValue:i.value.sender,"onUpdate:modelValue":l[0]||(l[0]=v=>i.value.sender=v),label:"کد ملی انتقال دهنده",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(o,{cols:"12",md:"4"},{default:t(()=>[a(b,{block:"",color:"#d4af37",size:"large",onClick:M},{default:t(()=>l[5]||(l[5]=[V("استعلام موجودی")])),_:1})]),_:1}),a(o,{class:"d-none d-md-flex",md:"2"})]),_:1}),_.value?(m(),c(p,{key:0},{default:t(()=>[a(o,{cols:"6",md:"3"},{default:t(()=>[e("div",G,[l[6]||(l[6]=e("p",null,"نام : ",-1)),e("p",null,d(u.value.firstName),1)])]),_:1}),a(o,{cols:"6",md:"3"},{default:t(()=>[e("div",H,[l[7]||(l[7]=e("p",null,"نام خانوادگی : ",-1)),e("p",null,d(u.value.lastName),1)])]),_:1}),a(o,{cols:"6",md:"3"},{default:t(()=>[e("div",J,[l[8]||(l[8]=e("p",null,"شماره همراه : ",-1)),e("p",null,d(u.value.phoneNumber),1)])]),_:1}),a(o,{cols:"6",md:"3"},{default:t(()=>[e("div",K,[l[9]||(l[9]=e("p",null,"کد ملی : ",-1)),e("p",null,d(u.value.nationalCode),1)])]),_:1}),a(o,{cols:"6",md:"3"},{default:t(()=>[e("div",X,[l[10]||(l[10]=e("p",null,"موجودی طلا : ",-1)),e("p",null,d(u.value.goldWeight),1)])]),_:1}),a(o,{cols:"6",md:"3"},{default:t(()=>[e("div",Y,[l[11]||(l[11]=e("p",null,"در صف انتقال : ",-1)),e("p",null,d(u.value.goldBlock),1)])]),_:1})]),_:1})):g("",!0),_.value?(m(),c(p,{key:1},{default:t(()=>[a(o,{class:"d-none d-md-flex",md:"2"}),a(o,{cols:"12",md:"4"},{default:t(()=>[a(B,{modelValue:i.value.reciever,"onUpdate:modelValue":l[1]||(l[1]=v=>i.value.reciever=v),label:"کد ملی گیرنده",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(o,{cols:"12",md:"4"},{default:t(()=>[a(B,{modelValue:i.value.goldWeight,"onUpdate:modelValue":l[2]||(l[2]=v=>i.value.goldWeight=v),label:"وزن طلا",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(o,{class:"d-none d-md-flex",md:"2"})]),_:1})):g("",!0),a(p,null,{default:t(()=>[a(o,{md:"4",class:"d-none d-md-flex"}),x.value?(m(),c(o,{key:0,cols:"12",md:"4"},{default:t(()=>[e("div",Z,[a(R,{length:4,modelValue:w.value,"onUpdate:modelValue":l[3]||(l[3]=v=>w.value=v),type:"number",variant:"outlined",class:"otp-input"},null,8,["modelValue"])])]),_:1})):g("",!0),a(o,{md:"4",class:"d-none d-md-flex"})]),_:1}),_.value?(m(),c(p,{key:2},{default:t(()=>[a(o,{cols:"12"},{default:t(()=>[e("div",$,[x.value?(m(),c(b,{key:1,color:"#d4af37",onClick:q},{default:t(()=>l[13]||(l[13]=[V("تایید نهایی")])),_:1})):(m(),c(b,{key:0,color:"#d4af37",onClick:E},{default:t(()=>l[12]||(l[12]=[V("ثبت انتقال")])),_:1}))])]),_:1})]),_:1})):g("",!0)]),_:1})]),_:1})]),_:1})]),a(Q,{"max-width":"500",modelValue:N.value,"onUpdate:modelValue":l[4]||(l[4]=v=>N.value=v)},{default:t(()=>[a(D,{class:"trade-modal"},{default:t(()=>[e("div",h,[l[27]||(l[27]=e("h3",{class:"my-4"},"فاکتور انتقال",-1)),a(p,null,{default:t(()=>[a(o,{cols:"6",class:"my-1 pa-1"},{default:t(()=>[e("div",ee,[l[14]||(l[14]=e("p",null,"گرم انتقال :",-1)),e("p",null,d(n.value.goldWeight),1)])]),_:1}),a(o,{cols:"6",class:"my-1 pa-1"},{default:t(()=>[e("div",le,[l[15]||(l[15]=e("p",null,"شماره فاکتور :",-1)),e("p",null,d(n.value.invoiceId),1)])]),_:1}),a(o,{cols:"6",class:"my-1 pa-1"},{default:t(()=>[e("div",ae,[l[16]||(l[16]=e("p",null,"تاریخ انتقال :",-1)),e("p",null,d(n.value.date),1)])]),_:1}),a(o,{cols:"6",class:"my-1 pa-1"},{default:t(()=>[e("div",te,[l[17]||(l[17]=e("p",null,"زمان انتقال :",-1)),e("p",null,d(n.value.time),1)])]),_:1}),a(U),a(o,{cols:"12"},{default:t(()=>l[18]||(l[18]=[e("div",{class:"d-flex justify-start"},[e("p",{class:"font-weight-bold"},"اطلاعات انتقال دهنده")],-1)])),_:1}),a(o,{cols:"6",class:"my-1 pa-1"},{default:t(()=>[e("div",se,[l[19]||(l[19]=e("p",null,"نام :",-1)),e("p",null,d(n.value.sender.firstName),1)])]),_:1}),a(o,{cols:"6",class:"my-1 pa-1"},{default:t(()=>[e("div",oe,[l[20]||(l[20]=e("p",null,"نام خانوادگی :",-1)),e("p",null,d(n.value.sender.lastName),1)])]),_:1}),a(o,{cols:"6",class:"my-1 pa-1"},{default:t(()=>[e("div",ne,[l[21]||(l[21]=e("p",null,"کد ملی :",-1)),e("p",null,d(n.value.sender.nationalCode),1)])]),_:1}),a(o,{cols:"6",class:"my-1 pa-1"},{default:t(()=>[e("div",de,[l[22]||(l[22]=e("p",null,"موجودی :",-1)),e("p",null,d(n.value.sender.goldWeight)+" گرم",1)])]),_:1}),a(U),a(o,{cols:"12"},{default:t(()=>l[23]||(l[23]=[e("div",{class:"d-flex justify-start"},[e("p",{class:"font-weight-bold"},"اطلاعات گیرنده")],-1)])),_:1}),a(o,{cols:"6",class:"my-1 pa-1"},{default:t(()=>[e("div",re,[l[24]||(l[24]=e("p",null,"نام :",-1)),e("p",null,d(n.value.reciever.firstName),1)])]),_:1}),a(o,{cols:"6",class:"my-1 pa-1"},{default:t(()=>[e("div",ue,[l[25]||(l[25]=e("p",null,"نام خانوادگی :",-1)),e("p",null,d(n.value.reciever.lastName),1)])]),_:1}),a(o,{cols:"6",class:"my-1 pa-1"},{default:t(()=>[e("div",ie,[l[26]||(l[26]=e("p",null,"کد ملی :",-1)),e("p",null,d(n.value.reciever.nationalCode),1)])]),_:1})]),_:1})]),e("div",fe,[a(b,{text:"تایید انتقال",class:"pay-btn",color:"#9D7E3B",block:"",loading:W.value,onClick:F},null,8,["loading"])])]),_:1})]),_:1},8,["modelValue"]),f.value?(m(),c(j,{key:0,color:"error",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:t(()=>[V(d(y.value),1)]),_:1})):g("",!0),T.value?(m(),c(j,{key:1,color:"success",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:t(()=>[V(d(S.value),1)]),_:1})):g("",!0)],64))}},Oe=z(ve,[["__scopeId","data-v-263db4f1"]]);export{Oe as default};
