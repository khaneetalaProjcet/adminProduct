import{_ as h,r as n,k as ee,c as le,b as l,w as o,a1 as U,e as L,h as z,a0 as S,q as te,o as w,a2 as u,C as p,a as d,a4 as c,t as m,a3 as ae}from"./index-COp8Femz.js";import{G as oe}from"./goldbox-DsYR-d6M.js";import{I as C}from"./inperson-D13Gdgb5.js";import{V as se}from"./VDialog-CPV2nvMC.js";import{V as M}from"./VAlert-DtSdAWzj.js";import{V as de,a as R,b as ue,c as A}from"./VTabs-CHaHh_C-.js";import{a as ne,V as D,b as ie}from"./VCard-utaOD2US.js";import{V as i}from"./VTextField-ChuTXgnI.js";import{V as E}from"./VDataTable-Bh8p0hUN.js";import{a as q}from"./VSelect-6fH1cGtC.js";import{V as re}from"./VForm-DpxC1hEb.js";import{V as me}from"./VSpacer-BL7FnAye.js";import"./api-B7VnIS8G.js";import"./dialog-transition-CSvw-sHq.js";import"./index-Ba5kH-P9.js";import"./index-aFCJ0sEf.js";import"./createSimpleFunctional-B0cxyTcr.js";import"./VWindowItem-CjmDUAWv.js";import"./VMenu-BJEog3wQ.js";import"./VAvatar-kL8u6qNb.js";import"./VImg-9uvMLLrV.js";import"./VDivider-pD0Bt5iF.js";import"./VSelectionControl-Br1aGvX3.js";const ve={class:"w-100 d-flex justify-end"},pe={class:"w-100 d-flex justify-end"},fe={class:"w-100 d-flex justify-end"},Ve={class:"w-100 d-flex justify-end"},ce={class:"d-flex flex-column flex-md-row justify-space-between w-100 px-4 py-8 user-dialog-info"},ge={class:"d-flex flex-column w-100 px-4"},ye={class:"d-flex align-items-center my-2"},be={class:"mx-2"},xe={class:"d-flex align-items-center my-2 user-price"},ke={class:"mx-2"},Se={class:"d-flex align-items-center my-2"},Ne={class:"mx-2"},Pe={class:"d-flex flex-column w-100 px-4"},Ie={class:"d-flex align-items-center my-2"},Te={class:"mx-2"},Ue={class:"d-flex align-items-center my-2 user-price"},we={class:"mx-2"},Ce={class:"d-flex align-items-center my-2 user-price"},De={class:"mx-2"},We={class:"form-box"},_e={__name:"inpersonSellView",setup(He){const g=n(""),W=n(""),v=n(!1),N=n(!1),P=n(!1),b=n(null),a=n({firstName:"",lastName:"",nationalCode:"",phoneNumber:"",tradeType:2,type:"sell",goldPrice:"",goldWeight:"",admin:"",accounter:"",startDate:"",startTime:"",endDate:"",endTime:"",invoiceId:"",status:""}),J=n([{title:"نام",key:"seller.firstName"},{title:"نام خانوادگی",key:"seller.lastName"},{title:"شماره همراه",key:"seller.phoneNumber"},{title:"مبلغ خرید (تومان)",key:"totalPrice"},{title:"وزن طلا (گرم)",key:"goldWeight"},{title:"تاریخ",key:"date"},{title:"زمان",key:"time"},{title:"شناسه پرداخت",key:"invoiceId"},{title:"وضعیت",key:"status"}]),K=n([{title:"نام",key:"seller.firstName"},{title:"نام خانوادگی",key:"seller.lastName"},{title:"شماره همراه",key:"seller.phoneNumber"},{title:"مبلغ خرید (تومان)",key:"totalPrice"},{title:"وزن طلا (گرم)",key:"goldWeight"},{title:"تاریخ",key:"date"},{title:"زمان",key:"time"},{title:"شناسه پرداخت",key:"invoiceId"},{title:"وضعیت",key:"status"}]),I=n(),f=n(),x=n(),T=n(),V=n(),k=n(!1),O=n({authority:"",id:""}),_=async()=>{try{f.value=!0;const s=await C.InPersonSell("completed");return I.value=s.data,s}catch(s){s.response.status==401&&(localStorage.clear(),S.replace("/login")),g.value=s.response.data.error||"خطایی رخ داده است!",v.value=!0,setTimeout(()=>{v.value=!1},1e4)}finally{f.value=!1}},H=async()=>{try{x.value=!0;const s=await C.InPersonSell("failed");return T.value=s.data,s}catch(s){s.response.status==401&&(localStorage.clear(),S.replace("/login")),g.value=s.response.data.error||"خطایی رخ داده است!",v.value=!0,setTimeout(()=>{v.value=!1},1e4)}finally{x.value=!1}},y=s=>s.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),F=[s=>/^\d{10}$/.test(s)||"کد ملی باید ۱۰ رقم باشد",s=>{if(!/^\d{10}$/.test(s))return!0;const e=+s[9],r=s.split("").slice(0,9).reduce((t,Y,Z)=>t+ +Y*(10-Z),0)%11;return r<2&&e===r||r>=2&&e+r===11||"کد ملی نامعتبر است"}],B=()=>{a.value.phoneNumber=a.value.phoneNumber.replace(/\D/g,"").slice(0,11)},$=[s=>/^09\d{9}$/.test(s)||"شماره معتبر نیست"],G=[s=>!!s,s=>/^\d+(\.\d{1,3})?$/.test(s)],Q=()=>{a.value.firstName="",a.value.lastName="",a.value.accounter="",a.value.admin="",a.value.endDate="",a.value.endTime="",a.value.goldPrice="",a.value.goldWeight="",a.value.invoiceId="",a.value.nationalCode="",a.value.phoneNumber="",a.value.startTime="",a.value.startDate=""},X=async()=>{try{P.value=!0;const s=await oe.SubmitInPersonSell(O.value);return W.value=s.msg,N.value=!0,setTimeout(()=>{N.value=!1},5e3),_(),H(),k.value=!1,s}catch(s){s.response.status==401&&(localStorage.clear(),S.replace("/login")),g.value=s.response.data.error||"خطایی رخ داده است!",v.value=!0,setTimeout(()=>{v.value=!1},1e4)}finally{P.value=!1}},j=async s=>{try{s=="completed"?f.value=!0:s=="failed"&&(x.value=!0),a.value.status=s;const e=await C.SubmitFilterInvoice(a.value);return s=="completed"?I.value=e==null?void 0:e.data:s=="failed"&&(T.value=e==null?void 0:e.data),e}catch(e){e.response.status==401&&(localStorage.clear(),S.replace("/login")),g.value=e.response.data.error||"خطایی رخ داده است!",v.value=!0,setTimeout(()=>{v.value=!1},1e4)}finally{x.value=!1,f.value=!1}};return ee(()=>{_(),H()}),(s,e)=>{const r=te("persian-date-picker");return w(),le("div",null,[l(U,null,{default:o(()=>[l(u,null,{default:o(()=>[l(de,{modelValue:b.value,"onUpdate:modelValue":[e[0]||(e[0]=t=>b.value=t),Q],"align-tabs":"center"},{default:o(()=>[l(R,{value:"one"},{default:o(()=>e[30]||(e[30]=[p("فروش حضوری موفق")])),_:1}),l(R,{value:"two"},{default:o(()=>e[31]||(e[31]=[p("فروش حضوری ناموفق")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(u,{cols:"12"},{default:o(()=>[l(ne,null,{default:o(()=>[l(ue,{modelValue:b.value,"onUpdate:modelValue":e[27]||(e[27]=t=>b.value=t)},{default:o(()=>[l(A,{value:"one"},{default:o(()=>[l(U,{class:"filter my-3"},{default:o(()=>[l(u,{cols:"6",md:"3"},{default:o(()=>[l(r,{modelValue:a.value.fromDate,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.fromDate=t),placeholder:"از تاریخ"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(r,{type:"time",modelValue:a.value.fromTime,"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.fromTime=t),placeholder:"از زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(r,{modelValue:a.value.toDate,"onUpdate:modelValue":e[3]||(e[3]=t=>a.value.toDate=t),placeholder:"تا تاریخ"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(r,{type:"time",modelValue:a.value.toTime,"onUpdate:modelValue":e[4]||(e[4]=t=>a.value.toTime=t),placeholder:"تا زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:a.value.firstName,"onUpdate:modelValue":e[5]||(e[5]=t=>a.value.firstName=t),label:"نام",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:a.value.lastName,"onUpdate:modelValue":e[6]||(e[6]=t=>a.value.lastName=t),label:"نام خانوادگی",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:a.value.phoneNumber,"onUpdate:modelValue":e[7]||(e[7]=t=>a.value.phoneNumber=t),label:"شماره موبایل",density:"compact",variant:"outlined",rules:$,onInput:B},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:a.value.nationalCode,"onUpdate:modelValue":e[8]||(e[8]=t=>a.value.nationalCode=t),label:"کد ملی",density:"compact",variant:"outlined",rules:F},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:a.value.goldPrice,"onUpdate:modelValue":e[9]||(e[9]=t=>a.value.goldPrice=t),label:"قیمت طلا",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:a.value.goldWeight,"onUpdate:modelValue":e[10]||(e[10]=t=>a.value.goldWeight=t),label:"وزن طلا",density:"compact",variant:"outlined",rules:G},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:a.value.goldWeight,"onUpdate:modelValue":e[11]||(e[11]=t=>a.value.goldWeight=t),label:"ادمین",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:a.value.goldWeight,"onUpdate:modelValue":e[12]||(e[12]=t=>a.value.goldWeight=t),label:"حسابدار",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{md:"6",class:"d-none d-md-flex"}),l(u,{cols:"12",md:"3"},{default:o(()=>[d("div",ve,[l(c,{"prepend-icon":"ri-loop-left-line",variant:"tonal",block:"",onClick:e[13]||(e[13]=t=>j("completed"))},{default:o(()=>e[32]||(e[32]=[p("به روز رسانی")])),_:1})])]),_:1}),l(u,{cols:"12",md:"3"},{default:o(()=>[d("div",pe,[l(c,{"prepend-icon":"ri-file-excel-line",block:""},{default:o(()=>e[33]||(e[33]=[p("خروجی اکسل")])),_:1})])]),_:1})]),_:1}),l(D,{title:"موفق"},{default:o(()=>[e[34]||(e[34]=d("ul",{class:"listGuide"},[d("li",null," معاملاتی که فروش آن‌ها به‌صورت حضوری انجام شده و مبلغ آن‌ها از طریق حسابداری به حساب ثبت‌ شده در سایت بازگردانده می‌شود. ")],-1)),l(E,{headers:J.value,items:I.value,loading:f.value},{"item.totalPrice":o(({item:t})=>[d("p",null,m(y(t.totalPrice)),1)]),"item.status":o(({item:t})=>[d("div",null,[l(q,{text:t.status=="completed"?"پرداخت موفق":"در انتظار پرداخت",color:t.status=="completed"?"#00853f":"#66666",size:"small"},null,8,["text","color"])])]),_:1},8,["headers","items","loading"])]),_:1})]),_:1}),l(A,{value:"two"},{default:o(()=>[l(U,{class:"filter my-3"},{default:o(()=>[l(u,{cols:"6",md:"3"},{default:o(()=>[l(r,{modelValue:a.value.fromDate,"onUpdate:modelValue":e[14]||(e[14]=t=>a.value.fromDate=t),placeholder:"از تاریخ"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(r,{type:"time",modelValue:a.value.fromTime,"onUpdate:modelValue":e[15]||(e[15]=t=>a.value.fromTime=t),placeholder:"از زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(r,{modelValue:a.value.toDate,"onUpdate:modelValue":e[16]||(e[16]=t=>a.value.toDate=t),placeholder:"تا تاریخ"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(r,{type:"time",modelValue:a.value.toTime,"onUpdate:modelValue":e[17]||(e[17]=t=>a.value.toTime=t),placeholder:"تا زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:a.value.firstName,"onUpdate:modelValue":e[18]||(e[18]=t=>a.value.firstName=t),label:"نام",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:a.value.lastName,"onUpdate:modelValue":e[19]||(e[19]=t=>a.value.lastName=t),label:"نام خانوادگی",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:a.value.phoneNumber,"onUpdate:modelValue":e[20]||(e[20]=t=>a.value.phoneNumber=t),label:"شماره موبایل",density:"compact",variant:"outlined",rules:$,onInput:B},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:a.value.nationalCode,"onUpdate:modelValue":e[21]||(e[21]=t=>a.value.nationalCode=t),label:"کد ملی",density:"compact",variant:"outlined",rules:F},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:a.value.goldPrice,"onUpdate:modelValue":e[22]||(e[22]=t=>a.value.goldPrice=t),label:"قیمت طلا",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:a.value.goldWeight,"onUpdate:modelValue":e[23]||(e[23]=t=>a.value.goldWeight=t),label:"وزن طلا",density:"compact",variant:"outlined",rules:G},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:a.value.goldWeight,"onUpdate:modelValue":e[24]||(e[24]=t=>a.value.goldWeight=t),label:"ادمین",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"3"},{default:o(()=>[l(i,{modelValue:a.value.goldWeight,"onUpdate:modelValue":e[25]||(e[25]=t=>a.value.goldWeight=t),label:"حسابدار",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{md:"6",class:"d-none d-md-flex"}),l(u,{cols:"12",md:"3"},{default:o(()=>[d("div",fe,[l(c,{"prepend-icon":"ri-loop-left-line",variant:"tonal",block:"",onClick:e[26]||(e[26]=t=>j("failed"))},{default:o(()=>e[35]||(e[35]=[p("به روز رسانی")])),_:1})])]),_:1}),l(u,{cols:"12",md:"3"},{default:o(()=>[d("div",Ve,[l(c,{"prepend-icon":"ri-file-excel-line",block:""},{default:o(()=>e[36]||(e[36]=[p("خروجی اکسل")])),_:1})])]),_:1})]),_:1}),l(D,{title:"ناموفق"},{default:o(()=>[e[37]||(e[37]=d("ul",{class:"listGuide"},[d("li",null," معاملاتی که توسط کاربر از فروش آنها صرف نظر شده یا به دلایل مختلف لغو شده‌اند ")],-1)),l(E,{headers:K.value,items:T.value,loading:f.value},{"item.totalPrice":o(({item:t})=>[d("p",null,m(y(t.totalPrice)),1)]),"item.status":o(({item:t})=>[d("div",null,[l(q,{text:t.status=="failed"?"پرداخت ناموفق":"در انتظار پرداخت",color:t.status=="failed"?"#66666":"#00853f",size:"small"},null,8,["text","color"])])]),_:1},8,["headers","items","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(se,{modelValue:k.value,"onUpdate:modelValue":e[29]||(e[29]=t=>k.value=t),"max-width":"600",class:"dialog"},{default:o(()=>[l(D,{class:"dialog-card"},{default:o(()=>[e[45]||(e[45]=d("div",{class:"k-dialog-title"},[d("p",null,"اطلاعات خرید")],-1)),d("div",ce,[d("div",ge,[d("div",ye,[e[38]||(e[38]=d("p",null,"نام: ",-1)),d("p",be,m(V.value.Seller.firstName),1)]),d("div",xe,[e[39]||(e[39]=d("p",null,"کد ملی: ",-1)),d("p",ke,m(V.value.Seller.nationalCode),1)]),d("div",Se,[e[40]||(e[40]=d("p",null,"مبلغ کل: ",-1)),d("p",Ne,m(y(V.value.totalPrice))+" تومان",1)])]),d("div",Pe,[d("div",Ie,[e[41]||(e[41]=d("p",null,"نام خانوادگی: ",-1)),d("p",Te,m(V.value.Seller.lastName),1)]),d("div",Ue,[e[42]||(e[42]=d("p",null,"قیمت لحظه ای طلا: ",-1)),d("p",we,m(y(V.value.goldPrice))+" تومان",1)]),d("div",Ce,[e[43]||(e[43]=d("p",null,"وزن طلای خریداری شده: ",-1)),d("p",De,m(y(V.value.goldWeight))+" تومان",1)])])]),d("div",We,[l(re,{ref:"form",onSubmit:ae(X,["prevent"])},{default:o(()=>[l(c,{type:"submit",size:"large",class:"my-2",loading:P.value,block:""},{default:o(()=>e[44]||(e[44]=[p("بررسی مجدد پرداخت")])),_:1},8,["loading"])]),_:1},512)]),l(ie,null,{default:o(()=>[l(me),l(c,{text:"بستن",onClick:e[28]||(e[28]=t=>k.value=!1),size:"large",class:"m-3"})]),_:1})]),_:1})]),_:1},8,["modelValue"]),v.value?(w(),L(M,{key:0,color:"error",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:o(()=>[p(m(g.value),1)]),_:1})):z("",!0),N.value?(w(),L(M,{key:1,color:"success",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:o(()=>[p(m(W.value),1)]),_:1})):z("",!0)])}}},al=h(_e,[["__scopeId","data-v-8f0b1aef"]]);export{al as default};
